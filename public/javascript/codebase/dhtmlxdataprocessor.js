function Iq(dI){this.cj=dI;this.obj=null;this.az=new Array(0);this.T=new Array(0);this.aH=true;this.cJ="cell";this.ef=0;this.hR="GET";return this};Iq.prototype.JI=function(mode,total){this.hR=mode;this.hs=total};Iq.prototype.escape=function(data){if(this.ahf)return encodeURIComponent(data);else return escape(data)};Iq.prototype.enableUTFencoding=function(mode){this.ahf=K(mode)};Iq.prototype.afd=function(ev){if(typeof(ev)!="function")ev=eval(ev);this.aK=ev};Iq.prototype.iM=function(){for(var i=0;i<this.T.length;i++)if(this.T[i])return false;return true};Iq.prototype.iU=function(mode){this._debug=K(mode)};Iq.prototype.ahP=function(mode){this.iO=K(mode)};Iq.prototype.mq=function(mode){if(mode=="cell")this.aH=true;else{this.aH=false};this.cJ=mode};Iq.prototype.iv=function(aiw){for(var i=0;i<this.T.length;i++){if(aiw==this.T[i])return i};return-1};Iq.prototype.aw=function(cq,state,forceUpdate){var rowInArray=this.iv(cq);if(rowInArray== -1)rowInArray=this.T.length;if(state){this.T[rowInArray]=cq;this.tG(cq);this.aZ(cq,this.aH||forceUpdate)}else{this.T[rowInArray]=null;this.rn(cq)}};Iq.prototype.setUpdatedTM=function(cq,state){this.iZ=true;if(this.ef){this.aH=false;this.aw(cq,true);this.aH=true}else this.aw(cq,true)};Iq.prototype.tG=function(cq){if(this.obj.acE=="tree")this.obj.Wy(cq,"font-weight:bold;");else this.obj.tG(cq)};Iq.prototype.rn=function(cq){if(this.obj.acE=="tree")this.obj.Wy(cq,"font-weight:normal;");else this.obj.rn(cq)};Iq.prototype.aZ=function(cq,hZ){var fl=true;var gf=false;var mFields=(this.obj.QS?this.obj.Xb(this.az):this.az);for(var i=0;i<mFields.length;i++){if(mFields[i]){gf=true;var ap=this.obj.cells(cq,i).getValue();var Sg=this.obj.wW(i);if((typeof(mFields[i])=="function"&&mFields[i](ap,Sg))||(typeof(mFields[i])!="function"&&ap.toString().PA()!="")){this.obj.cells(cq,i).cell.style.borderColor=""}else{fl=false;this.obj.cells(cq,i).cell.style.borderColor="red"}}};if((fl|| !gf)&&hZ){this.agy(cq)}};Iq.prototype.agy=function(cq){if(cq){if((this.gJ)&&(!this.gJ(cq,this.obj.getUserData(cq,"!nativeeditor_status")||"updated")))return false;if(!this.hs)var a1=this.fD(cq);else var a1=this.ahb();var a2=new ag(this.Op,this,true);var a3=this.cj+((this.cj.indexOf("?")!= -1)?"&":"?");if(this._debug)alert("Send data to server \n URL:"+a3+"\n Data:"+a1);if(this.hR!="POST")a2.loadXML(a3+a1);else a2.loadXML(a3,true,a1);this.ef++}else{for(var i=0;i<this.T.length;i++){if(this.T[i]){this.aZ(this.T[i],true);if(this.hs)break;if(!this.aH)break}}}};Iq.prototype.ahb=function(cq){var bW=new Array();var rs=new Array();for(var i=0;i<this.T.length;i++)if(this.T[i]){bW[bW.length]=this.fD(this.T[i],this.T[i]+"_");rs[rs.length]=this.T[i]};bW[bW.length]="ids="+rs.join(",");return bW.join("&")};Iq.prototype.alx=function(name,handler){if(!this.aF)this.aF=new Array();this.aF[name]=handler};Iq.prototype.gS=function(aQ){if(typeof(aQ)=="function")this.gJ=aQ;else this.gJ=eval(aQ)};Iq.prototype.aS=function(sid,tid,action){this.aw(sid,false);var jl=sid;switch(action){case "insert":if(tid!=sid){if(this.obj.acE=="tree")this.obj.VT(sid,tid);else this.obj.bK(sid,tid);sid=tid};break;case "delete":if(this.obj.acE=="tree"){this.obj.bE(sid);if(this.aK)this.aK(sid,action,tid);return}else{this.obj.setUserData(sid,"!nativeeditor_status","true_deleted");this.obj.deleteRow(sid)};break};var z=this.obj.getUserData(sid,"!nativeeditor_status",'');if(z!="deleted")this.obj.setUserData(sid,"!nativeeditor_status",'');if(this.iZ){for(var i=0;i<this.T.length;i++)if(this.T[i]){this.obj.setUserData(this.T[i],"!nativeeditor_status","inserted");this.aw(this.T[i],true);break}};if(this.aK)this.aK(jl,action,tid)};Iq.prototype.Op=function(that,b,c,d,xml){if(that._debug)alert("XML status: "+(xml.ai.responseXML?"correct":"incorrect")+"\nServer response: \n"+xml.ai.responseText);var CZ=xml.cR("data");var CZ=xml.et("//data/action");that.ef--;if((!CZ)||(!CZ.length)){var i=0;var CZ=xml.cR("data");while((CZ.childNodes[i])&&(CZ.childNodes[i].tagName)&&(CZ.childNodes[i].tagName!="action"))i++;CZ=CZ.childNodes[i];var action=CZ.getAttribute("type");var sid=CZ.getAttribute("sid");var tid=CZ.getAttribute("tid");if((that.aF)&&(that.aF[action])&&(!that.aF[action](CZ))){}else that.aS(sid,tid,action)}else for(var i=0;i<CZ.length;i++){var btag=CZ[i];var action=btag.getAttribute("type");var sid=btag.getAttribute("sid");var tid=btag.getAttribute("tid");if((that.aF)&&(that.aF[action])&&(!that.aF[action](btag))){}else that.aS(sid,tid,action)};if(!that.aH&& !that.amF)that.agy();that.amF=false};Iq.prototype.fD=function(cq,apG){if(this.obj.acE=="tree"){var z=this.obj.ak(cq);var z2=z.parentObject;var i=0;for(i=0;i<z2.aE;i++)if(z2.childNodes[i]==z)break;var str="tr_id="+this.escape(z.id);str+="&tr_pid="+this.escape(z2.id);str+="&tr_order="+i;str+="&tr_text="+this.escape(z.span.innerHTML);z2=(z.PJ||"").split(",");for(i=0;i<z2.length;i++)str+="&"+this.escape(z2[i])+"="+this.escape(z.userData["t_"+z2[i]])}else{apG=(apG||"");var str=apG+"gr_id="+this.escape(cq);if(this.obj.gY())str+="&gr_pid="+this.escape(this.obj.rP(cq));var r=this.obj.dz(cq);for(var i=0;i<r.childNodes.length;i++){if(this.obj.QS)var i_c=this.obj.QS[i];else var i_c=i;var c=this.obj.cells(r.idd,i);if(this.iO)str+="&"+apG+this.obj.Mr(i)+"="+this.escape(c.getValue());else str+="&"+apG+"c"+i_c+"="+this.escape(c.getValue())};var data=this.obj.da[cq];if(data){for(var j=0;j<data.kk.length;j++)str+="&"+apG+data.kk[j]+"="+this.escape(data.gT[j])}};return str};Iq.prototype.xU=function(ind,dw){if(dw){this.az[ind]=dw}else this.az[ind]=true};Iq.prototype.hX=function(ind){this.az[ind]=false};Iq.prototype.init=function(anObj){this.obj=anObj;this.obj.Rs=(new Date()).valueOf()+"-"+Math.random(1000)+"-"+(anObj.aL||anObj.parentObject).id;var self=this;if(this.obj.acE=="tree"){if(this.obj.Nh)this.obj.Nh(function(state,id){if(state==3)self.aw(id,true);return true});this.obj.tE(function(id,id_2,id_3,tree_1,tree_2){if(tree_1==tree_2)self.aw(id,true)});this.obj.ajc=function(cq){var z=self.obj.getUserData(cq,"!nativeeditor_status");if(z=="deleted")return true;self.obj.setUserData(cq,"!nativeeditor_status","deleted");self.aw(cq,true);self.obj.Wy(cq,"text-decoration : line-through;");return false};this.obj.BX=function(cq){self.obj.setUserData(cq,"!nativeeditor_status","inserted");self.setUpdatedTM(cq,true)}}else{this.obj.ks(function(state,id,index){var cell=self.obj.cells(id,index);if(state==0){}else if(state==1){if(cell.wI()){self.aw(id,true)}}else if(state==2){if(cell.hy()){self.aw(id,true)}};return true});this.obj.attachEvent("onRowPaste",function(id){self.aw(id,true)});this.obj.lX(function(cq){if(self.cJ=="row")self.agy();return true});this.obj.Dr(function(cq,akG){if(self.cJ=="row")self.agy();return true});this.obj.yq(function(cq){var z=self.obj.getUserData(cq,"!nativeeditor_status");if(z=="inserted"){self.aw(cq,false);return true};if(z=="deleted")return false;if(z=="true_deleted")return true;self.obj.setUserData(cq,"!nativeeditor_status","deleted");self.obj.jb(cq,"text-decoration : line-through;");self.aw(cq,true);return false});this.obj.aab(function(cq){self.obj.setUserData(cq,"!nativeeditor_status","inserted");self.aw(cq,true);return true})}};