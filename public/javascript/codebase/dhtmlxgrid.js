var globalActiveDHTMLGridObject;String.prototype.PA=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function cD(ar){return oT((ar||new Array()),new nJ())};function nJ(){return this};nJ.prototype.bP=function(aiw){for(var i=0;i<this.length;i++){if(aiw==this[i])return i};return-1};nJ.prototype.Qt=function(ind){if(Number(ind)<0||this.length==0)return false;for(var i=ind;i<this.length;i++){this[i]=this[i+1]};this.length--};nJ.prototype.ml=function(ind,value){this[this.length]=null;for(var i=this.length-1;i>=ind;i--){this[i]=this[i-1]};this[ind]=value};nJ.prototype.hd=function(ind){for(var i=ind;i<this.length;i++){this[i]=this[i+1]};this.length--};nJ.prototype.yk=function(akv,mw){var YV=this[akv];this[akv]=this[mw];this[mw]=YV};function D(id){this.Lf=((bf)&&window.XMLHttpRequest&&(document.compatMode!="BackCompat"));if(bf)try{document.execCommand("BackgroundImageCache",false,true)}catch(e){};if(id){if(typeof(id)=='object'){this.aL=id;this.aL.id="cgrid2_"+(new Date()).getTime()}else this.aL=document.getElementById(id)}else{this.aL=document.createElement("DIV");this.aL.id="cgrid2_"+(new Date()).getTime()};this.Ag();this.acR=this.acR||"rows";this.akO=this.akO||"cell";this.alM=this.alM||"row";var self=this;this.Wr=0;this.nm=this.aL.nm||"grid";this.cell=null;this.row=null;this.editor=null;this.UB=true;this.aP=true;this.combos=new Array(0);this.QL=new Array(0);this.bj=new Array(0);this.P=new cD(0);this.Ct=new Array(0);this.bY=new cD(0);this.aD=new Array(new cD(0),new cD(0));this.lk=null;this.da=new Array(0);this.styleSheet=document.styleSheets;this.aL.className+=" gridbox";this.aL.style.width=this.aL.getAttribute("width")||(window.getComputedStyle?(this.aL.style.width||window.getComputedStyle(this.aL,null)["width"]):(this.aL.currentStyle?this.aL.currentStyle["width"]:0))||"100%";this.aL.style.height=this.aL.getAttribute("height")||(window.getComputedStyle?(this.aL.style.height||window.getComputedStyle(this.aL,null)["height"]):(this.aL.currentStyle?this.aL.currentStyle["height"]:0))||"100%";this.aL.style.cursor='default';this.aL.onselectstart=function(){return false};this.obj=document.createElement("TABLE");this.obj.cellSpacing=0;this.obj.cellPadding=0;this.obj.style.width="100%";this.obj.style.tableLayout="fixed";this.obj.className="c_obj".substr(2);this.obj.wn=function(i){return this.rows[i+1]};this.obj.ns=function(){return this.rows.length-1};this.hdr=document.createElement("TABLE");this.hdr.style.border="1px solid gray";this.hdr.cellSpacing=0;this.hdr.cellPadding=0;if((!cU)||(pe>=8.5))this.hdr.style.tableLayout="fixed";this.hdr.className="c_hdr".substr(2);this.hdr.width="100%";this.Nj=document.createElement("TABLE");this.Nj.className="xhdr";this.Nj.cellPadding=0;this.Nj.cellSpacing=0;this.Nj.style.width='100%';var r=this.Nj.insertRow(0);var c=r.insertCell(0);r.insertCell(1).innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";r.childNodes[1].style.width='100%';c.appendChild(this.hdr);this.zO=document.createElement("DIV");this.zO.appendChild(this.obj);this.jR=document.createElement("TABLE");this.jR.insertRow(0).insertCell(0);this.jR.insertRow(1).insertCell(0);this.jR.cellPadding=0;this.jR.cellSpacing=0;this.jR.width="100%";this.jR.height="100%";this.jR.style.tableLayout="fixed";this.HF=document.createElement("DIV");this.HF.style.width="100%";this.HF.style.height=this.aL.style.height;this.HF.style.overflow="auto";this.HF.style.position="relative";this.HF.appendChild(this.zO);this.HF.className="objbox";this.kR=document.createElement("DIV");this.kR.style.width="100%";if(((cU)&&(pe<9)))this.GK=25;else this.GK=200;this.kR.style.height=this.GK+"px";if(bf)this.kR.style.overflowX="hidden";else this.kR.style.overflow="hidden";this.kR.style.position="relative";this.kR.appendChild(this.Nj);this.sf=new Array(0);this.gB=document.createElement("IMG");this.gB.style.display="none";this.kR.insertBefore(this.gB,this.Nj);this.jR.rows[0].cells[0].vAlign="top";this.jR.rows[0].cells[0].appendChild(this.kR);this.jR.rows[1].cells[0].appendChild(this.HF);this.aL.appendChild(this.jR);this.aL.grid=this;this.HF.grid=this;this.kR.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=new Array(0);this.cellWidthPC=new Array(0);this.fL=this.aL.ajW||"px";this.gX=this.aL.aoC||",";this.oU=",";this.ep=(this.aL.aoF||"").split(",");this.vT=(this.aL.aoI||"").split(",");this.dO=(this.aL.amt||"").split(",");this.cO=cD((this.aL.apf||"").split(","));this.dV=(this.aL.amV||"").split(",");this.cZ=(this.aL.anl||"").split(",");this.fldSort=(this.aL.amn||"").split(",");this.eg=this.aL.aoD||"gridCfx/";this.ft=false;this.oB=true;this.aoV=this.aL.aoU||null;this.aoY=this.aL.aoW||null;this.aaB=(this.aL.ani||"cell").toLowerCase();this.gN=this.aL.alk||false;this.hu=this.aL.multiline||false;this.sB=this.aL.apt||false;this.tR=this.aL.aol||"";this.kD=this.aL.ajD||true;;this.pH=false;this.ip=false;this.cu=0;dE(window,"unload",function(){try{self.fA()}catch(e){}});this.loadXML=function(url,bo){if(this.ic){this.ic=url;this.kh(null,bo);return true};if(this.akl)this.eG(url);if(url.indexOf("?")!= -1)var s="&";else var s="?";var obj=this;this.cG("onXLS",[this]);if(bo)this.bA.bs=bo;this.bA.loadXML(url+""+s+"rowsLoaded="+this.iD()+"&lastid="+this.py(this.iD()-1))};this.setSkin=function(name){this.aL.className="gridbox gridbox_"+name;this.lj("ev_"+name,"odd_"+name,this.gY());this.O();this.vw=this.BN=0;switch(name){case "clear":this.FD=document.createElement("DIV");this.FD.className="topMumba";this.FD.innerHTML="<img style='left:0px' src='"+this.eg+"skinC_top_left.gif'><img style='right:0px' src='"+this.eg+"skinC_top_right.gif'>";this.aL.appendChild(this.FD);this.Gc=document.createElement("DIV");this.Gc.className="bottomMumba";this.Gc.innerHTML="<img style='left:0px' src='"+this.eg+"skinD_bottom_left.gif'><img style='right:0px' src='"+this.eg+"skinD_bottom_right.gif'>";this.aL.appendChild(this.Gc);this.aL.style.position="relative";this.ajd=20;break;case "modern":case "light":this.qW=true;this.vw=1;break;case "xp":this.qW=true;this.ig=22;this.vw=1;break;case "mt":this.ig=22;this.vw=1;this.BN=(bf?1:0);break;break;case "gray":if((bf)&&(document.compatMode!="BackCompat"))this.ig=22;this.vw=1;this.BN=(bf?1:0);break};if(bf&&this.hdr){var d=this.hdr.parentNode;d.removeChild(this.hdr);d.appendChild(this.hdr)};this.setSizes()};this.bH=function(str,bo){if(this.ic){this.SZ=str;this.kh(null,bo);return true};this.cG("onXLS",[this]);if(bo)this.bA.bs=bo;this.bA.bH(str)};this.vj=function(obj){var root=self.bA.cR(self.acR);if(root.tagName!="DIV")if(self.va){self.OR(self.bA);self.va=null}else if(!self.bA.ai.nodeName){self.On(self.bA.ai.responseXML)}else{self.On(self.bA.ai)};if(self.ip)self.Ba()};this.bA=new ag(this.vj,window,true,this.ir);if(bf)this.jJ(true);this.M=new ac();this._doOnScroll=function(e,mode){this.cG("onScroll",[this.HF.scrollLeft,this.HF.scrollTop]);this.BD(e,mode)};this.BD=function(e,mode){this.kR.scrollLeft=this.HF.scrollLeft;if(this.ftr)this.ftr.parentNode.scrollLeft=this.HF.scrollLeft;this.vo(null,true);if(mode)return;if(!this.ip&&this.HF.scrollTop+this.GK+this.HF.offsetHeight>this.HF.scrollHeight){if(this.aaj&&(this.HF.TK!=this.HF.scrollTop)&&this.pI()){this.HF.scrollTop=this.HF.scrollHeight-(this.GK+1+this.HF.offsetHeight);this.HF.TK=this.HF.scrollTop}};if(this.ic){if(this.ut)window.clearTimeout(this.ut);this.ut=window.setTimeout(function(){if(self.limit)self.kh()},500)}};this.qu=function(obj){obj.appendChild(this.aL);this.HF.style.height=this.aL.style.height};this.init=function(fl){if((this.gY())&&(!this.dP)){this.apH=new nJ();this.dP=new Ei();if((this.aC)&&(!this.nh))this.aC.dP=this.dP;this.kj={eg:null}};if(!this.Oi)return;this.bB();this.Ms=null;this.RD=null;this.ij=this.yH=null;this.eh=0;this.eb=0;this.cellWidthPX=new Array(0);this.cellWidthPC=new Array(0);if(this.hdr.rows.length>0){this.clearAll(true)};if(this.cO.bP("tree")!= -1){this.lk=new qB();this.lk.eT("hashOfParents",new qB())};var hdrRow=this.hdr.insertRow(0);for(var i=0;i<this.ep.length;i++){hdrRow.appendChild(document.createElement("TH"));hdrRow.childNodes[i].A=i;hdrRow.childNodes[i].style.height="0px"};if(bf)hdrRow.style.position="absolute";else hdrRow.style.height='auto';var hdrRow=this.hdr.insertRow(cn?2:1);hdrRow.bq=new Array();var kO=0;for(var i=0;i<this.ep.length;i++){hdrRow.bq[i]=i-kO;if((this.ep[i]==this.JP)&&(i!=0)){if(cn)hdrRow.insertCell(i-kO);hdrRow.cells[i-kO-1].colSpan=(hdrRow.cells[i-kO-1].colSpan||1)+1;hdrRow.childNodes[i-kO-1].A++;kO++;hdrRow.bq[i]=i-kO;continue};hdrRow.insertCell(i-kO);hdrRow.childNodes[i-kO].A=i;hdrRow.childNodes[i-kO].hp=i;this.Cs(i,this.ep[i])};if(kO==0)hdrRow.bq=null;this.gA=this.ep.length;if(bf)window.setTimeout(function(){self.setSizes()},1);if(!this.obj.firstChild)this.obj.appendChild(document.createElement("TBODY"));var If=this.obj.firstChild;if(!If.firstChild){If.appendChild(document.createElement("TR"));If=If.firstChild;if(bf)If.style.position="absolute";else If.style.height='auto';for(var i=0;i<this.ep.length;i++){If.appendChild(document.createElement("TH"));If.childNodes[i].style.height="0px"}};this.wL();this.QS=null;if(this.hu== -1)this.hu=true;if(this.hu!=true)this.obj.className+=" row20px";this.gB.style.position="absolute";this.gB.style.display="none";this.gB.src=this.eg+"sort_desc.gif";this.gB.YR=0;this.jR.rows[0].style.display='';if(this.sB){this.jR.rows[0].style.display='none'}else{this.sB=false};if(this.Az)this.FM();this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();if(fl)this.On();this.obj.scrollTop=0;if(this.nz)this.M.eH(this.aL,this);if(this.CV)this.Ve();if(this.Yz)this.Yz()};this.setSizes=function(fl){if((!this.hdr.rows[0]))return;if(!this.aL.offsetWidth){if(this.zY)window.clearTimeout(this.zY);this.zY=window.setTimeout(function(){self.setSizes()},250);return};if(((ca)&&(this.aL.style.height=="100%"))||(this.ado)){this.aL.style.height=this.aL.parentNode.clientHeight;this.ado=true};if(fl&&this.eh==this.aL.offsetWidth&&this.eb==this.aL.offsetHeight){return false}else if(fl){this.eh=this.aL.offsetWidth;this.eb=this.aL.offsetHeight};if((!this.kR.offsetHeight)&&(this.kR.offsetHeight>0))this.jR.rows[0].cells[0].height=this.kR.offsetHeight+"px";var eh=parseInt(this.aL.offsetWidth)-(this.ajd||0);var eb=parseInt(this.aL.offsetHeight)-((!bf)?(this.vw||0):0);var Tl=(this.HF.scrollHeight>this.HF.offsetHeight);if(((!this.abK)&&(Tl))||((this.FF)&&(this.FF<this.HF.scrollHeight)))eh-=(this.Zz||(ca?19:16));var Bj=this.hdr.rows[0].cells.length;for(var i=0;i<this.gA;i++){if(this.fL=='px'&&this.cellWidthPX.length<Bj){this.cellWidthPX[i]=this.cZ[i]-this.Wr}else if(this.fL=='%'&&this.cellWidthPC.length<Bj){this.cellWidthPC[i]=this.cZ[i]};if(this.fL=='%'&&this.cellWidthPC.length!=0&&this.cellWidthPC[i]){this.cellWidthPX[i]=parseInt(eh*this.cellWidthPC[i]/100)}};var aaW=this.aL.clientWidth?(this.aL.offsetWidth-this.aL.clientWidth):0;var AG=0;var HD=new Array();for(var i=0;i<this.gA;i++)if((this.cZ[i]=="*")&&((!this.L)||(!this.L[i])))HD[HD.length]=i;else AG+=parseInt(this.cellWidthPX[i]);if(HD.length){var ms=Math.floor((eh-AG-1-aaW)/HD.length);if(ms<0)ms=1;for(var i=0;i<HD.length;i++){var min=(this.vy?this.vy[HD[i]]:0);this.cellWidthPX[HD[i]]=(min?(min>ms?min:ms):ms)-this.Wr;AG+=ms}};var AG=0;for(var i=0;i<this.gA;i++)AG+=parseInt(this.cellWidthPX[i]);if(cU)AG-=1;this.Ue();if((this.Gd)&&(this.Gd[0])){if(this.fL=='%'){this.fL="px";this.cellWidthPC=[]};var gs=(AG>this.Gd[1]?this.Gd[1]:(AG<this.Gd[2]?this.Gd[2]:AG));this.aL.style.width=gs+((Tl&& !this.abK)?(ca?20:18):0)+"px"};this.zO.style.width=AG+"px";if((this.ftr)&&(!this.nh))this.ftr.style.width=AG+"px";this.zO.childNodes[0].style.width=AG+"px";this.BD(0,1);this.hdr.style.border="0px solid gray";var rK=this.hdr.offsetHeight+(this.BN?this.BN:0);if(this.ftr)rK+=this.ftr.offsetHeight;if(this.abK)if(this.HF.scrollHeight){if(bf)var z2=this.HF.scrollHeight;else var z2=this.HF.childNodes[0].scrollHeight;var PS=this.parentGrid?1:((this.HF.offsetWidth<this.HF.scrollWidth)?(ca?20:18):1);if(this.aic)z2=this.aL.parentNode.offsetHeight-rK-PS-(this.vw?this.vw:0)*2;if(((this.FF)&&((this.aea?(z2+rK+PS):z2)>this.FF)))eb=this.FF*1+(this.aea?0:(rK+PS));else eb=z2+rK+PS;this.aL.style.height=eb+"px"};if(this.ftr)rK-=this.ftr.offsetHeight;var alY=this.jR.rows[1].cells[0].childNodes[0];if(!this.sB)alY.style.top=(rK-this.kR.offsetHeight+((bf&& !window.XMLHttpRequest)?(-aaW):0))+"px";if(this.FD){this.FD.style.top=(rK||0)+"px";this.FD.style.width=(eh+20)+"px"};if(this.Gc){this.Gc.style.top=(eb-3)+"px";this.Gc.style.width=(eh+20)+"px"};alY.style.height=(((eb-rK-1)<0&&bf)?20:(eb-rK-(this.Lf?2:1)))-(this.ftr?this.ftr.offsetHeight:0)+"px";if(this.ftr&&this.aL.offsetHeight>this.ftr.offsetHeight)this.jR.style.height=this.aL.offsetHeight-this.ftr.offsetHeight+"px";if(this.ic)this.xd=Math.floor(parseInt(this.aL.offsetHeight)/20)+(cn?4:2)};this.Ue=function(){if((cU)&&(this.ftr))this.ftr.width=this.HF.scrollWidth+"px";var l=this.gA;for(var i=0;i<l;i++){this.hdr.rows[0].cells[i].style.width=this.cellWidthPX[i]+"px";this.obj.rows[0].childNodes[i].style.width=this.cellWidthPX[i]+"px";if(this.ftr)this.ftr.rows[0].cells[i].style.width=this.cellWidthPX[i]+"px"}};this.alX=function(gX){this.gX=gX};this.eR=function(wp){this.fL="%";this.cZ=wp.split(this.gX.replace(/px/gi,""));this.tZ()};this.tZ=function(){var el=window;var self=this;if(el.addEventListener){if((ca)&&(qG<1.8))el.addEventListener("resize",function(){if(!self.aL)return;var z=self.aL.style.width;self.aL.style.width="1px";window.setTimeout(function(){self.aL.style.width=z;self.setSizes();if(self.aC)self.aC.rk()},10)},false);else el.addEventListener("resize",function(){if(self.setSizes)self.setSizes();if(self.aC)self.aC.rk()},false)}else if(el.attachEvent)el.attachEvent("onresize",function(){if(self.rJ)window.clearTimeout(self.rJ);if(self.setSizes)self.rJ=window.setTimeout(function(){self.setSizes();if(self.aC)self.aC.rk()},500)});this.tZ=function(){}};this.setInitWidths=function(wp){this.fL="px";this.cZ=wp.split(this.gX);if(ca){for(var i=0;i<this.cZ.length;i++)if(this.cZ[i]!="*")this.cZ[i]=parseInt(this.cZ[i])-2}};this.rZ=function(state){this.hu=K(state)};this.enableMultiselect=function(state){this.gN=K(state)};this.setImagePath=function(oZ){this.eg=oZ};this.bX=function(ev){var el=ev.target||ev.srcElement;if(el.tagName!="TD")el=this.cd(el,"TD");if((el.tagName=="TD")&&(this.qZ)&&(!this.qZ[el.A]))return el.style.cursor="default";var jC=ev.layerX+(((!bf)&&(ev.target.tagName=="DIV"))?el.offsetLeft:0);if((el.offsetWidth-(ev.offsetX||(parseInt(this.fI(el,this.kR))-jC)* -1))<10){el.style.cursor="E-resize"}else el.style.cursor="default";if(cU)this.kR.scrollLeft=this.HF.scrollLeft};this.eJ=function(ev){this.RD=null;var el=ev.target||ev.srcElement;if(el.tagName!="TD")el=this.cd(el,"TD");var x=ev.clientX;var afj=this.hdr.offsetWidth;var VI=parseInt(el.offsetWidth);if(el.tagName=="TD"&&el.style.cursor!="default"){if((this.qZ)&&(!this.qZ[el.A]))return;this.aL.onmousemove=function(e){this.grid.EO(e||window.event,el,VI,x,afj)};document.body.onmouseup=new Function("","document.getElementById('"+this.aL.id+"').grid.fN()")}};this.fN=function(){this.aL.onmousemove="";document.body.onmouseup="";this.setSizes();this.BD(0,1);this.cG("onResizeEnd",[this])};this.EO=function(ev,el,VI,x,afj){el.style.cursor="E-resize";this.RD=el;var yT=VI+(ev.clientX-x);var ash=afj+(ev.clientX-x);if(!(this.cG("onResize",[el.A,yT,this])))return;if(el.colSpan>1){var YZ=new Array();for(var i=0;i<el.colSpan;i++)YZ[i]=Math.round(yT*this.hdr.rows[0].childNodes[el.hp+i].offsetWidth/el.offsetWidth);for(var i=0;i<el.colSpan;i++)this.si(el.hp+i*1,YZ[i])}else this.si(el.A,yT);this.BD(0,1);if(cU)this.setSizes();this.zO.childNodes[0].style.width=""};this.si=function(ind,yT){if(yT>((this.vy&& !this.Hc)?(this.vy[ind]||10):10)){this.obj.firstChild.firstChild.childNodes[ind].style.width=yT+"px";this.hdr.rows[0].childNodes[ind].style.width=yT+"px";if(this.ftr)this.ftr.rows[0].childNodes[ind].style.width=yT+"px";if(this.fL=='px'){this.cellWidthPX[ind]=yT}else{var eh=parseInt(this.aL.offsetWidth);if(this.HF.scrollHeight>this.HF.offsetHeight)eh-=(this.Zz||(ca?19:16));var ais=Math.round(yT/eh*100);this.cellWidthPC[ind]=ais}}};this.ky=function(state,ind,order,row){order=(order||"asc").toLowerCase();if(!K(state)){this.gB.style.display="none";this.ij=null;return};if(order=="asc")this.gB.src=this.eg+"sort_asc.gif";else this.gB.src=this.eg+"sort_desc.gif";this.gB.style.display="";this.ij=this.hdr.rows[0].childNodes[ind];var r=this.hdr.rows[row||1];for(var i=0;i<r.childNodes.length;i++)if(r.childNodes[i].A==ind)this.yH=r.childNodes[i];this.vo()};this.vo=function(ind,mode,aiE,el){if(!el){if(!ind)var el=this.yH;else var el=this.hdr.rows[aiE||0].cells[ind]};if(el!=null){var pos=this.fI(el,this.kR);var apJ=el.offsetWidth;this.gB.style.left=Number(pos[0]+apJ-13)+"px";this.gB.YR=parseInt(this.gB.style.left);this.gB.style.top=Number(pos[1]+5)+"px";if((!this.pH)&&(!mode))this.gB.style.display="inline";this.gB.style.left=this.gB.YR+"px"}};this.setActive=function(fl){if(arguments.length==0)var fl=true;if(fl==true){if(globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject!=this))globalActiveDHTMLGridObject.bB();globalActiveDHTMLGridObject=this;this.ft=true}else{this.ft=false}};this.aV=function(ev){var nt=0;var el=this.cd(bf?ev.srcElement:ev.target,"TD");var fl=true;if(this.gN!=false){if(ev.shiftKey&&this.row!=null){nt=1};if(ev.ctrlKey||ev.metaKey){nt=2}};this.bL(el,fl,nt)};this._doContClick=function(ev){var el=this.cd(bf?ev.srcElement:ev.target,"TD");if((!el)||(typeof(el.parentNode.idd)=="undefined"))return true;if(ev.button==2||(cn&&ev.ctrlKey)){if(!this.cG("onRightClick",[el.parentNode.idd,el.A,ev])){var z=function(e){document.body.oncontextmenu=Function("return true;");(e||event).cancelBubble=true;return false};if(bf)ev.srcElement.oncontextmenu=z;else if(!gP)document.body.oncontextmenu=z;return false};if(this.Gs){if(!(this.cG("onBeforeContextMenu",[el.parentNode.idd,el.A,this])))return true;el.contextMenuId=el.parentNode.idd+"_"+el.A;el.contextMenu=this.Gs;el.a=this.Gs.vm;if(bf)ev.srcElement.oncontextmenu=function(){event.cancelBubble=true;return false};el.a(el,ev);el.a=null}}else if(this.Gs)this.Gs.ES();return true};this.bL=function(el,fl,nt,show){var alh=this.row?this.row.idd:0;this.setActive(true);if(!nt)nt=0;if(this.cell!=null)this.cell.className=this.cell.className.replace(/cellselected/g,"");if(el.tagName=="TD"&&(this.P.bP(this.bj[el.parentNode.idd])!= -1||this.aD[0].bP(el.parentNode.idd)!= -1||this.gY())){if(this.mR("onSelectStateChanged"))var ajG=this.bI();var GZ=this.row;if(nt==0){this.pL()}else if(nt==1){var GN=this.P.bP(el.parentNode);var Hm=this.P.bP(this.Ms);if(GN>Hm){var akL=Hm;var end=GN}else{var akL=GN;var end=Hm};for(var i=0;i<this.P.length;i++)if((i>=akL&&i<=end)){if(this.P[i]&&(!this.P[i].kp)){if(this.P[i].className.indexOf("rowselected")== -1&&this.cG("onBeforeSelect",[this.P[i].idd,alh])){this.P[i].className+=" rowselected";this.bY[this.bY.length]=this.P[i]}}else{this.pL();return this.bL(el,fl,0,show)}}}else if(nt==2){if(el.parentNode.className.indexOf("rowselected")!= -1){el.parentNode.className=el.parentNode.className.replace(/rowselected/g,"");this.bY.hd(this.bY.bP(el.parentNode));var Nt=true}};this.bB();this.cell=el;if((GZ==el.parentNode)&&(this.adC))fl=false;if(typeof(el.parentNode.idd)=="undefined")return true;this.row=el.parentNode;if((!Nt)&&(!this.row.kp)){if(this.cG("onBeforeSelect",[this.row.idd,alh])){this.row.className+=" rowselected";if(this.bY.bP(this.row)== -1)this.bY[this.bY.length]=this.row}else this.row=GZ};if(this.aaB=="cell"){if(this.cell.parentNode.className.indexOf("rowselected")!= -1)this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected"};if(nt!=1)if(!this.row)return;this.Ms=el.parentNode;var Mj=this.row.idd;var arX=this.cell.A;if(fl&&typeof(Mj)!="undefined")self.Ti=setTimeout(function(){self.cG("onRowSelect",[Mj,arX])},100);if(this.mR("onSelectStateChanged")){var adV=this.bI();if(ajG!=adV)this.cG("onSelectStateChanged",[adV])}};this.ft=true;if(show!==false)this.HZ(this.cell)};this.adx=function(){this.pL();this.bY=cD([].concat(this.P));if(this.bY.length){this.row=this.bY[0];this.cell=this.row.cells[0]};for(var i=0;i<this.P.length;i++)this.P[i].className+=" rowselected";if((this.aC)&&(!this.nh))this.aC.adx()};this.eQ=function(r,vF,fl,iW,edit,show){if(!fl)fl=false;if(typeof(r)!="object")r=this.P[r];if(r.bq)var c=r.childNodes[r.bq[vF]];else var c=r.childNodes[vF];if(iW)this.bL(c,fl,3,show);else this.bL(c,fl,0,show);if(edit)this.gh()};this.HZ=function(Tn,aaS){try{var BZ=Tn.offsetLeft+Tn.offsetWidth+20;if(BZ>(this.HF.offsetWidth+this.HF.scrollLeft)){var scrollLeft=BZ-this.HF.offsetWidth}else if(Tn.offsetLeft<this.HF.scrollLeft){var scrollLeft=Tn.offsetLeft-5};if((scrollLeft)&&(!aaS))this.HF.scrollLeft=scrollLeft;var BZ=Tn.offsetTop+Tn.offsetHeight+20;if(BZ>(this.HF.offsetHeight+this.HF.scrollTop)){var scrollTop=BZ-this.HF.offsetHeight}else if(Tn.offsetTop<this.HF.scrollTop){var scrollTop=Tn.offsetTop-5};if(scrollTop)this.HF.scrollTop=scrollTop}catch(er){}};this.gh=function(){this.bB();if((this.oB!=true)||(!this.cell))return false;var c=this.cell;if(c.parentNode.FG)return false;this.editor=this.cells4(c);if(this.editor!=null){if(this.editor.isDisabled()){this.editor=null;return false};if(this.cG("onEditCell",[0,this.row.idd,this.cell.A])!=false&&this.editor.edit){this.EH=(new Date).valueOf();c.className+=" editable";this.editor.edit();this.cG("onEditCell",[1,this.row.idd,this.cell.A])}else{this.editor=null}}};this.bB=function(mode){if(cU)if(this.EH){if((this.EH*1+50)>(new Date).valueOf())return;this.EH=null};if(this.editor&&this.editor!=null){this.editor.cell.className=this.editor.cell.className.replace("editable","");if(mode){var t=this.editor.ap;this.editor.detach();this.editor.setValue(t);this.editor=null;return};if(this.editor.detach())this.cell.hy=true;var g=this.editor;this.editor=null;var z=this.cG("onEditCell",[2,this.row.idd,this.cell.A,g.getValue(),g.ap]);if((typeof(z)=="string")||(typeof(z)=="number"))g[g.hW?"setLabel":"setValue"](z);else if(!z)g[g.hW?"setLabel":"setValue"](g.ap)}};this.Yc=function(row,dir,pos){row=this.CE(this.P.bP(row),dir);if(!row)return null;return row.childNodes[row.bq?row.bq[pos]:pos]};this.Kn=function(mK,dir,i){mK=mK||this.cell;var nU=this.cell.parentNode;if(this.Wq){i=this.Wq[mK.A];if(typeof i!="undefined")if(i<0)mK=this.Yc(nU,dir,Math.abs(i)-1);else mK=nU.childNodes[i]}else{var i=mK.A+dir;if(i>=0&&i<this.gA){if(nU.bq)i=nU.bq[mK.A]+dir;mK=nU.childNodes[i]}else mK=this.Yc(nU,dir,(dir==1?0:(this.gA-1)))};if(!mK)return null;if(mK.style.display!="none")return mK;return this.Kn(mK,dir)};this.CE=function(ind,dir){var r=this.P[ind+dir];if(r&&r.style.display=="none")return this.CE(ind+dir,dir);return r};this.PP=function(dir){var wc=Math.floor((this.di(this.row.idd)||0)+(dir)*this.HF.offsetHeight/(this.ig||20));if(wc<0)wc=0;if(this.ic&&(!this.P[wc])){this.kh(wc,function(){try{self.eQ(wc,(this.cell?this.cell.A:0),true)}catch(e){}})}else{if(wc>=this.P.length)wc=this.P.length-1;this.eQ(wc,this.cell.A,true)}};this.bQ=function(ev){if(!ev)return true;if((ev.target||ev.srcElement).value!==window.undefined){var zx=(ev.target||ev.srcElement);if((!zx.parentNode)||(zx.parentNode.className.indexOf("editable")== -1))return true};if((globalActiveDHTMLGridObject)&&(this!=globalActiveDHTMLGridObject))return globalActiveDHTMLGridObject.bQ(ev);if(this.ft==false){return true};if(this.Zl)return true;if(!this.cG("onKeyPress",[ev.keyCode,ev.ctrlKey,ev.shiftKey,ev]))return false;var code="k"+ev.keyCode+"_"+(ev.ctrlKey?1:0)+"_"+(ev.shiftKey?1:0);if(this.cell){if(this.zf[code]){if(false===this.zf[code].call(this))return true;if(ev.preventDefault)ev.preventDefault();ev.cancelBubble=true;return false};if(this.zf["k_other"])this.zf.k_other.call(this,ev)};return true};this.arf=function(cell){if(!cell)cell=window.event.srcElement;if(cell.tagName!='TD')cell=cell.parentElement;r=cell.parentElement;if(this.cO[cell.A]=='lk')eval(this.arW+"('"+this.py(r.rowIndex)+"',"+cell.A+")");this.eQ(r,cell.A,true)};this.Th=function(r,fl,iW,show){if(typeof(r)!='object')r=this.P[r];this.eQ(r,0,fl,iW,false,show)};this.xK=function(col,type,order){order=(order||"asc").toLowerCase();type=(type||this.fldSort[col]);while(this.pI(true));if(this.cO.bP("tree")!= -1){return this.sT(col,type,order)};var self=this;var iC=new Array();var aaz=this.cO[col];var agS="getValue";if(aaz=="link")agS="getContent";if(aaz=="dhxCalendar"||aaz=="dhxCalendarA")agS="getDate";for(var i=0;i<this.P.length;i++)iC[this.P[i].idd]=this.cells3(this.P[i],col)[agS]();this.vP(col,type,order,iC)};this.aeo=function(col,type,order,iC,s){var sort="sort";if(this.agg){s["stablesort"]=this.P.gl;sort="stablesort"};if(type.length>4)type=window[type];if(type=='cus'){s[sort](function(a,b){return self.abz[col](iC[a.idd],iC[b.idd],order,a.idd,b.idd)})}else if(typeof(type)=='function'){s[sort](function(a,b){return type(iC[a.idd],iC[b.idd],order,a.idd,b.idd)})}else if(type=='str'){s[sort](function(a,b){if(order=="asc")return iC[a.idd]>iC[b.idd]?1: -1;else return iC[a.idd]<iC[b.idd]?1: -1})}else if(type=='int'){s[sort](function(a,b){var qe=parseFloat(iC[a.idd]);qe=isNaN(qe)? -99999999999999:qe;var sm=parseFloat(iC[b.idd]);sm=isNaN(sm)? -99999999999999:sm;if(order=="asc")return qe-sm;else return sm-qe})}else if(type=='date'){s[sort](function(a,b){var qe=Date.parse(iC[a.idd])||(Date.parse("01/01/1900"));var sm=Date.parse(iC[b.idd])||(Date.parse("01/01/1900"));if(order=="asc")return qe-sm;else return sm-qe})}};this.vP=function(col,type,order,iC){this.aeo(col,type,order,iC,this.P);if(this.ip){this.ee(this.ew);this.cG("onGridReconstructed",[])}else{var tb=(cn)?this.obj:this.obj.rows[0].parentNode;for(var i=0;i<this.P.length;i++){if(this.P[i]!=this.obj.wn(i))tb.insertBefore(this.P[i],this.obj.wn(i))}};this.cG("onGridReconstructed",[])};this.eG=function(bU,wH){if(arguments.length==0)return(this.akl=true);this.kD=false;this.tR=bU;this.cu=wH||(this.cu==0?40:this.cu)};this.wZ=function(wH){this.cu=wH||(this.cu==0?40:this.cu)};this.pI=function(ahc){if(this.aD[0].length==0){if(!this.kD&& !ahc){if(this.limit&&this.P.length>=this.limit)return false;if((this.tR!="")&&(!this.rf)){this.rf=true;this.loadXML(this.tR)}}else return false};var wQ=Math.min(this.cu,this.aD[0].length);for(var i=0;i<wQ;i++){if(this.aD[1][0].tagName=="TR"){this._insertRowAt(this.aD[1][0],-1,this.ip)}else{var yp=this.aD[1][0];var r=this.rX(yp);this._insertRowAt(r,-1,this.ip);this.jQ(r,yp)};this.aD[0].hd(0);this.aD[1].hd(0)};return this.aD[0].length!=0};this.rX=function(yp){if(yp.tagName=="TR")return yp;var tree=this.cO.bP("tree");var Am=yp.getAttribute("id");this.bj[Am]=this.uO(Am);var r=this.jc(this.bj[Am],yp,tree,null);return r};this.Rn=function(fl){this.gN=K(fl)};this.gF=function(ev){var el=this.cd(bf?ev.srcElement:ev.target,"TD");if(el){var cq=el.parentNode.idd;return this.cG("onRowDblClicked",[cq,el.A])}};this.FJ=function(e,el){var that=this.grid;el=el||that.cd(bf?event.srcElement:e.target,"TD");if(this.grid.RD==null){if(!(this.grid.cG("onHeaderClick",[el.hp,(e||window.event)])))return false;that.adU(el.hp,false,el)}};this.iu=function(){this.Yb()};this.Yb=function(){var num=this.bY.length;if(num==0)return;var anb=this.bY;this.bY=new cD(0);for(var i=num-1;i>=0;i--){var node=anb[i];if(!this.deleteRow(node.idd,node)){this.bY[this.bY.length]=node}else{if(node==this.row){var ind=i}}};if(ind){try{if(ind+1>this.P.length)ind--;this.eQ(ind,0,true)}catch(er){this.row=null;this.cell=null}}};this.acg=function(){return this.bI()};this.bI=function(){var UC=new Array(0);var aov={};for(var i=0;i<this.bY.length;i++){var id=this.bY[i].idd;if(aov[id])continue;UC[UC.length]=id;aov[id]=true};if(UC.length==0)return null;else return UC.join(this.gX)};this.iL=function(){if(this.cell!=null)return this.cell.A;else return-1};this.yI=function(ind){return parseInt(this.cellWidthPX[ind])+((ca)?2:0)};this.EF=function(ind,value){if(this.fL=='px')this.cellWidthPX[ind]=parseInt(value);else this.cellWidthPC[ind]=parseInt(value);this.setSizes()};this.dz=function(id){var row=this.bj[id];if(row)return row;else if(this.ic){var ind=this.aD[0].bP(id);if(ind>=0){this.kh(ind);return this.dz(unescape(id))}}else if(this.ip){var ind=this.aD[0].bP(id);if(ind>=0){var r=this.rX(this.aD[1][ind]);this.jQ(r,this.aD[1][ind]);this.aD[1][ind]=r;return r}else{return null}}else if(this.mI)return this.RW(id);return null};this.ajV=function(ind){if(this.P.length<=ind){if((this.P.length+this.aD[0].length)<=ind)return null;else{var afO=ind-this.P.length-1;var r=this.rX(this.aD[1][afO]);return r}}else{return this.P[ind]}};this.di=function(bO){var ind=this.P.bP(this.dz(bO));if(ind!= -1)return ind;else{ind=this.aD[0].bP(bO);if(ind!= -1)return ind+this.P.length;return-1}};this.py=function(ind){var z=this.P[parseInt(ind)];if(z)return z.idd;return(this.aD[0][this.ic?ind:(ind-this.P.length)]||null)};this.agA=function(ind,bO){var r=this.P[ind];this.bK(r.idd,bO)};this.bK=function(qX,vu){if(qX==vu)return;var row=this.bj[qX];row.idd=vu;if(this.da[qX]){this.da[vu]=this.da[qX];this.da[qX]=null};if(this.dP&&this.dP.get[qX]){this.dP.get[vu]=this.dP.get[qX];this.dP.get[vu].id=vu;delete this.dP.get[qX]};if(this.aD[0]){var ind=this.aD[0].bP(qX);if(ind!= -1)this.aD[0][ind]==vu};this.bj[qX]=null;this.bj[vu]=row;for(var i=0;i<row.childNodes.length;i++)if(row.childNodes[i].Lq)row.childNodes[i].Lq=this.MB(row.childNodes[i].AB,row.childNodes[i])};this.wL=function(ids){if(ids)this.vT=ids.split(this.gX);if(this.hdr.rows.length>0){if(this.hdr.rows[0].cells.length>=this.vT.length){for(var i=0;i<this.vT.length;i++){this.hdr.rows[0].cells[i].JF=this.vT[i]}}}};this.amG=function(ind,id){this.vT[ind]=this.hdr.rows[0].cells[ind].JF=id};this.eZ=function(id){for(var i=0;i<this.hdr.rows[0].cells.length;i++){if(this.hdr.rows[0].cells[i].JF==id)return i}};this.Mr=function(agY){return this.hdr.rows[0].cells[agY].JF};this.adE=function(agY,rin){return this.wW(agY,rin)};this.wW=function(agY,ind){var z=this.hdr.rows[(ind||0)+1];var n=z.cells[z.bq?z.bq[parseInt(agY)]:agY];return(bf?n.innerText:n.textContent)};this.tG=function(bO){this.dz(bO).style.fontWeight="bold"};this.jb=function(bO,jp){var r=this.dz(bO);for(var i=0;i<r.childNodes.length;i++){var yb="";if((this.L)&&(this.L[i]))yb="display:none;";if(bf)r.childNodes[i].style.cssText=yb+"width:"+r.childNodes[i].style.width+";"+jp;else r.childNodes[i].style.cssText=yb+"width:"+r.childNodes[i].style.width+";"+jp}};this.EA=function(bO,color){var r=this.dz(bO);for(var i=0;i<r.childNodes.length;i++)r.childNodes[i].bgColor=color};this.vH=function(bO,ind,jp){var r=this.dz(bO);if(!r)return;if(ind<r.childNodes.length){var yb="";if((this.L)&&(this.L[ind]))yb="display:none;";if(bf)r.childNodes[ind].style.cssText=yb+"width:"+r.childNodes[ind].style.width+";"+jp;else r.childNodes[ind].style.cssText=yb+"width:"+r.childNodes[ind].style.width+";"+jp}};this.rn=function(bO){this.dz(bO).style.fontWeight="normal"};this.aai=function(bO){if(this.dz(bO)!=null)return true;else return false};this.Xu=function(bO){return this.aai(bO)};this.iD=function(){if(this.ic)return this.limit;return this.P.length+this.aD[0].length};this.adG=function(){return this.hdr.rows[0].cells.length};this.So=function(){return this.hdr.rows[0].cells.length};this.zs=function(bO){var r=this.dz(bO);if(this.gY())return this.MN(bO,-1);var RM=this.P.bP(r);if((r.previousSibling)&&(RM!=0)){r.parentNode.insertBefore(r,r.previousSibling);this.P.yk(RM,RM-1);this.setSizes();if(this.hC)this.O(RM-1)}};this.uQ=function(bO){var r=this.dz(bO);if(this.gY())return this.MN(bO,1);var RM=this.P.bP(r);if(r.nextSibling){this.P.yk(RM,RM+1);if(r.nextSibling.nextSibling)r.parentNode.insertBefore(r,r.nextSibling.nextSibling);else r.parentNode.appendChild(r);this.setSizes();if(this.hC)this.O(RM)}};this.apX=function(bO,col){return this.cells(bO,col)};this.cells=function(bO,col){if(arguments.length==0)return this.cells4(this.cell);else var c=this.dz(bO);if(!c&& !window.eXcell_math)ey.gn("cell","Row not exists",[bO,col]);var cell=(c.bq?c.childNodes[c.bq[col]]:c.childNodes[col]);return this.cells4(cell)};this.amP=function(acF,col){return this.cells2(acF,col)};this.cells2=function(acF,col){var c=this.P[parseInt(acF)];if(!c&& !window.eXcell_math)ey.gn("cell","Row not exists",[bO,col]);var cell=(c.bq?c.childNodes[c.bq[col]]:c.childNodes[col]);return this.cells4(cell)};this.cells3=function(row,col){var cell=(row.bq?row.childNodes[row.bq[col]]:row.childNodes[col]);return this.cells4(cell)};this.cells4=function(cell){var type=window["eXcell_"+(cell.zk||this.cO[cell.A])];if(type)return new type(cell)};this.adH=function(cell){var type=cell.zk||this.cO[cell.A];if(!this.XC[type])this.XC[type]=eval("new eXcell_"+type+"(cell)");this.XC[type].cell=cell;return this.XC[type]};this.dma=function(mode){if(!this.XC)this.XC={};if(mode&& !this.abp){this.abp=this.cells4;this.cells4=this.adH}else if(!mode&&this.abp){this.cells4=this.abp;this.abp=null}};this.cf=function(mf){if(!this.combos[mf]){this.combos[mf]=new lU()};return this.combos[mf]};this.setUserData=function(bO,name,value){try{if(bO=="")bO="gridglobaluserdata";if(!this.da[bO])this.da[bO]=new qB();this.da[bO].eT(name,value)}catch(er){alert("UserData Error:"+er.description)}};this.getUserData=function(bO,name){this.dz(bO);if(bO=="")bO="gridglobaluserdata";var z=this.da[bO];return(z?z.get(name):"")};this.Ys=function(fl){this.oB=K(fl)};this.dX=function(bO,ajh,show,call){if(!call)call=false;this.eQ(this.dz(bO),0,call,ajh,false,show)};this.pL=function(){this.bB();for(var i=0;i<this.bY.length;i++){var r=this.bj[this.bY[i].idd];if(r)r.className=r.className.replace(/rowselected/g,"")};this.bY=new cD(0);this.row=null;if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,"");this.cell=null}};this.RK=function(from_row_id,zH){var QC=this.dz(from_row_id);if(!this.gY())for(var i=0;i<QC.cells.length;i++){this.cells(zH,i).setValue(this.cells(from_row_id,i).getValue())}else this.DF(QC,from_row_id,zH);if(!isIE())this.dz(from_row_id).cells[0].height=QC.cells[0].offsetHeight};this.adA=function(c,label,ind){this.Cs(c,label,ind)};this.Cs=function(c,label,ind){var z=this.hdr.rows[ind||1];var col=(z.bq?z.bq[c]:c);if(!this.pH){var La="<div class='hdrcell'>";if(label.indexOf('img:[')!= -1){var anc=label.replace(/.*\[([^>]+)\].*/,"$1");label=label.substr(label.indexOf("]")+1,label.length);La+="<img width='18px' height='18px' align='absmiddle' src='"+anc+"' hspace='2'>"};La+=label;La+="</div>";z.cells[col].innerHTML=La;if(this.Oi[col])z.cells[col].style.cssText=this.Oi[col]}else{z.cells[col].style.textAlign="left";z.cells[col].innerHTML="<img src='"+this.eg+""+label+"' onerror='this.src = \""+this.eg+"imageloaderror.gif\"'>";var a=new Image();a.src=this.eg+""+label.replace(/(\.[a-z]+)/,".desc$1");this.sf[this.sf.length]=a;var b=new Image();b.src=this.eg+""+label.replace(/(\.[a-z]+)/,".asc$1");this.sf[this.sf.length]=b};if((label||"").indexOf("#")!= -1){var t=label.match(/(^|{)#([^}]+)(}|$)/);if(t){var tn="_in_header_"+t[2];if(this[tn])this[tn]((this.qW?z.cells[col].firstChild:z.cells[col]),col,label.split(t[0]))}}};this.clearAll=function(header){if(this.dP){this.dP=new Ei();if(this.aC){if(this.nh)this.dP=this.aC.dP;else this.aC.dP=this.dP}};this.limit=this.LC=0;this.bB();if(this.ut)window.clearTimeout(this.ut);if(this.ic){this.HF.scrollTop=0;this.limit=this.LC||0;this.CV=true};var Bj=this.P.length;if(this.lk!=null){this.lk.clear();this.lk.eT("hashOfParents",new qB())};Bj=this.obj.ns();for(var i=Bj-1;i>=0;i--){var acY=this.obj.wn(i);acY.parentNode.removeChild(acY)};if(header&&this.obj.rows[0]){this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(var i=this.hdr.rows.length-1;i>=0;i--){var acY=this.hdr.rows[i];acY.parentNode.removeChild(acY)};if(this.ftr){this.ftr.parentNode.removeChild(this.ftr);this.ftr=null};this._aHead=this.ftr=this._aFoot=null;this.L=[]};this.row=null;this.cell=null;this.P=new cD(0);this.bj=new Array(0);this.aD=new Array(new cD(0),new cD(0));this.da=new Array(0);this.bY=new cD(0);if(this.ip){this.tR="";this.kD=null;this.ee(1)};if(this.Bf)window.clearTimeout(this.Bf);if(this.agg)this.xC(true);this.ky(false);this.setSizes();this.cG("onClearAll",[])};this.adU=function(ind,Vj,afe){if(this.iD()==0)return false;var el=this.hdr.rows[0].cells[ind];if(!el)return;if(el.tagName=="TH"&&(this.fldSort.length-1)>=el.A&&this.fldSort[el.A]!='na'){if((((this.gB.src.indexOf("_desc.gif")== -1)&&(!Vj))||((this.gB.style.filter!="")&&(Vj)))&&(this.ij==el))var HL="des";else var HL="asc";if(!this.cG("onBeforeSorting",[ind,this,HL]))return;this.gB.src=this.eg+"sort_"+(HL=="asc"?"asc":"desc")+".gif";if(this.pH){var ahk=this.hdr.rows[1].cells[el.A].firstChild;if(this.ij!=null){var akm=this.hdr.rows[1].cells[this.ij.A].firstChild;akm.src=akm.src.replace(/\.[ascde]+\./,".")};ahk.src=ahk.src.replace(/(\.[a-z]+)/,"."+HL+"$1")};this.xK(el.A,this.fldSort[el.A],HL);this.ij=el;this.yH=afe;var c=this.hdr.rows[1];var c=afe.parentNode;var aqB=c.bq?c.bq[el.A]:el.A;this.vo(false,false,false,afe)};this.cG("onAfterSorting",[])};this.setCustomSorting=function(aQ,col){if(!this.abz)this.abz=new Array();this.abz[col]=(typeof(aQ)=="string")?eval(aQ):aQ;this.fldSort[col]="cus"};this.Jq=function(fl){this.pH=fl};this.setHeader=function(Vb,JP,akR){if(typeof(Vb)!="object")var UK=this.ZK(Vb);else UK=[].concat(Vb);var VW=new Array(0);var abA=new cD(0);var aaI=new Array(0);var Xr=new Array(0);var abx=new Array(0);for(var i=0;i<UK.length;i++){VW[VW.length]=Math.round(100/UK.length);abA[abA.length]="ed";aaI[aaI.length]="left";Xr[Xr.length]="";abx[abx.length]="na"};this.JP=JP||"#cspan";this.ep=UK;this.aoX=VW;this.cO=abA;this.dV=aaI;this.fb=Xr;this.fldSort=abx;this.Oi=akR||[]};this.ZK=function(str){if(![].push)return str.split(this.gX);var a="r"+(new Date()).valueOf();var z=this.gX.replace(/([\|\+\*\^])/g,"\\$1");return(str||"").replace(RegExp(z,"g"),a).replace(RegExp("\\\\"+a,"g"),this.gX).split(a)};this.abv=function(vF){return this.cO[vF]};this.aii=function(cID){return this.cO[this.eZ(cID)]};this.be=function(ajo){this.cO=cD(ajo.split(this.gX));this.ga=new Array();for(var i=0;i<this.cO.length;i++)if((this.cO[i].indexOf("[")!= -1)){var z=this.cO[i].split(/[\[\]]+/g);this.cO[i]=z[0];this.QL[i]=z[1];if(z[1].indexOf("=")==0){this.cO[i]="math";this.ga[i]=z[0]}}};this.bm=function(aiD){this.fldSort=aiD.split(this.gX);for(var i=0;i<this.fldSort.length;i++)if(((this.fldSort[i]).length>4)&&(typeof(window[this.fldSort[i]])=="function")){if(!this.abz)this.abz=new Array();this.abz[i]=window[this.fldSort[i]];this.fldSort[i]="cus"}};this.bw=function(ZL){this.dV=ZL.split(this.gX)};this.gO=function(valStr){this.fb=valStr.split(this.gX)};this.CB=function(fl){if(fl==true)this.hu= -1};this.amq=function(fl){if(K(fl)==true)this.sB=true};this.aqG=function(UD){if(this.ip){if(this.bj[UD])this.ee(Math.floor(this.di(UD)/this.cu)+1);else while((!this.bj[UD])&&(this.aD[0].length>0|| !this.kD))this.ee(this.ew+1)};var c=this.dz(UD).cells[0];while(c&&c.style.display=="none")c=c.nextSibling;if(c)this.HZ(c,true)};this.mp=function(aeu,aiL,Pa,aet){this.Gz=[aeu,aiL,Pa,Pa,aet];var ZR=["#"+this.aL.id+" table.hdr td","#"+this.aL.id+" table.obj td","#"+this.aL.id+" table.obj tr.rowselected td.cellselected","#"+this.aL.id+" table.obj td.cellselected","#"+this.aL.id+" table.obj tr.rowselected td"];for(var i=0;i<ZR.length;i++)if(this.Gz[i]){if(bf)this.styleSheet[0].addRule(ZR[i],this.Gz[i]);else this.styleSheet[0].insertRule(ZR[i]+" {"+this.Gz[i]+" };",0)}};this.bz=function(arp){this.dO=arp.split(this.gX)};this.lj=function(alF,alH,aeU,Yf){if(alF||alH)this.pD(function(){if(!this.Cw)this.O()});this.Cw=aeU;this.Vh=Yf;this.hC=alF;this.iI=alH};this.O=function(ind){if(this.Cw&&this.gY())return this.Sb(ind);ind=ind||0;var j=ind;for(var i=ind;i<this.P.length;i++){if(!this.P[i])continue;if(this.P[i].style.display!="none"){if(this.P[i].className.indexOf("rowselected")!= -1){if(j%2==1)this.P[i].className=this.iI+" rowselected"+(this.P[i].Vn||"");else this.P[i].className=this.hC+" rowselected"+(this.P[i].Vn||"")}else{if(j%2==1)this.P[i].className=this.iI+(this.P[i].Vn||"");else this.P[i].className=this.hC+(this.P[i].Vn||"")};j++}}};this.KQ=function(){for(var i=0;i<this.P.length;i++){var row=this.P[i];var cols=row.childNodes.length;for(var j=0;j<cols;j++)row.childNodes[j].hy=false}};this.Dk=function(){var res=new Array();this.fm(function(id){var row=this.bj[id];var cols=row.childNodes.length;for(var j=0;j<cols;j++)if(row.childNodes[j].hy){res[res.length]=row.idd;break}});return res.join(this.gX)};this.Jb=false;this.Jr=false;this.fu=function(userData,QT,config,GM,GA,MZ){this.Jb=userData;this.Jr=QT;this.Ld=config;this.Zx=GM;this.xq=GA;this.LB=MZ};this.pm=function(list){if(!list){this.nF=null;return};this.nF=(list||"").split(",");for(var i=0;i<this.nF.length;i++)this.nF[i]=K(this.nF[i])};this.JS=function(Nv,inner,closed){this.bB();var bW=[];var i=0;var j=0;var afE=(this.ic)?this.aD[0].length:Nv.length;if(this.gY()){var f=function(id,f){var str=[];var z=self.dP.get[id];if(0!=id)str.push(self.xO(self.bj[id],i));if(z.bu.length==0&&self.bj[id].Q){var xar=self.bj[id].Q;for(var i=0;i<xar.length;i++)if(self.kE)str.push(self.kE.serializeToString(xar[i]));else str.push(xar[i].xml)}else for(var i=0;i<z.bu.length;i++)str.push(f(z.bu[i].id,f));if(0!=id)str.push("</row>\n");return str.join("")};bW.push(f(0,f))}else for(i;i<afE;i++){var r=Nv[i];var AT=this.xO(r,i);bW.push(AT);if((AT!="")&&r&&(!r.kp)&&(!r.kl))bW.push("</row>")};return[bW.join(""),j+i]};this.yd=function(r){var bW="<row id='"+r.getAttribute("id")+"'>";var i=0;for(var jj=0;jj<r.childNodes.length;jj++){var z=r.childNodes[jj];if(z.tagName!="cell")continue;if((!this.nF)||(this.nF[i]))bW+="<cell>"+(z.firstChild?z.firstChild.data:"")+"</cell>";i++};bW+="</row>";return bW};this.xO=function(r,i){var bW=[];if((!r)||(r.kp)||(r.kl)){if(this.xq)return "";if(this.aD[1][i]){if(this.kE)bW=this.kE.serializeToString(this.aD[1][i]);else bW=this.aD[1][i].xml};return bW};var KG="";if(this.Jr&&this.bY.bP(r)!= -1)KG=" selected='1'";bW.push("<row id='"+r.idd+"'"+KG+" "+((this.dP&&this.dP.get[r.idd].state=="minus")?"open='1'":"")+">");if(this.Jb&&this.da[r.idd]){vU=this.da[r.idd].Ln();for(var ii=0;ii<vU.length;ii++){bW.push("<userdata name='"+vU[ii]+"'>"+this.da[r.idd].get(vU[ii])+"</userdata>")}};var xJ=false;for(var jj=0;jj<r.childNodes.length;jj++){if((!this.nF)||(this.nF[jj])){var DJ=r.childNodes[jj];bW.push("<cell");var zx=this.cells(r.idd,DJ.A);if(zx.cell)wF=zx[this.zt]();else wF="";if(wF===null)wF="";if(this.LB)wF="<![CDATA["+wF+"]]>";if((this.CP)&&(DJ.colSpan)&&DJ.colSpan>1)bW.push(" colspan=\""+DJ.colSpan+"\" ");if(zx.xg)bW.push(" "+zx.xg());if(this.Zx){if(zx.hy()){bW.push(" changed=\"1\"");xJ=true}}else if((this.xq)&&(zx.hy()))xJ=true;if(this.Jr)bW.push((this.dP?(" image='"+this.dP.get[r.idd].image+"'"):"")+">"+wF+"</cell>");else bW.push(">"+wF+"</cell>");if((this.CP)&&(DJ.colSpan)){DJ=DJ.colSpan-1;for(var u=0;u<DJ;u++)bW.push("<cell/>")}}};if((this.xq)&&(!xJ)&&(!r.adM))return "";return bW.join("")};this.Aj=function(){var bW="<head>";for(var i=0;i<this.hdr.rows[0].cells.length;i++){bW+="<column width='"+this.cellWidthPX[i]+"' align='"+this.dV[i]+"' type='"+this.cO[i]+"' sort='"+this.fldSort[i]+"' color='"+this.dO[i]+"'"+(this.vT[i]?(" id='"+this.vT[i]+"'"):"")+">";bW+=this.wW(i);var z=this.cf(i);if(z)for(var j=0;j<z.kk.length;j++)bW+="<option value='"+z.kk[j]+"'>"+z.gT[j]+"</option>";bW+="</column>"};return bW+="</head>"};this.Aa=function(){if(ca)this.kE=new XMLSerializer();var bW='<?xml version="1.0"?><rows>';if(this.oX)this.zt="getMathValue";else this.zt="getValue";if(this.Jb&&this.da["gridglobaluserdata"]){var vU=this.da["gridglobaluserdata"].Ln();for(var i=0;i<vU.length;i++){bW+="<userdata name='"+vU[i]+"'>"+this.da["gridglobaluserdata"].get(vU[i])+"</userdata>"}};if(this.Ld)bW+=this.Aj();bW+=this.JS(this.P)[0];if(!this.ic){for(var i=0;i<this.aD[1].length;i++){if(this.aD[1][i].tagName=="TR"){}else{if(!this.xq){if(this.nF)bW+=this.yd(this.aD[1][i]);else if(!this.kE)bW+=this.aD[1][i].xml;else{bW+=this.kE.serializeToString(this.aD[1][i])}}}}};bW+='</rows>';return bW};this.lX=function(aQ,agm){this.attachEvent("onRowSelect",aQ);this.adC=(!K(agm))};this.acB=function(aQ){this.attachEvent("onScroll",aQ)};this.ks=function(aQ){this.attachEvent("onEditCell",aQ)};this.uq=function(aQ){this.attachEvent("onCheckbox",aQ)};this.Dr=function(aQ){this.attachEvent("onEnter",aQ)};this.yq=function(aQ){this.attachEvent("onBeforeRowDeleted",aQ)};this.aab=function(aQ){this.attachEvent("onRowAdded",aQ)};this.pD=function(aQ){this.attachEvent("onGridReconstructed",aQ)};D.prototype.XT=function(aQ){this.attachEvent("onResize",aQ)};D.prototype.Lc=function(aQ){this.attachEvent("onBeforeSelect",aQ)};D.prototype.Mh=function(aQ){this.attachEvent("onRowCreated",aQ)};D.prototype.dT=function(aQ){this.attachEvent("onXLE",aQ)};D.prototype.Ly=function(aQ){this.attachEvent("onCellChanged",aQ)};D.prototype.eF=function(aQ){this.attachEvent("onXLS",aQ)};D.prototype.setOnColumnSort=function(aQ){this.attachEvent("onBeforeSorting",aQ)};this.Ge=function(aQ){this.attachEvent("onSelectStateChanged",aQ)};this.setOnRowDblClickedHandler=function(aQ){this.attachEvent("onRowDblClicked",aQ)};this.Gh=function(aQ){this.attachEvent("onHeaderClick",aQ)};D.prototype.Sd=function(aQ){this.attachEvent("onResizeEnd",aQ)};this.fI=function(PN,Bx){if(!Bx)var Bx=document.body;var dJ=PN;var uW=0;var AP=0;while((dJ)&&(dJ!=Bx)){uW+=dJ.offsetLeft-dJ.scrollLeft;AP+=dJ.offsetTop-dJ.scrollTop;dJ=dJ.offsetParent};if(Bx==document.body){if(bf){if(document.documentElement.scrollTop)AP+=document.documentElement.scrollTop;if(document.documentElement.scrollLeft)uW+=document.documentElement.scrollLeft}else if(!ca){uW+=document.body.offsetLeft;AP+=document.body.offsetTop}};return new Array(uW,AP)};this.cd=function(obj,uh){while(obj&&obj.tagName!=uh&&obj.tagName!="BODY"){obj=obj.parentNode};return obj};this.gw=function(wQ){alert('gw method deprecated')};this.showContent=function(){alert('showContent method deprecated')};this.HF.onscroll=new Function("","this.grid._doOnScroll()");if((!cU)||(pe>8.5)){this.hdr.onmousemove=new Function("e","this.grid.bX(e||window.event)");this.hdr.onmousedown=new Function("e","return this.grid.eJ(e||window.event)")};this.obj.onmousemove=this.Xj;this.obj.onclick=new Function("e","this.grid.aV(e||window.event);if (this.grid.aU)this.grid.gh(e||window.event);(e||event).cancelBubble=true;");if(gP){this.aL.oncontextmenu=new Function("e","return this.grid._doContClick(e||window.event);")};this.aL.onmousedown=new Function("e","return this.grid._doContClick(e||window.event);");this.obj.ondblclick=new Function("e","if(!this.grid.gF(e||window.event)){return false};if (this.grid.aP)this.grid.gh(e||window.event);(e||event).cancelBubble=true;");this.hdr.onclick=this.FJ;this.gB.onclick=function(){self.FJ.apply({grid:self},[null,self.yH])};this.hdr.ondblclick=this.LI;if(!document.body.FO){dE(document,"keydown",new Function("e","if (globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.bQ(e||window.event);return true;"));document.body.FO=true};dE(document.body,"click",function(){if(self.bB)self.bB()});this.aL.onbeforeactivate=new Function("","this.QX=null;this.grid.setActive();event.cancelBubble=true;");this.aL.onbeforedeactivate=new Function("","if (this.grid.QX)this.grid.QX=null;else this.grid.ft=false;event.cancelBubble=true;");this.KK=function(row){};if(this.aL.style.height.toString().indexOf("%")!= -1)this.tZ();return this};D.prototype.gY=function(){return(this.cO.bP("tree")!= -1)};D.prototype.hY=function(oO,text,ind){var r=this.ait(oO,text,ind);if(!this.fX)this.cG("onRowAdded",[oO]);this.cG("onRowCreated",[r.idd,r,null]);if(this.ip)this.ee(this.ew);this.setSizes();r.adM=true;this.cG("onGridReconstructed",[]);return r};D.prototype.uO=function(oO){var r=document.createElement("TR");r.idd=oO;r.grid=this;for(var i=0;i<this.hdr.rows[0].cells.length;i++){var c=document.createElement("TD");if(this.ajm)c.id="c_"+r.idd+"_"+i;c.A=i;if(this.nz)this.M.dS(c,this);if(this.dV[i])c.align=this.dV[i];c.style.verticalAlign=this.fb[i];c.bgColor=this.dO[i]||"";if((this.L)&&(this.L[i]))c.style.display="none";r.appendChild(c)};return r};D.prototype.VQ=function(r,text){if(!this.vS)this.bB();this.WS=true;this.vN=false;if(typeof(text)!='object')text=(text||"").split(this.gX);for(var i=0;i<r.childNodes.length;i++){if((i<text.length)||(this.QL[i])){var ap=text[i];if((this.QL[i])&&((ap=="")||(typeof(ap)=="undefined")))ap=this.QL[i];if((this.ic)&&(this.bj[r.idd]))var Lh=this.cells3(r,r.childNodes[i].A);else Lh=this.cells4(r.childNodes[i]);Lh.setValue(ap);Lh=Lh.fA()}else{var ap="&nbsp;";r.childNodes[i].innerHTML=ap;r.childNodes[i].mG=true}};this.WS=false;if((this.vN)&&(!this.vS)){for(var i=0;i<this.hdr.rows[0].cells.length;i++)this.lE(r.childNodes[i]);this.vN=false};return r};D.prototype._insertRowAt=function(r,ind,Ch){if((ind<0)||((!ind)&&(parseInt(ind)!==0)))ind=this.P.length;else{if(ind>this.P.length)ind=this.P.length};if(this.hC){if((this.Cw?this.sS(r.idd):ind)%2==1)r.className+=" "+this.iI+(this.Vh?(this.iI+"_"+this.sS(r.idd)):"");else r.className+=" "+this.hC+(this.Vh?(" "+this.hC+"_"+this.sS(r.idd)):"")};if(r.WX){this.bj[r.idd]=r;return r};if(!Ch)if((ind==(this.obj.rows.length-1))||(!this.P[ind]))if(cn)this.obj.appendChild(r);else{this.obj.firstChild.appendChild(r)}else{this.P[ind].parentNode.insertBefore(r,this.P[ind])};this.bj[r.idd]=r;this.P.ml(ind,r);if(this.hC){if(!this.Cw&&(ind!=(this.P.length-1)))this.O(ind+1)};this.KK(r);if((this.vN)&&(!this.vS)){for(var i=0;i<this.hdr.rows[0].cells.length;i++)this.lE(r.childNodes[i]);this.vN=false};return r};D.prototype.ait=function(oO,text,ind){var row=this.VQ(this.uO(oO),text);if(!this.ic)if((ind>this.P.length&&ind<(this.P.length+this.aD[0].length))||(typeof ind=="undefined"&&this.aD[0].length)){if(typeof ind=="undefined")var Wl=this.aD[0].length;else var Wl=ind-this.P.length;this.aD[0].ml(Wl,oO);this.aD[1].ml(Wl,row);return row};return this._insertRowAt(row,ind)};D.prototype.sO=function(id,state){var f=K(state);var row=this.dz(id);if(!row)return;if(row.expand==="")this.collapseKids(row);if((state)&&(row.style.display!="none")){row.style.display="none";var z=this.bY.bP(row);if(z!= -1){row.className=row.className.replace("rowselected","");for(var i=0;i<row.childNodes.length;i++)row.childNodes[i].className=row.childNodes[i].className.replace(/cellselected/g,"");this.bY.hd(z)};this.cG("onGridReconstructed",[])};if((!state)&&(row.style.display=="none")){row.style.display="";this.cG("onGridReconstructed",[])};this.setSizes()};D.prototype.setColumnHidden=function(ind,state){if(!this.hdr.rows.length){if(!this.Az)this.Az=[];return this.Az[ind]=state};if((this.ij)&&(this.ij.cellIndex==ind)&&(state))this.gB.style.display="none";var f=K(state);if(f){if(!this.L)this.L=new Array();else if(this.L[ind])return;this.L[ind]="display:none;";this.wx(ind,"none")}else{if((!this.L)||(!this.L[ind]))return;this.L[ind]="";this.wx(ind,"")};if((this.ij)&&(this.ij.cellIndex==ind)&&(!state))this.gB.style.display="inline"};D.prototype.Fs=function(ind){if((this.L)&&(this.L[ind]))return true;return false};D.prototype.abt=function(list){this.FM(list)};D.prototype.FM=function(list){if(list)this.Az=list.split(",");if(this.hdr.rows.length&&this.Az)for(var i=0;i<this.Az.length;i++)this.setColumnHidden(i,this.Az[i])};D.prototype.pM=function(pb,ind,Nq,state){var z=pb.rows.length;for(var i=0;i<z;i++){var x=pb.rows[i].cells;if(x.length!=this.gA){for(var j=0;j<x.length;j++)if(x[j].A==ind){x[j].style[Nq]=state;break}}else x[ind].style[Nq]=state}};D.prototype.wx=function(ind,state){var OC=ind;if((this.hdr.rows[1].bq)&&(this.hdr.rows[1].bq[ind]!=ind))OC=this.hdr.rows[1].bq[ind];if(state=="none"){this.hdr.rows[0].cells[ind].uE=this.hdr.rows[0].cells[ind].style.width;this.hdr.rows[0].cells[ind].Ce=this.cellWidthPC[ind];this.obj.rows[0].cells[ind].style.width="0px";this.pM(this.obj,ind,"display","none");if(this.oj)this.oj(ind,"none");if((cU&&pe<9)||cn||(ca)){this.pM(this.hdr,ind,"display","none");if(this.ftr)this.pM(this.ftr.childNodes[0],ind,"display","none")};this.pM(this.hdr,ind,"whiteSpace","nowrap");if(!this.cellWidthPX.length&& !this.cellWidthPC.length)this.cellWidthPX=[].concat(this.cZ);if(this.cellWidthPX[ind])this.cellWidthPX[ind]=0;if(this.cellWidthPC[ind])this.cellWidthPC[ind]=0}else{if(this.hdr.rows[0].cells[ind].uE){var zrow=this.hdr.rows[0].cells[ind];if(cU||cn||(ca))this.pM(this.hdr,ind,"display","");if(this.ftr)this.pM(this.ftr.childNodes[0],ind,"display","");this.obj.rows[0].cells[ind].style.width=this.hdr.rows[0].cells[ind].uE;this.pM(this.obj,ind,"display","");if(this.oj)this.oj(ind,"");zrow.style.width=zrow.uE;this.pM(this.hdr,ind,"whiteSpace","normal");if(zrow.Ce)this.cellWidthPC[ind]=zrow.Ce;if(zrow.uE)this.cellWidthPX[ind]=parseInt(zrow.uE)}};this.setSizes();if((!bf)&&(!ca)){this.obj.border=1;this.obj.border=0}};D.prototype.Pr=function(mode){this.CP=K(mode)};D.prototype.enableCollSpan=function(mode){this.CP=K(mode)};D.prototype.oC=function(mode,afT){this.Lk=afT;if(K(mode)){if(!this.Qh){this.obj.Io=this.obj.onmousemove;this.obj.onmousemove=this.xb;if(bf)this.obj.onmouseleave=this.Rz;else this.obj.onmouseout=this.Rz;this.Qh=true}}else{if(this.Qh){this.obj.onmousemove=this.obj.Io;if(bf)this.obj.onmouseleave=null;else this.obj.onmouseout=null;this.Qh=false}}};D.prototype.rg=function(click,Ns,anG){this.aU=K(click);this.aP=K(Ns);this.UB=K(anG)};D.prototype.hH=function(mode){if(K(mode)){if(!this.UJ){this.aL.age=this.aL.onclick;this.aL.onclick=function(){return true};this.obj.age=this.obj.onclick;this.obj.onclick=function(e){var c=this.grid.cd(e?e.target:event.srcElement,'TD');this.grid.bB();this.grid.bL(c);this.grid.gh();(e||event).cancelBubble=true};this.obj.KA=this.obj.onmousemove;this.obj.onmousemove=this.Oy;this.UJ=true}}else{if(this.UJ){this.aL.onclick=this.aL.age;this.obj.onclick=this.obj.age;this.obj.onmousemove=this.obj.KA;this.UJ=false}}};D.prototype.Rz=function(e,c){if(c)that=this;else that=this.grid;if((that.Fr)&&(that.Fr!=c)){for(var i=0;i<that.Fr.childNodes.length;i++)that.Fr.childNodes[i].className=that.Fr.childNodes[i].className.replace(that.Lk,"");that.Fr=null}};D.prototype.xb=function(e){var c=this.grid.cd(e?e.target:event.srcElement,'TD');if(c){this.grid.Rz(0,c);c=c.parentNode;for(var i=0;i<c.childNodes.length;i++)c.childNodes[i].className+=" "+this.grid.Lk;this.grid.Fr=c};this.Io(e)};D.prototype.Oy=function(e){if(!this.grid.editor){var c=this.grid.cd(e?e.target:event.srcElement,'TD');if(c.parentNode.idd)this.grid.bL(c,true,0)};this.KA(e)};D.prototype.od=function(mode,count,EP){count=count||10;EP=EP||250;if(K(mode)){this.Hv=count;this.Kb=EP}else this.Hv=0};function ED(obj,name,P,jF,tree,FC,i,n){obj.Bf=window.setTimeout(function(){var res=obj[name](P,jF,tree,FC,i);if(obj.abK)obj.setSizes();if(res!= -1)obj.cG("onXLE",[obj,obj.P.length])},n);return this};D.prototype.fA=function(){if(this.zY)this.zY=window.clearTimeout(this.zY);var a;this.bA=this.bA.fA();for(var i=0;i<this.P.length;i++)if(this.P[i])this.P[i].grid=null;for(i in this.bj)if(this.bj[i])this.bj[i]=null;this.P=new cD();this.bj=new Array();this.aL.innerHTML="";this.aL.onclick=function(){};this.aL.onmousedown=function(){};this.aL.onbeforeactivate=function(){};this.aL.onbeforedeactivate=function(){};this.aL.onbeforedeactivate=function(){};this.aL.onselectstart=function(){};this.aL.grid=null;for(a in this){if((this[a])&&(this[a].yO))this[a].yO=null;this[a]=null};if(this==globalActiveDHTMLGridObject)globalActiveDHTMLGridObject=null;return null};D.prototype.xu=function(){var z=new Array();if(this.ij){z[0]=this.ij.A;z[1]=(this.gB.src.indexOf("sort_desc.gif")!= -1)?"des":"asc"};return z};D.prototype.enableAutoHeight=function(mode,maxHeight,Ql){this.abK=K(mode);this.aea=K(Ql);this.FF=maxHeight||null;if(maxHeight=="auto"){this.FF=null;this.aic=true;this.tZ()}};D.prototype.enableAutoHeigth=D.prototype.enableAutoHeight;D.prototype.xC=function(mode){this.agg=K(mode);this.P.gl=function(arj){var size=this.length-1;for(var i=0;i<this.length-1;i++){for(var j=0;j<size;j++)if(arj(this[j],this[j+1])>0){var AT=this[j];this[j]=this[j+1];this[j+1]=AT};size--}}};D.prototype.vV=function(mode){this.Zl= !K(mode)};D.prototype.enableContextMenu=function(menu){this.Gs=menu};D.prototype.EG=function(aQ){this.attachEvent("onBeforeContextMenu",aQ)};D.prototype.OV=function(aQ){this.attachEvent("onRightClick",aQ)};D.prototype.Tk=function(width){this.Zz=parseInt(width)};D.prototype.aja=function(list){this.FB=list.split(",");for(var i=0;i<this.FB.length;i++)this.FB[i]=K(this.FB[i])};D.prototype.aik=function(list){this.qZ=list.split(",");for(var i=0;i<this.qZ.length;i++)this.qZ[i]=K(this.qZ[i])};D.prototype.mE=function(width,ind){if(arguments.length==2){if(!this.vy)this.vy=new Array();this.vy[ind]=width}else this.vy=width.split(",")};D.prototype.ajY=function(mode){this.ajm=K(mode)};D.prototype.ty=function(cq,mode){var z=this.dz(cq);if(z){z.FG=K(mode);if((this.cell)&&(this.cell.parentNode.idd==cq))this.bB()}};D.prototype.Vf=function(row){var text=new Array();for(var ii=0;ii<row.childNodes.length;ii++){var a=this.cells3(row,ii);if(a.cell.Lq)text[ii]=a.cell.AB;else text[ii]=a.getValue()};return text};D.prototype.AK=function(mask){this.RY=mask};D.prototype.kr=function(mask,vF,p_sep,d_sep){var yJ=mask.replace(/[^0\,\.]*/g,"");var yb=yJ.indexOf(".");if(yb> -1)yb=yJ.length-yb-1;var Jd=yJ.indexOf(",");if(Jd> -1)Jd=yJ.length-yb-2-Jd;p_sep=p_sep||".";d_sep=d_sep||",";var apG=mask.split(yJ)[0];var Om=mask.split(yJ)[1];this.Ct[vF]=[yb,Jd,apG,Om,p_sep,d_sep]};D.prototype.Sl=function(data,ind){var a=this.Ct[ind];if(!a)return data;var ndata=parseFloat(data.toString().replace(/[^0-9]*/g,""));if(data.toString().substr(0,1)=="-")ndata=ndata* -1;if(a[0]>0)ndata=ndata/Math.pow(10,a[0]);return ndata};D.prototype.PH=function(data,ind){var a=this.Ct[ind];if(!a)return data;var c=(parseFloat(data)<0?"-":"")+a[2];data=Math.abs(Math.round(parseFloat(data)*Math.pow(10,a[0]>0?a[0]:0))).toString();data=(data.length<a[0]?Math.pow(10,a[0]+1-data.length).toString().substr(1,a[0]+1)+data.toString():data).split("").reverse();data[a[0]]=(data[a[0]]||"0")+a[4];if(a[1]>0)for(var j=(a[0]>0?0:1)+a[0]+a[1];j<data.length;j+=a[1])data[j]+=a[5];return c+data.reverse().join("")+a[3]};D.prototype.DV=function(arr){for(var i=0;i<arr.length;i++){var CF=new Array();for(var j=0;j<arr[i].childNodes.length;j++)if(arr[i].childNodes[j].nodeType==1)CF[CF.length]=arr[i].childNodes[j].firstChild.data;this[arr[i].getAttribute("command")].apply(this,CF)}};D.prototype.Ov=function(ai){var Cv=this.bA.et("//rows/head",ai);if(Cv.length){var mb=this.bA.et("//rows/head/column",Cv[0]);var sp=this.bA.et("//rows/head/settings",Cv[0]);var SJ="setInitWidths";var split=false;if(sp[0]){for(var s=0;s<sp[0].childNodes.length;s++)switch(sp[0].childNodes[s].tagName){case "colwidth":if(sp[0].childNodes[s].firstChild&&sp[0].childNodes[s].firstChild.data=="%")SJ="eR";break;case "splitat":split=(sp[0].childNodes[s].firstChild?sp[0].childNodes[s].firstChild.data:false);break}};this.DV(this.bA.et("//rows/head/beforeInit/call",Cv[0]));if(mb.length>0){var VY="";var VR="";var c_list="";var Wn="";var Wf="";var VP="";var WM="";var UA=[];for(var i=0;i<mb.length;i++){VY+=mb[i].getAttribute("width")+this.gX;VR+=mb[i].getAttribute("type")+this.gX;c_list+=(mb[i].getAttribute("align")||"left")+this.gX;Wn+=mb[i].getAttribute("sort")+this.gX;Wf+=(mb[i].getAttribute("color")!=null?mb[i].getAttribute("color"):"")+this.gX;VP+=(mb[i].firstChild?mb[i].firstChild.data:"").replace(/^\s*((.|\n)*.+)\s*$/gi,"$1")+this.gX;UA[i]=mb[i].getAttribute("format");WM+=mb[i].getAttribute("id")+this.gX};this.setHeader(VP.substr(0,VP.length-1));this[SJ](VY.substr(0,VY.length-1));this.bw(c_list.substr(0,c_list.length-1));this.be(VR.substr(0,VR.length-1));this.bm(Wn.substr(0,Wn.length-1));this.bz(Wf.substr(0,Wf.length-1));this.wL(WM.substr(0,WM.length-1));for(var i=0;i<mb.length;i++){if((this.cO[i].indexOf('co')==0)||(this.cO[i]=="clist")){var hJ=this.bA.et("./option",mb[i]);if(hJ.length){var aao=new Array();if(this.cO[i]=="clist"){for(var j=0;j<hJ.length;j++)aao[aao.length]=hJ[j].firstChild?hJ[j].firstChild.data:"";this.AO(i,aao)}else{var combo=this.cf(i);for(var j=0;j<hJ.length;j++)combo.eT(hJ[j].getAttribute("value"),hJ[j].firstChild?hJ[j].firstChild.data:"")}}}else if(UA[i])if((this.cO[i]=="calendar")||(this.fldSort[i]=="date"))this.AK(UA[i],i);else this.kr(UA[i],i)};this.init();if((split)&&(this.tT))this.tT(split)};this.DV(this.bA.et("//rows/head/afterInit/call",Cv[0]))};var Kh=this.bA.et("//rows/userdata",ai);if(Kh.length>0){if(!this.da["gridglobaluserdata"])this.da["gridglobaluserdata"]=new qB();for(var j=0;j<Kh.length;j++){this.da["gridglobaluserdata"].eT(Kh[j].getAttribute("name"),Kh[j].firstChild?Kh[j].firstChild.data:"")}}};D.prototype.On=function(xml,jF){this.aaj=true;var qc=null;var GG=null;if(!xml)try{var ai=eval(this.aL.id+"Q").XMLDocument}catch(er){var ai=this.loadXML(this.tR)}else{if(typeof(xml)=="object"){var ai=xml}else{if(xml.indexOf(".")!= -1){if(this.tR=="")this.tR=xml;var ai=this.loadXML(xml);return}else var ai=(bf?eval(xml).XMLDocument:document.getElementById(xml))}};var ar=new Array();var ask=new Array();var Lx=this.bA.et("//rows",ai);if(Lx[0]&&Lx[0].getAttribute("total_count"))this.limit=Lx[0].getAttribute("total_count");this.Ov(ai);var tree=this.cO.bP("tree");var P=this.bA.et("//rows/row",ai);if(P.length==0){this.kD=true;var top=this.bA.et("//rows",ai);if(!top)return;var qc=(top[0].getAttribute("parent")||0);if((tree!= -1)&&(this.bj[qc])){var arS=this.bj[qc].childNodes[tree]}}else{qc=(P[0].parentNode.getAttribute("parent")||null);GG=this.dz(qc);if(GG)GG.TP=false;else qc=null;jF=this.di(qc)+1};if(tree== -1)tree=this.cO.bP("3d");if(this.aq(P,jF,tree,qc)== -1)return(this.abK?this.setSizes():"");if(GG)this.expandKids(GG);if(tree!= -1){var amf=this.bA.et("//row[@open]",ai);for(var i=0;i<amf.length;i++)this.hx(amf[i].getAttribute("id"))};this.setSizes();if(cU){this.obj.style.border=1;this.obj.style.border=0};this.rf=false;this.cG("onXLE",[this,P.length,qc,ai])};D.prototype.jQ=function(r,xml){var Am=xml.getAttribute("id");var ada=xml.getAttribute("style");var Pk=this.bA.et("./userdata",xml);if(Pk.length>0){if(!this.da[Am])this.da[Am]=new qB();for(var j=0;j<Pk.length;j++){this.da[Am].eT(Pk[j].getAttribute("name"),Pk[j].firstChild?Pk[j].firstChild.data:"")}};var wl=xml.getAttribute("class");if(wl)r.className+=(r.Vn=" "+wl);var wl=xml.getAttribute("bgColor");if(wl)for(var i=0;i<r.childNodes.length;i++)r.childNodes[i].bgColor=wl;if(xml.getAttribute("locked")){r.FG=true};if(xml.getAttribute("selected")==true){this.dX(Am,this.gN,false,xml.getAttribute("call")==true)};if(ada)this.jb(Am,ada);this.cG("onRowCreated",[r.idd,r,xml])};D.prototype.jc=function(r,xml,tree,FC){var pg=this.bA.et("./cell",xml);var Ha=new Array(0);for(var j=0;j<pg.length;j++){var tU=pg[j];var aoT=tU.getAttribute("type");if(tU.getAttribute("xmlcontent"))tU=pg[j];else if(tU.firstChild)tU=tU.firstChild.data;else tU="";if(j!=tree)Ha[Ha.length]=tU;else Ha[Ha.length]=[FC,tU,((xml.getAttribute("xmlkids")||r.Q)?"1":"0"),(pg[j].getAttribute("image")||"leaf.gif")];if(aoT)r.childNodes[j].zk=aoT};if(this.QS)Ha=this.Xb(Ha);for(var j=0;j<pg.length;j++){var wl=pg[j].getAttribute("class");if(wl)r.childNodes[j].className+=" "+wl;wl=pg[j].getAttribute("style");if(wl)r.childNodes[j].style.cssText+=";"+wl;wl=pg[j].getAttribute("title");if(wl)r.childNodes[j].title=wl};this.VQ(r,Ha);if(this.CP){r.bq=new Array();var kO=0;var l=this.obj.rows[0].childNodes.length;for(var j=0;j<l;j++){r.bq[j]=j-kO;if(!pg[j])continue;var col=pg[j].getAttribute("colspan");if(col){r.childNodes[j-kO].colSpan=col;for(var z=1;z<col;z++){r.removeChild(r.childNodes[j-kO+1]);r.bq[j+z]=j-kO};kO+=(col-1);j+=(col-1)}};if(!kO)r.bq=null};if((r.parentNode)&&(r.parentNode.tagName))this.jQ(r,xml);return r};D.prototype.aq=function(P,jF,tree,FC,i){i=i||0;var apV=i+this.Hv*1;var r=null;var Cd;for(var i;i<P.length;i++){if(this.Hv&&i==apV){new ED(this,"aq",P,jF,tree,FC,i,this.Kb);return-1};if((FC)||(i<this.cu||this.cu==0)){this.vS=true;var Am=(P[i].getAttribute("id")||(this.P.length+2));r=this.uO(Am);if(tree!= -1){Cd=this.bA.et("./row",P[i]);if((Cd.length!=0)&&(this.mI))r.Q=Cd};r=this.jc(r,P[i],tree,FC);if(jF){r=this._insertRowAt(r,jF);jF++}else{r=this._insertRowAt(r)};this.jQ(r,P[i]);this.vS=false}else{var Bj=this.aD[0].length;this.aD[1][Bj]=P[i];this.aD[0][Bj]=P[i].getAttribute("id");if(!this.aD[0][Bj]){this.aD[0][Bj]=this.P.length+2+Bj;P[i].setAttribute("id",this.aD[0][Bj])}};if((tree!= -1)&&(Cd.length!=0)&&(!this.mI))jF=this.aq(Cd,jF,tree,Am)};if(this.ip&&this.aD[0].length>0){this.ee(this.ew)};if((r)&&(this.lE))for(var i=0;i<this.hdr.rows[0].cells.length;i++)this.lE(r.childNodes[i]);return jF};D.prototype.aiZ=function(mf){var d=new Array();mygrid.fm(function(id){if(this.cells(id,mf).getValue()!=0)d.push(id)});return d.join(",")};D.prototype.Xj=function(e){var c=this.grid.cd(e?e.target:event.srcElement,'TD');if((this.grid.editor)&&(this.grid.editor.cell==c))return true;var r=c.parentNode;if(!r.idd)return;var el=(e?e.target:event.srcElement);if(r.idd==window.unknown)return true;if(!this.grid.cG("onMouseOver",[r.idd,c.A]))return true;if((this.grid.FB)&&(!this.grid.FB[c.A])){if(el.title)el.title='';return true};var acT=this.grid.cells(r.idd,c.A);if(el.ahi)acT.cell.title="";if(!acT.cell.title)el.ahi=true;if(acT)el.title=acT.cell.title||(acT.Hw?acT.Hw():(acT.getValue()||"").toString().replace(/<[^>]*>/gi,""));return true};D.prototype.UH=function(size){if(ca)this.Wr=parseInt(size)};D.prototype.aau=function(separator){var ar=new Array(0);var z=this.iD();for(i=0;i<z;i++)if((this.P[i])&&(!this.P[i].kp)&&(!this.P[i].kl))ar[ar.length]=this.P[i].idd;else if(this.aD[1][i])ar[ar.length]=this.aD[0][i];return ar.join(separator||",")};D.prototype.Iy=function(){return this.aau()};D.prototype.deleteRow=function(bO,node){if(!node)node=this.dz(bO);if(!node)return;this.bB();if(this.cG("onBeforeRowDeleted",[bO])==false)return false;if(this.cO.bP("tree")!= -1)this.yE(node);else{if(node.parentNode)node.parentNode.removeChild(node);var ind=this.P.bP(node);if(ind!= -1)this.P.hd(ind);else{ind=this.aD[0].bP(bO);if(ind>=0){this.aD[0].hd(ind);this.aD[1].hd(ind)}};this.bj[bO]=null};for(var i=0;i<this.bY.length;i++)if(this.bY[i].idd==bO)this.bY.hd(i);if(this.ip){this.ee()};this.setSizes();this.cG("onGridReconstructed",[]);if(this.ic)this.kh();return true};D.prototype.Oq=function(bO,mf,colspan){if(!this.CP)return;var r=this.dz(bO);if((r.bq)&&(r.childNodes[r.bq[mf]])){var j=r.bq[mf];var n=r.childNodes[j];var m=n.colSpan;n.colSpan=1;if((m)&&(m!=1))for(var i=1;i<m;i++){var c=document.createElement("TD");if(n.nextSibling)r.insertBefore(c,n.nextSibling);else r.appendChild(c);r.bq[mf+i]=j+i;c.A=mf+i;c.align=this.dV[i];c.style.verticalAlign=this.fb[i];n=c;this.cells3(r,j+i).setValue("")};for(var z=mf*1+1*m;z<r.bq.length;z++){r.bq[z]+=(m-1)*1}};if((colspan)&&(colspan>1)){if(r.bq)var j=r.bq[mf];else{var j=mf;r.bq=new Array();for(var z=0;z<r.childNodes.length;z++)r.bq[z]=z};r.childNodes[j].colSpan=colspan;for(var z=1;z<colspan;z++){r.bq[r.childNodes[j+1].A]=j;r.removeChild(r.childNodes[j+1])};var asl=r.childNodes[r.bq[mf]].A;for(var z=asl*1+1*colspan;z<r.bq.length;z++)r.bq[z]-=(colspan-1)}};D.prototype.vq=function(mode){this.ir=K(mode);this.bA.hN=this.ir};D.prototype.jJ=D.prototype.vq;D.prototype.HG=function(mode){this.anu=K(mode)};D.prototype.LI=function(e){var that=this.grid;var el=that.cd(bf?event.srcElement:e.target,"TD");if(!that.anu)return false;that.nT(el.hp)};D.prototype.nT=function(vF){this.Hc=true;var m=0;this.si(vF,20);for(var j=1;j<this.hdr.rows.length;j++){var a=this.hdr.rows[j];a=a.childNodes[(a.bq)?a.bq[vF]:vF];if((a)&&((!a.colSpan)||(a.colSpan<2))){if((a.childNodes[0])&&(a.childNodes[0].className=="hdrcell"))a=a.childNodes[0];m=Math.max(m,((ca||cU)?(a.textContent.length*7):a.scrollWidth))}};var l=this.obj.ns();for(var i=0;i<l;i++){var z=this.obj.wn(i);if(z.bq&&z.bq[vF]!=vF)continue;if(ca||cU)z=z.childNodes[vF].textContent.length*7;else z=z.childNodes[vF].scrollWidth;if(z>m)m=z};m+=20;this.si(vF,m);this.Hc=false;this.setSizes()};D.prototype.gz=function(index,hdr){hdr=hdr||this.hdr;var row=hdr.rows[index+1];if(row)row.parentNode.removeChild(row);this.setSizes()};D.prototype.iS=function(index){this.gz(index,this.ftr)};D.prototype.attachHeader=function(gT,style,wT){if(typeof(gT)=="string")gT=this.ZK(gT);if(typeof(style)=="string")style=style.split(this.gX);wT=wT||"_aHead";if(this.hdr.rows.length){if(gT)this.Yw([gT,style],this[(wT=="_aHead")?"hdr":"ftr"]);else if(this[wT])for(var i=0;i<this[wT].length;i++)this.attachHeader.apply(this,this[wT][i])}else{if(!this[wT])this[wT]=new Array();this[wT][this[wT].length]=[gT,style,wT]}};D.prototype.Yw=function(data,parent){if(!parent){this.aL.style.position="relative";var z=document.createElement("DIV");z.className="c_ftr".substr(2);this.aL.appendChild(z);var t=document.createElement("TABLE");t.cellPadding=t.cellSpacing=0;if(!bf){t.width="100%";t.style.paddingRight="20px"};t.style.tableLayout="fixed";z.appendChild(t);t.appendChild(document.createElement("TBODY"));this.ftr=parent=t;var hdrRow=t.insertRow(0);var arR=((this.ep.length<=1)?data[0].length:this.ep.length);for(var i=0;i<arR;i++){hdrRow.appendChild(document.createElement("TH"));hdrRow.childNodes[i].A=i};if(bf)hdrRow.style.position="absolute";else hdrRow.style.height='auto'};var apc=data[1];var z=document.createElement("TR");parent.rows[0].parentNode.appendChild(z);for(var i=0;i<data[0].length;i++){if(data[0][i]=="#cspan"){var pz=z.cells[z.cells.length-1];pz.colSpan=(pz.colSpan||1)+1;continue};if((data[0][i]=="#rspan")&&(parent.rows.length>1)){var als=parent.rows.length-2;var found=false;var pz=null;while(!found){var pz=parent.rows[als];for(var j=0;j<pz.cells.length;j++)if(pz.cells[j].A==i){found=j+1;break};als--};pz=pz.cells[found-1];pz.rowSpan=(pz.rowSpan||1)+1;continue};var w=document.createElement("TD");w.A=w.hp=i;if(this.qW)w.innerHTML="<div class='hdrcell'>"+data[0][i]+"</div>";else w.innerHTML=data[0][i];if((data[0][i]||"").indexOf("#")!= -1){var t=data[0][i].match(/(^|{)#([^}]+)(}|$)/);if(t){var tn="_in_header_"+t[2];if(this[tn])this[tn]((this.qW?w.firstChild:w),i,data[0][i].split(t[0]))}};if(apc)w.style.cssText=apc[i];z.appendChild(w)};var self=parent;if(cn){if(parent.Ze)window.clearTimeout(parent.Ze);parent.Ze=window.setTimeout(function(){parent.rows[1].style.display='none';window.setTimeout(function(){parent.rows[1].style.display=''},1)},500)}};D.prototype.attachFooter=function(gT,style){this.attachHeader(gT,style,"_aFoot")};D.prototype.Me=function(cq,cellIndex,type){this.tW(this.bj[cq],cellIndex,type)};D.prototype.tW=function(r,ind,type){type=type||this.cO[ind];var z=this.cells3(r,ind);var v=z.getValue();z.cell.zk=type;var z=this.cells3(r,ind);z.setValue(v)};D.prototype.CX=function(cq,type){var z=this.bj[cq];for(var i=0;i<z.childNodes.length;i++)this.tW(z,i,type)};D.prototype.IP=function(colIndex,type){for(var i=0;i<this.P.length;i++)this.tW(this.P[i],colIndex,type)};D.prototype.OD=function(value,MT,GX){var res=new Array();value=value.toString().toLowerCase();if(!this.P.length)return res;for(var i=(MT||0);i<this.cO.length;i++){var z=this.cells4(this.P[0].childNodes[i]);for(var j=0;j<this.P.length;j++){z.cell=this.P[j].childNodes[i];var ap=z.getValue();if((ap||"").toString().toLowerCase().indexOf(value)!= -1)res[res.length]=[j,i];if(GX&&this.P.length==j+1)this.pI()};if(typeof(MT)!="undefined")return res};return res};D.prototype.Ag=function(){this.xw="";this.attachEvent=function(eN,hk,qr){qr=qr||this;eN='ev_'+eN;if((!this[eN])||(!this[eN].oe)){var z=new this.sI(qr);z.oe(this[eN]);this[eN]=z};return(eN+':'+this[eN].oe(hk))};this.cG=function(name,afo){if(this["ev_"+name])return this["ev_"+name].apply(this,afo);return true};this.mR=function(name){if(this["ev_"+name])return true;return false};this.sI=function(obj){var gu=new Array();var yO=obj;var uz=function(hk,rpc){hk=hk.split(":");var BR="";var aaL="";var target=hk[1];if(hk[1]=="rpc"){BR='<?xml version="1.0"?><methodCall><methodName>'+hk[2]+'</methodName><params>';aaL="</params></methodCall>";target=rpc};var z=function(){};return z};var z=function(){if(gu)var res=true;for(var i=0;i<gu.length;i++){if(gu[i]!=null){var zr=gu[i].apply(yO,arguments);res=res&&zr}};return res};z.oe=function(ev){if(typeof(ev)!="function")if(ev&&ev.indexOf&&ev.indexOf("server:")==0)ev=new uz(ev,yO.Ta);else ev=eval(ev);if(ev)return gu.push(ev)-1;return false};z.uI=function(id){gu[id]=null};return z};this.detachEvent=function(id){if(id!=false){var list=id.split(':');this[list[0]].uI(list[1])}}};D.prototype.fm=function(Fi){for(a in this.bj)if(this.bj[a]&&this.bj[a].tagName)Fi.apply(this,[this.bj[a].idd])};D.prototype.amz=function(cq,Fi){var z=this.bj[cq];if(!z)return;for(var i=0;i<this.gA;i++)Fi(this.cells3(z,i))};D.prototype.ahQ=function(mode,ady,acx){this.Gd=[K(mode),(ady||99999),(acx||0)]};D.prototype.jn=function(){var z=this.iD()+1;while(this.bj[z])z++;return z};D.prototype.OL=function(aQ){this.attachEvent("onKeyPress",aQ)};D.prototype.TJ=function(url,ack,aar,bo){if(typeof ack=="undefined")ack=true;this.va=[true,ack,aar];if(bo)this.bA.bs=bo;this.cG("onXLS",[this]);this.bA.loadXML(url)};D.prototype.Uq=D.prototype.TJ;D.prototype.OR=function(xml){if(window.eXcell_tree){eXcell_tree.prototype.Tw=eXcell_tree.prototype.setValue;eXcell_tree.prototype.setValue=function(content){if(this.grid.dP.get[this.cell.parentNode.idd]){this.setLabel(content[1]);if(content[3])this.hW(content[3])}else this.Tw(content)}};var tree=this.cO.bP("tree");var qc=xml.et("//rows")[0].getAttribute("parent")||0;var del={};if(this.va[2]){this.fm(function(id){del[id]=true})};var rows=xml.et("//row");for(var i=0;i<rows.length;i++){var row=rows[i];var id=row.getAttribute("id");del[id]=false;if(this.ic||this.aD[0].length){if(this.bj[id])this.jc(this.bj[id],row,-1);else{var z=this.aD[0].bP(id);if(z!= -1)this.aD[1][z]=row}}else if(this.bj[id])this.jc(this.bj[id],row,tree,qc);else{var r=this.uO(id);r=this.jc(r,row,tree,qc);if(tree!= -1&&this.dP.get[qc].state=="minus")r=this._insertRowAt(r,this.di(qc)+this.jS(qc,0));else r=this._insertRowAt(r);this.jQ(r,row)}};if(this.va[2])for(id in del){if(del[id]&&this.bj[id])this.deleteRow(id)};if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.Tw;this.cG("onXLE",[this,rows.length])};D.prototype.iq=function(id,ind){var cell=this.cells(id,ind).cell;if(!cell.wR)cell.wR=new lU();return cell.wR};D.prototype.aaK=function(order){var t=order.split(this.gX);this.Wq=[];for(var i=0;i<this.gA;i++)t[i]={c:parseInt(t[i]),ind:i};t.sort(function(a,b){return(a.c>b.c?1: -1)});for(var i=0;i<this.gA;i++)if(!t[i+1]||(typeof t[i].c=="undefined"))this.Wq[t[i].ind]=(t[0].ind+1)* -1;else this.Wq[t[i].ind]=t[i+1].ind};D.prototype.i18n={loading:"Loading"};D.prototype.zf={k13_1_0:function(){var uH=this.P.bP(this.row);this.eQ(this.P[uH+1],this.cell.A,true)},k13_0_1:function(){var uH=this.P.bP(this.row);this.eQ(this.P[uH-1],this.cell.A,true)},k13_0_0:function(){this.bB();this.cG("onEnter",[(this.row?this.row.idd:null),(this.cell?this.cell.A:null)])},k9_0_0:function(){this.bB();var z=this.Kn(null,1);if(z){this.eQ(z.parentNode,z.A,(this.row!=z.parentNode),false,true);this.QX=true}},k9_0_1:function(){this.bB();var z=this.Kn(null,-1);if(z){this.eQ(z.parentNode,z.A,(this.row!=z.parentNode),false,true);this.QX=true}},k113_0_0:function(){if(this.UB)this.gh()},k32_0_0:function(){var c=this.cells4(this.cell);if(!c.changeState||(c.changeState()===false))return false},k27_0_0:function(){this.bB(true)},k33_0_0:function(){if(this.ip)this.ee(this.ew-1);else this.PP(-1)},k34_0_0:function(){if(this.ip)this.ee(this.ew+1);else this.PP(1)},k37_0_0:function(){if(!this.editor&&this.gY())this.collapseKids(this.row);else return false},k39_0_0:function(){if(!this.editor&&this.gY())this.expandKids(this.row);else return false},k40_0_0:function(){if(this.editor&&this.editor.combo)this.editor.Ka();else{var uH=this.P.bP(this.row)+1;if(uH!=this.P.length&&uH!=this.obj.rows.length-1){var NH=this.CE(uH-1,1);if(NH.kp||NH.kl)return false;this.eQ(NH,this.cell.A,true)}else{this.zf.k34_0_0.apply(this,[]);if(this.ip&&this.P[(this.ew-1)*this.cu])this.eQ((this.ew-1)*this.cu,0,true)}}},k38_0_0:function(){if(this.editor&&this.editor.combo)this.editor.Kc();else{var uH=this.P.bP(this.row)+1;if(uH!= -1&&(!this.ip||(this.ew-1)*this.cu+1<uH)){var NH=this.CE(uH-1,-1);if(!NH||NH.kp||NH.kl)return false;this.eQ(NH,this.cell.A,true)}else{this.zf.k33_0_0.apply(this,[]);if(this.ip&&this.P[this.ew*this.cu-1])this.eQ(this.ew*this.cu-1,0,true)}}}};