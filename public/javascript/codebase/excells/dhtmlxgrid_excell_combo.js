function eXcell_combo(cell){try{this.cell=cell;this.grid=this.cell.parentNode.grid}catch(er){};this.edit=function(){ap=this.getValue();if(ap=="&nbsp;")ap="";this.cell.innerHTML="";if(typeof window.fe=="undefined")fe="../../../dhtmlxCombo/codebase/imgs/";this.obj=new bd(this.cell,"combo",this.cell.offsetWidth-2);this.obj.fR.className+=" fake_editable";grid=this.grid;this.obj.fR.onselectstart=function(){event.cancelBubble=true;return true};this.obj.fR.onkeydown=function(ev){ev=ev||window.event;if(ev.keyCode!=9)ev.cancelBubble=true;if(ev.keyCode==13)grid.bB()};this.obj.fR.style.border="0px";this.obj.fR.style.height="18px";this.obj.BJ();if((this.cell._filter==true)&&(this.cell.lo==false))this.obj.fF(true);if((this.cell.kH==false)&&(this.cell._filter==false)&&(this.cell.lo==false)){this.obj.fK.readOnly=true;this.obj.fR.onkeyup=function(ev){ev=ev||window.event;if(ev.keyCode!=9)ev.cancelBubble=true;this.jd= -1;if(ev.keyCode>=65&&ev.keyCode<=90){for(var i=0;i<(this.combo.du.length<70)?this.combo.du.length:70;i++){var text=this.combo.du[i].text;if(text.toUpperCase().indexOf(String.fromCharCode(ev.keyCode))==0){this.jd=i;break}};ev.cancelBubble=true};if(this.jd!= -1)this.combo.oa(this.jd)}};if(this.cell.JG==false){this.options=[];this.options=this.kv();for(var i=0;i<this.options.length;i++){if(this.options[i].tagName=="option"){this.obj.jW(i,this.options[i].firstChild.data)}};if((this.obj.MV(ap))&&(this.cell._filter==false))this.obj.oa(this.obj.gg(this.obj.MV(ap).value));else this.obj.nQ(ap)}else if(this.cell.JG){if(this.cell.lo==false){this.obj.loadXML(this.cell.JG,function(){if((ap||"").toString().PA()=="")value="";else value=ap;if(this.cT.MV(value))this.cT.oa(this.cT.gg(this.cT.MV(value).value));else this.cT.nQ(value)})}else{this.obj.fF(true,this.cell.JG,this.cell.lK,this.cell.yG);this.obj.Um(ap);this.cell.onkeypress=function(e){(e||event).cancelBubble=true;return true}}}};this.ma=function(ap,obj){obj.oa(obj.gg(obj.MV(ap).value))};this.getValue=function(ap){return this.cell.innerHTML.toString()};this.setValue=function(ap){for(var i=0;i<this.cell.parentNode.childNodes.length;i++){this.cell.parentNode.childNodes[i].tabIndex=0};if(typeof(ap)!="object"){this.J=[];this.cell.JG=false;this.cell._filter=false;this.cell.lK=false;this.cell.lo=false;this.cell.yG=false;this.cell.kH=true;this.J=this.kv();for(var i=0;i<this.J.length;i++){switch(this.J[i].tagName){case "option":value=this.J[i].getAttribute("value");if(value==ap)ap=this.J[i].firstChild.data;break;case "editable":if(K(this.J[i].firstChild.data)==false){this.cell.kH=false}else this.cell.kH=true;break;case "source":this.cell.JG=this.J[i].firstChild.data;this.oI=new ag(function(a,b,c,d,oI){this.cells=oI.et("//option");for(var i=0;i<this.cells.length;i++){value=this.cells[i].getAttribute("value");if(value==ap){ap=this.cells[i].firstChild.data;this.cell.innerHTML=ap}}});this.oI.cell=this.cell;this.oI.loadXML(this.cell.JG);break;case "filter":if(K(this.J[i].firstChild.data))this.cell._filter=true;break;case "auto":if(K(this.J[i].firstChild.data))this.cell.lo=true;break;case "anI":if(K(this.J[i].firstChild.data))this.cell.lK=true;break;case "sub":if(K(this.J[i].firstChild.data))this.cell.yG=true;break}}};if((ap||"").toString().PA()=="")ap=null;if(ap!==null)this.dq(ap);else this.dq("&nbsp;",ap);this.dq(ap)};this.ng=function(src,ap){};this.kv=function(){HP=this.grid.bA.et("//column");hJ=HP[this.cell.A].childNodes;return hJ};this.detach=function(){if(!this.obj.nK()||this.obj.nK().toString().PA()==""){this.dq("&nbsp;")}else this.dq(this.obj.nK(),this.obj.FV());this.cell.OT=this.obj.FV();this.obj.pl();this.ap=ap;return ap!=this.getValue()}};eXcell_combo.prototype=new gD;