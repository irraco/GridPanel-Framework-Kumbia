function eXcell_clist(cell){try{this.cell=cell;this.grid=this.cell.parentNode.grid}catch(er){};this.edit=function(){this.ap=this.getValue();var a=(this.cell.wR||this.grid.clists[this.cell.A]);if(!a)return;this.obj=document.createElement("DIV");var b=this.ap.split(",");var text="";for(var i=0;i<a.length;i++){var fl=false;for(var j=0;j<b.length;j++)if(a[i]==b[j])fl=true;if(fl)text+="<div><input type='checkbox' checked='true' /><label>"+a[i]+"</label></div>";else text+="<div><input type='checkbox' id='ch_lst_"+i+"'/><label>"+a[i]+"</label></div>"};text+="<div><input type='button' value='Apply' style='width:100px;font-size:8pt;' onclick='this.parentNode.parentNode.editor.grid.editStop();'/></div>";this.obj.editor=this;this.obj.innerHTML=text;document.body.appendChild(this.obj);this.obj.style.position="absolute";this.obj.className="dhx_clist";this.obj.onclick=function(e){(e||event).cancelBubble=true;return true};this.obj.style.zIndex=19;var kw=this.grid.fI(this.cell);this.obj.style.left=kw[0]+"px";this.obj.style.top=kw[1]+this.cell.offsetHeight+"px";this.obj.getValue=function(){var text="";for(var i=0;i<this.childNodes.length-1;i++)if(this.childNodes[i].childNodes[0].checked){if(text)text+=",";text+=this.childNodes[i].childNodes[1].innerHTML};return text}};this.getValue=function(){if(this.cell.mG)return "";return this.cell.innerHTML.toString().PA()};this.detach=function(ap){if(this.obj){this.setValue(this.obj.getValue());this.obj.editor=null;this.obj.parentNode.removeChild(this.obj);this.obj=null};return this.ap!=this.getValue()}};eXcell_clist.prototype=new gD;eXcell_clist.prototype.setValue=function(ap){if(typeof(ap)=="object"){var hJ=this.grid.bA.et("./option",ap);if(hJ.length)this.cell.wR=[];for(var j=0;j<hJ.length;j++)this.cell.wR.push(hJ[j].firstChild?hJ[j].firstChild.data:"");ap=ap.firstChild.data};if(ap===""){this.setCTxtValue(" ",ap);this.cell.mG=true}else{this.dq(ap);this.cell.mG=false}};D.prototype.AO=function(col,list){if(!this.clists)this.clists=new Array();if(typeof(list)!="object")list=list.split(",");this.clists[col]=list};