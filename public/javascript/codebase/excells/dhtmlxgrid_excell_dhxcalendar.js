function eXcell_dhxCalendar(cell){if(cell){this.cell=cell;this.grid=this.cell.parentNode.grid;if(!this.grid.Pw){var z=document.createElement("DIV");document.body.insertBefore(z,document.body.firstChild);this.grid.Pw=new dhtmlxCalendarObject(z,false,{Uw:true});this.grid.Pw.Re('en-us');this.grid.Pw.Vs(1900,2100);this.grid.Pw.zv();this.grid.Pw.hide();this.grid.Pw.setSkin("yahoolike");this.grid.cG("onDhxCalendarCreated",[this.grid.Pw]);var sgrid=this.grid;this.grid.Pw.bl(function(){this.QD=true;window.setTimeout(function(){sgrid.bB()},1);return true});var and=function(e){(e||event).cancelBubble=true};dE(this.grid.Pw.entObj,"click",and)}}};eXcell_dhxCalendar.prototype=new gD;eXcell_dhxCalendar.prototype.edit=function(){var kw=this.grid.fI(this.cell);this.grid.Pw.Yy(kw[1],kw[0]);this.grid.Pw.QD=false;this.grid.Pw.show();this.cell.apM=true;this.ap=this.cell.ap;this.AB=this.cell.innerHTML;this.grid.Pw.setDate(this.ap||(new Date()));this.grid.Pw.zv()};eXcell_dhxCalendar.prototype.getDate=function(){if(this.cell.ap)return this.cell.ap;return null};eXcell_dhxCalendar.prototype.getValue=function(){return this.cell.innerHTML.toString().PA()};eXcell_dhxCalendar.prototype.detach=function(){if(!this.grid.Pw)return;this.grid.Pw.hide();if(this.cell.apM)this.cell.apM=false;else return;if(this.grid.Pw.QD){var z1=this.grid.Pw.Ul((this.grid.RY||"%d/%m/%Y"));var z2=this.grid.Pw.getDate();this.cell.ap=new Date(z2);this.dq(z1,z2);var t=this.ap;this.ap=this.AB;return(this.cell.ap.valueOf()!=t)};return false};eXcell_dhxCalendar.prototype.setValue=function(ap){if(typeof ap=="object"){this.cell.ap=ap;this.dq(this.grid.Pw.Ul((this.grid.RY||"%d/%m/%Y"),ap).toString(),this.cell.ap);return};this.cell.ap=new Date(this.grid.Pw.WK((this.grid.RY||"%d/%m/%Y"),ap.toString()));if(!ap||ap.toString().PA()==""){ap="&nbsp";this.cell.mG=true;this.cell.ap=new Date()}else this.cell.mG=false;if((this.cell.ap=="NaN")||(this.cell.ap=="Invalid Date")){this.cell.ap=new Date();this.dq("&nbsp;",0)}else this.dq(ap.toString(),this.cell.ap)};function eXcell_dhxCalendarA(cell){if(cell){this.cell=cell;this.grid=this.cell.parentNode.grid;if(!this.grid.Pw){var z=document.createElement("DIV");document.body.insertBefore(z,document.body.firstChild);this.grid.Pw=new dhtmlxCalendarObject(z,false,{Uw:true});this.grid.Pw.Re('en-us');this.grid.Pw.Vs(1900,2100);this.grid.Pw.zv();this.grid.Pw.hide();this.grid.Pw.setSkin("yahoolike");var sgrid=this.grid;this.grid.Pw.bl(function(){this.QD=true;window.setTimeout(function(){sgrid.bB()},1);return true});var and=function(e){(e||event).cancelBubble=true};dE(this.grid.Pw.entObj,"click",and)}}};eXcell_dhxCalendarA.prototype=new gD;eXcell_dhxCalendarA.prototype.edit=function(){this.grid.Pw.Yy(this.cell);this.grid.Pw.show();this.grid.Pw.QD=false;this.cell.apM=true;this.ap=this.cell.ap;this.AB=this.cell.innerHTML;this.grid.Pw.setDate(this.ap);this.grid.Pw.zv();this.cell.CZ=((!this.grid.hu)&&(cn||gP||ca))?"INPUT":"TEXTAREA";this.obj=document.createElement(this.cell.CZ);this.obj.style.height=(this.cell.offsetHeight-(bf?4:2))+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(e){(e||event).cancelBubble=true};this.obj.onmousedown=function(e){(e||event).cancelBubble=true};this.obj.value=this.getValue();this.cell.innerHTML="";this.cell.appendChild(this.obj);if(ca){this.obj.style.overflow="visible";if((this.grid.hu)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){this.obj.style.height="36px";this.obj.style.overflow="scroll"}};this.obj.onselectstart=function(e){if(!e)e=event;e.cancelBubble=true;return true};this.obj.focus();this.obj.focus()};eXcell_dhxCalendarA.prototype.getDate=function(){if(this.cell.ap)return this.cell.ap;return null};eXcell_dhxCalendarA.prototype.getValue=function(){return this.cell.innerHTML.toString().PA()};eXcell_dhxCalendarA.prototype.detach=function(){if(!this.grid.Pw)return;this.grid.Pw.hide();if(this.cell.apM)this.cell.apM=false;else return;if(this.grid.Pw.QD){this.grid.Pw.QD=false;var z1=this.grid.Pw.Ul(this.grid.RY||"%d/%m/%Y");var z2=this.grid.Pw.getDate();this.cell.ap=new Date(z2);this.dq(z1,z2);var t=this.ap;this.ap=this.AB;return(this.cell.ap.valueOf()!=t)};this.setValue(this.obj.value);var t=this.ap;this.ap=this.AB;return(this.cell.ap.valueOf()!=t)};eXcell_dhxCalendarA.prototype.setValue=function(ap){if(typeof ap=="object"){this.cell.ap=ap;this.dq(this.grid.Pw.Ul((this.grid.RY||"%d/%m/%Y"),ap).toString(),this.cell.ap);return};this.cell.ap=new Date(this.grid.Pw.WK((this.grid.RY||"%d/%m/%Y"),ap.toString()));if(!ap||ap.toString().PA()==""){ap="&nbsp";this.cell.mG=true;this.cell.ap=new Date()}else this.cell.mG=false;if((this.cell.ap=="NaN")||(this.cell.ap=="Invalid Date")){this.cell.ap=new Date();this.dq("&nbsp;",0)}else this.dq(ap.toString(),this.cell.ap)};