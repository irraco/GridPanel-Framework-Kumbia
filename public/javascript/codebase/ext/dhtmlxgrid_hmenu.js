D.prototype.enableHeaderMenu=function(){var that=this;this.attachEvent("onInit",function(){if(gP)this.hdr.oncontextmenu=new Function("e","return this.grid.xN(e||window.event);");else{this.Uj=this.eJ;this.eJ=function(e){if(e.button==2)return this.xN(e);return this.Uj(e)}};this.LG=this.obj.onclick;this.LN=this.hdr.onclick;this.hdr.onclick=function(e){if(e&&e.button==2)return false;that.sH(false);return that.LN.apply(this,arguments)};this.obj.onclick=function(){that.sH(false);return that.LG.apply(this,arguments)}});dE(document.body,"click",function(){that.sH(false)});if(this.hdr.rows.length)this.cG("onInit",[])};D.prototype.xN=function(ev){this.ws();this.sH(true,ev.clientX,ev.clientY);ev[bf?"srcElement":"target"].oncontextmenu=function(e){(e||event).cancelBubble=true;return false};ev.cancelBubble=true;if(ev.preventDefault)ev.preventDefault();return false};D.prototype.ws=function(){if(this.qN)return this.qN;var d=document.createElement("DIV");d.oncontextmenu=function(e){(e||event).cancelBubble=true;return false};d.onclick=function(e){(e||event).cancelBubble=true;return true};d.className="dhx_header_cmenu";d.style.width=d.style.height="5px";d.style.display="none";var a=[];var i=0;if(this.aC)i=this.aC.gA;var true_ind=i;for(var i;i<this.hdr.rows[1].cells.length;i++){var c=this.hdr.rows[1].cells[i];if(c.firstChild&&c.firstChild.tagName=="DIV")var ap=c.firstChild.innerHTML;else var ap=c.innerHTML;a.push("<div class='dhx_header_cmenu_item'><input type='checkbox' column='"+true_ind+"' len='"+(c.colSpan||1)+"' checked='true' />"+ap+"</div>");true_ind+=(c.colSpan||1)};d.innerHTML=a.join("");var that=this;var f=function(){var c=this.getAttribute("column");if(that.nh)that=that.aC;for(var i=0;i<this.getAttribute("len");i++)that.setColumnHidden((c*1+i*1),!this.checked);if(this.checked&&that.yI(c)==0)that.nT(c)};for(var i=0;i<d.childNodes.length;i++)d.childNodes[i].firstChild.onclick=f;document.body.insertBefore(d,document.body.firstChild);this.qN=d;d.style.position="absolute";d.style.visibility='hidden';if(!bf)d.style.overflow="auto";d.style.display='block';d.style.width=d.scrollWidth+"px";d.style.height=d.scrollHeight+"px";d.style.width=d.scrollWidth+8+"px";d.style.height=d.scrollHeight+4+"px";d.style.overflow="hidden";d.style.visibility='visible'};D.prototype.Bs=function(){for(var i=0;i<this.qN.childNodes.length;i++){var c=this.qN.childNodes[i].firstChild;var col=c.getAttribute("column");if(this.Fs(col)||(this.yI(col)==0))c.checked=false}};D.prototype.sH=function(mode,x,y){if(mode&&this.enableColumnMove){this.qN.parentNode.removeChild(this.qN);this.qN=null};this.ws();this.qN.style.display=(mode?'block':'none');if(mode){this.Bs(true);this.qN.style.left=x+"px";this.qN.style.top=y+"px"}};