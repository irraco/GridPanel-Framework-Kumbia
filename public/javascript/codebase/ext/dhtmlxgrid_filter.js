D.prototype.GF=function(column,value,iW){if(this.ip)return this.LW(column,value,iW);if(this.ic)return this.Vr(column,value,iW);if(this.SL){if(!iW)this.P=cD([].concat(this.SL))}else this.SL=[].concat(this.P);if(!this.P.length)return;var d=true;if(typeof(column)=="object")for(var j=0;j<value.length;j++)this.WZ(column[j],value[j]);else this.WZ(column,value);var p=this.obj.parentNode;var pp=this.obj.rows[0].parentNode;if(cn)pp=pp.parentNode;for(var i=this.obj.rows.length-1;i>0;i--)pp.removeChild(this.obj.rows[i]);for(var i=0;i<this.P.length;i++)pp.appendChild(this.P[i]);p.appendChild(this.obj);this.cG("onGridReconstructed",[])};D.prototype.WZ=function(column,value){if(value=="")return;var d=true;if(typeof(value)=="function")d=false;else value=(value||"").toString().toLowerCase();if(!this.P.length)return;var e=this.cells3(this.P[0],column);for(var i=this.P.length-1;i>=0;i--){e.cell=this.P[i].childNodes[column];if(d?(e.getValue().toString().toLowerCase().indexOf(value)== -1):(!value(e.getValue()))){this.P.splice(i,1)}}};D.prototype.Vr=function(column,value,iW){for(var i=0;i<this.P.length;i++)if(this.P[i]&& !this.aD[1][i]){this.aD[1][i]=this.P[i];this.aD[0][i]=this.P[i].idd};this.Fm(column,value,iW);for(var i=this.P.length-1;i>=0;i--)if(this.P[i])this.P[i].parentNode.removeChild(this.P[i]);this.P=new cD();this.limit=this.aD[0].length;this.hS(0,this.limit*this.ig);if(this.limit)this.kh(0)};D.prototype.Fm=function(column,value,iW){if(this.Jn){if(!iW){this.aD=[cD([].concat(this.Jn[0])),cD([].concat(this.Jn[1]))]}}else{this.Jn=[[].concat(this.aD[0]),[].concat(this.aD[1])]};if(!this.aD[0].length)return;if(typeof(column)=="object")for(var j=0;j<value.length;j++)this.Xa(column[j],value[j]);else this.Xa(column,value)};D.prototype.Xa=function(column,value){if(value=="")return;var d=true;if(typeof(value)=="function")d=false;else value=(value||"").toString().toLowerCase();var e=null;for(var i=this.aD[0].length-1;i>=0;i--){if(this.aD[1][i].idd){if(!e)e=this.cells3(this.aD[1][i],column);e.cell=this.aD[1][i].childNodes[column];var ap=e.getValue()}else{var ap=this.aD[1][i].getElementsByTagName("cell")[this.abc?this.abc[column]:column];if(ap&&ap.firstChild)ap=ap.firstChild.data;else ap=""};if(d?(ap.toString().toLowerCase().indexOf(value)== -1):(!value(ap))){this.aD[0].splice(i,1);this.aD[1].splice(i,1)}}};D.prototype.LW=function(column,value,iW){var a0=[];var a1=[];for(var i=0;i<this.P.length;i++){a0.push(this.P[i].idd);a1.push(this.P[i])};this.aD[1]=cD(a1.concat(this.aD[1]));this.aD[0]=cD(a0.concat(this.aD[0]));this.Fm(column,value,iW);for(var i=this.P.length-1;i>=0;i--)if(this.P[i].parentNode)this.P[i].parentNode.removeChild(this.P[i]);this.P=new cD();this.limit=this.aD[0].length;this.ee(1)};D.prototype.Ii=function(column){var c={};var f=[];this._build_m_order();var col=this.SL||this.P;if(col.length)var e=this.cells3(col[0],column);for(var i=0;i<col.length;i++){if(!col[i])continue;e.cell=col[i].childNodes[this.abc?this.abc[column]:column];var ap=e.getValue();if(ap)c[ap]=true};var col=this.Jn||this.aD;for(var i=col[0].length-1;i>=0;i--){if(!col[1][i])continue;if(col[1][i].idd){e.cell=col[1][i].childNodes[this.abc?this.abc[column]:column];var ap=e.getValue();if(ap)c[ap]=true}else{var ap=col[1][i].getElementsByTagName("cell")[column];if(ap&&ap.firstChild){ap=ap.firstChild.data;if(ap)c[ap]=true}}};var ND=this.combos[this.abc?this.abc[column]:column];for(d in c)if(c[d]===true)f.push(ND?(ND.get(d)||d):d);return f.sort()};D.prototype._build_m_order=function(){if(this.QS){this.abc=[];for(var i=0;i<this.QS.length;i++){this.abc[this.QS[i]]=i}}};D.prototype.EJ=function(){var a=[];var b=[];this._build_m_order();for(var i=0;i<this.filters.length;i++){var ind=this.abc?this.abc[this.filters[i][1]]:this.filters[i][1];b.push(ind);var ap=this.filters[i][0]._filter?this.filters[i][0]._filter():this.filters[i][0].value;var ND;if(typeof ap!="function"&&(ND=this.combos[ind])){ind=ND.gT.bP(ap);ap=(ind== -1)?ap:ND.kk[ind]};a.push(ap)};this.GF(b,a);if(this.hC)this.O();this.cG("onFilterEnd",[this.filters])};D.prototype.Hj=function(id,column,iW){if(!this.filters)this.filters=[];if(typeof(id)!="object")id=document.getElementById(id);if(!id)return;var self=this;if(!id.style.width)id.style.width="90%";if(id.tagName=='SELECT'){this.filters.push([id,column]);this.AU(id,column);id.onchange=function(){self.EJ()};if(bf)id.style.marginTop="1px";this.attachEvent("onEditCell",function(stage,a,ind){this._build_m_order();if(stage==2&&this.filters&&(this.abc?(ind==this.abc[column]):(ind==column)))this.AU(id,column);return true})}else if(id.tagName=='INPUT'){this.filters.push([id,column]);id.value='';id.onkeydown=function(){if(this.adm)window.clearTimeout(this.adm);this.adm=window.setTimeout(function(){self.EJ()},500)}}else if(id.tagName=='DIV'&&id.className=="combo"){this.filters.push([id,column]);id.style.padding="0px";id.style.margin="0px";if(!window.fe)window.fe=this.eg;var z=new bd(id,"_filter","90%");z.fF(true);id.combo=z;id.value="";this.Dg(id,column);z.attachEvent("onChange",function(){id.value=z.vL();self.EJ()})};if(id.parentNode)id.parentNode.className+=" filter"};D.prototype.abm=function(id,column){if(typeof(id)!="object")id=document.getElementById(id);if(!id)return;var self=this;if(id.tagName=='INPUT'){id.onkeypress=function(){if(this.adm)window.clearTimeout(this.adm);this.adm=window.setTimeout(function(){if(id.value=="")return;var z=self.OD(id.value,column);if(z.length)self.Th(z[0][0])},500)}};if(id.parentNode)id.parentNode.className+=" filter"};D.prototype.AU=function(t,c){var l=this.Ii(c);t.innerHTML="";t.options[0]=new Option("","");var f=this.afI?this.afI[c]:null;for(var i=0;i<l.length;i++)t.options[t.options.length]=new Option(f?f(l[i]):l[i],l[i])};D.prototype.setSelectFilterLabel=function(ind,fun){if(!this.afI)this.afI=[];this.afI[ind]=fun};D.prototype.Dg=function(t,c){var l=this.Ii(c);t.combo.clearAll();t.combo.ht(false);t.combo.jW("","");for(var i=0;i<l.length;i++)t.combo.jW(l[i],l[i]);t.combo.ht(true)};D.prototype.RQ=function(){for(var i=0;i<this.filters.length;i++){switch(this.filters[i][0].tagName.toLowerCase()){case "input":break;case "select":this.AU.apply(this,this.filters[i]);break;case "div":this.Dg.apply(this,this.filters[i]);break}}};D.prototype.tJ=function(fl,code){this.attachEvent("onXLE",this.RQ);this.attachEvent("onClearAll",function(){this.SL=null;if(!this.obj.rows.length)this.filters=[]});this.tJ=function(){}};D.prototype._in_header_text_filter=function(t,i){t.innerHTML="<input type='text' style='width:90%;font-size:8pt;font-family:Tahoma;-moz-user-select:text;'>";t.onclick=t.onmousedown=function(e){(e||event).cancelBubble=true;return true};t.onselectstart=function(){return(event.cancelBubble=true)};this.Hj(t.firstChild,i);this.tJ()};D.prototype._in_header_select_filter=function(t,i){t.innerHTML="<select style='width:90%;font-size:8pt;font-family:Tahoma;'></select>";t.onclick=function(e){(e||event).cancelBubble=true;return false};this.Hj(t.firstChild,i);this.tJ()};D.prototype._in_header_combo_filter=function(t,i){t.innerHTML="<div style='width:100%;padding-left:2px;overflow:hidden;font-size:8pt;font-family:Tahoma;-moz-user-select:text;' class='combo'></div>";t.onselectstart=function(){return(event.cancelBubble=true)};t.onclick=function(e){(e||event).cancelBubble=true;return false};this.Hj(t.firstChild,i);this.tJ()};D.prototype._in_header_text_search=function(t,i){t.innerHTML="<input type='text' style='width:90%;font-size:8pt;font-family:Tahoma;-moz-user-select:text;'>";t.onclick=t.onmousedown=function(e){(e||event).cancelBubble=true;return true};t.onselectstart=function(){return(event.cancelBubble=true)};this.abm(t.firstChild,i)};D.prototype._in_header_numeric_filter=function(t,i){this._in_header_text_filter.call(this,t,i);t.firstChild._filter=function(){var v=this.value;var r;var op="==";var num=parseFloat(v.replace("=",""));var num2=null;if(v){if(v.indexOf("..")!= -1){v=v.split("..");num=parseFloat(v[0]);num2=parseFloat(v[1]);return function(v){if(v>=num&&v<=num2)return true;return false}};r=v.match(/>|>=|<=|</);if(r){op=r[0];num=parseFloat(v.replace(op,""))};return Function("v"," if (v "+op+" "+num+" )return true;return false;")}}};D.prototype._in_header_master_checkbox=function(t,i){t.innerHTML="<input type='checkbox' />";var self=this;t.firstChild.onclick=function(){var ap=this.checked?1:0;self.fm(function(id){this.cells(id,i).setValue(ap)})}};D.prototype._in_header_stat_total=function(t,i,c){var calck=function(){var AG=0;for(var j=0;j<this.P.length;j++){var v=parseFloat(this.cells2(j,i).getValue());AG+=isNaN(v)?0:v};return this.Ct[i]?this.PH(AG,i):(Math.round(AG*100)/100)};this.Ru(t,calck,i,c,c)};D.prototype._in_header_stat_multi_total=function(t,i,c){var cols=c[1].split(":");c[1]="";var calck=function(){var AG=0;for(var j=0;j<this.P.length;j++){var v=parseFloat(this.cells2(j,cols[0]).getValue())*parseFloat(this.cells2(j,cols[1]).getValue());AG+=isNaN(v)?0:v};return this.Ct[i]?this.PH(AG,i):(Math.round(AG*100)/100)};this.Ru(t,calck,i,c,c)};D.prototype._in_header_stat_max=function(t,i,c){var calck=function(){var AG= -999999999;if(this.iD()==0)return "";for(var j=0;j<this.P.length;j++)AG=Math.max(AG,parseFloat(this.cells2(j,i).getValue()));return this.Ct[i]?this.PH(AG,i):AG};this.Ru(t,calck,i,c)};D.prototype._in_header_stat_min=function(t,i,c){var calck=function(){var AG=999999999;if(this.iD()==0)return "";for(var j=0;j<this.P.length;j++)AG=Math.min(AG,parseFloat(this.cells2(j,i).getValue()));return this.Ct[i]?this.PH(AG,i):AG};this.Ru(t,calck,i,c)};D.prototype._in_header_stat_average=function(t,i,c){var calck=function(){var AG=0;var count=0;for(var j=0;j<this.P.length;j++){var v=parseFloat(this.cells2(j,i).getValue());AG+=isNaN(v)?0:v;count++};return this.Ct[i]?this.PH(AG,i):(Math.round(AG/count*100)/100)};this.Ru(t,calck,i,c)};D.prototype._in_header_stat_count=function(t,i,c){var calck=function(){return this.iD()};this.Ru(t,calck,i,c)};D.prototype.Ru=function(t,calck,i,c){var that=this;var f=function(){this.dma(true);t.innerHTML=(c[0]?c[0]:"")+calck.call(this)+(c[1]?c[1]:"");this.dma(false);this.cG("onStatReady",[])};if(!this.afh){this.afh=[];this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var i=0;i<this.afh.length;i++)for(var j=0;j<4;j++)this.detachEvent(this.afh[i][j]);this.afh=[]}})};this.afh.push([this.attachEvent("onGridReconstructed",f),this.attachEvent("onXLE",f),this.attachEvent("onFilterEnd",f),this.attachEvent("onEditCell",function(stage,id,ind){if(stage==2&&ind==i)f.call(this);return true})]);t.innerHTML=""};