D.prototype.Cf=function(ind,header,type,width,sort,align,valign,hidden,dO){ind=parseInt(ind);if(ind>this.gA)ind=this.gA;if(!this.BL)this.BL=this.gA;this.sr(this.gA,ind-1,[(header||"&nbsp;"),(width||100),(type||"ed"),(align||"left"),(valign||""),(sort||"na"),(dO||""),(hidden||false),this.BL,(width||100)]);this.tg("Et",ind);if(typeof(header)=="object")for(var i=1;i<this.hdr.rows.length;i++){if(header[i-1]=="#rspan"){var als=i-1;var found=false;var pz=null;while(!found){var pz=this.hdr.rows[als];for(var j=0;j<pz.cells.length;j++)if(pz.cells[j].A==ind){found=j;break};als--};this.hdr.rows[als+1].cells[j].rowSpan=(this.hdr.rows[als].cells[j].rowSpan||1)+1}else this.Cs(ind,(header[i-1]||"&nbsp;"),i)}else this.Cs(ind,(header||"&nbsp;"));this.hdr.rows[0].cells[ind];this.gA++;this.BL++;this.setSizes()};D.prototype.CH=function(ind){ind=parseInt(ind);if(this.gA==0)return;if(!this.BL)this.BL=this.gA;if(ind>=this.gA)return;this.sr(ind,this.gA-1,[null,null,null,null,null,null,null,null,null,null,null]);this.tg("BY",ind);this.gA--;this.setSizes()};D.prototype.tg=function(method,pS,pQ){var z=this.obj.rows.length;for(var i=0;i<z;i++)this[method](this.obj.rows[i],pS,pQ,i);var z=this.hdr.rows.length;for(var i=0;i<z;i++)this[method](this.hdr.rows[i],pS,pQ,i);if(this.ftr){var z=this.ftr.firstChild.rows.length;for(var i=0;i<z;i++)this[method](this.ftr.firstChild.rows[i],pS,pQ,i)};this.fm(function(id){if(!this.bj[id].parentNode|| !this.bj[id].parentNode.tagName)this[method](this.bj[id],pS,pQ,-1)});var z=this.aD[1].length;for(var i=0;i<z;i++)if((this.aD[1][i])&&(this.aD[1][i].tagName=="TR"))this[method](this.aD[1][i],pS,pQ,-1)};D.prototype.sr=function(pS,pQ,ND){var ars=["ep","cZ","cO","dV","fb","fldSort","dO","L","QS"];if(this.cellWidthPX.length)ars.push("cellWidthPX");if(this.cellWidthPC.length)ars.push("cellWidthPC");if(this.BH)ars[ars.length]="BH";ars.push("combos");if(this.abz)ars.push("abz");var mode=(pS<=pQ);if(!this.QS){this.QS=new Array();var l=this.gA;for(var i=0;i<l;i++)this.QS[i]=i};for(var i=0;i<ars.length;i++){var t=this[ars[i]];if(t){if(mode){var ap=t[pS];for(var j=pS;j<pQ;j++)t[j]=t[j+1];t[pQ]=ap}else{var ap=t[pS];for(var j=pS;j>(pQ+1);j--)t[j]=t[j-1];t[pQ+1]=ap};if(ND)t[pQ+(mode?0:1)]=ND[i]}}};D.prototype.OP=function(pS,pQ){pQ--;pS=parseInt(pS);pQ=parseInt(pQ);if(pQ<pS)var tInd=pQ+1;else var tInd=pQ;if(!this.cG("onBeforeCMove",[pS,tInd]))return false;if(pS==tInd)return;this.bB();this.tg("_moveColInRow",pS,pQ);this.sr(pS,pQ);if(this.ij)this.vo(this.ij.A);this.cG("onAfterCMove",[pS,tInd])};D.prototype.Xb=function(cols){var z=new Array();for(var i=0;i<this.gA;i++){var n=cols[this.QS[i]];if(typeof(n)=="undefined")n="";z[i]=n};return z};D.prototype._moveColInRow=function(row,pS,pQ){var c=row.childNodes[pS];var ci=row.childNodes[pQ+1];if(!c)return;if(ci)row.insertBefore(c,ci);else row.appendChild(c);for(var i=0;i<row.childNodes.length;i++)row.childNodes[i].A=row.childNodes[i].hp=i};D.prototype.Et=function(row,ind,qw,mod){var cind=ind;if(row.bq){for(var i=row.bq.length;i>=ind;i--)row.bq[i]=i?(row.bq[i-1]+1):0;var cind=row.bq[ind]};var c=row.childNodes[cind];var z=document.createElement((mod)?"TD":"TH");z.style.width=this.cellWidthPX[ind];if(c)row.insertBefore(z,c);else row.appendChild(z);if(this.nz&&row.idd)this.M.dS(row.childNodes[cind],this);for(var i=cind+1;i<row.childNodes.length;i++)row.childNodes[i].A=row.childNodes[i].hp=row.childNodes[i].A+1;row.childNodes[cind].A=row.childNodes[cind].hp=ind;if(row.idd||typeof(row.idd)!="undefined"){this.cells3(row,cind).setValue("");z.align=this.dV[ind];z.style.verticalAlign=this.fb[ind];z.bgColor=this.dO[ind]}else if(z.tagName=="TD")z.innerHTML="&nbsp;"};D.prototype.BY=function(row,ind){var c=row.childNodes[ind];if(c.colSpan&&c.colSpan>1&&c.parentNode.idd){var t=c.colSpan-1;var v=this.cells4(c).getValue();this.Oq(c.parentNode.idd,c.A,1);if(t>1){this.Oq(c.parentNode.idd,c.A*1+1,t);this.cells(c.parentNode.idd,c.A*1+1).setValue(v)}};if(c)row.removeChild(c);for(var i=ind;i<row.childNodes.length;i++)row.childNodes[i].A=row.childNodes[i].hp=i};D.prototype.enableColumnMove=function(mode,HP){this.OQ=K(mode);if(typeof(HP)!="undefined")this.BH=HP.split(",");if(!this.Ke){dE(this.hdr,"mousedown",this.AH);dE(document.body,"mousemove",this.Ef);dE(document.body,"mouseup",this.AY);this.Ke=true}};D.prototype.AH=function(e){e=e||event;var el=e.target||e.srcElement;var zel=el;while(zel.tagName!="TABLE")zel=zel.parentNode;var grid=zel.grid;if(!grid)return;grid.setActive();if(!grid.OQ)return;el=grid.cd(el,"TD");if(el.style.cursor!="default")return true;if((grid)&&(!grid.pf)){if((!grid.BH)||(grid.BH[el.A]=="true"))grid.pf=el.A+1};return true};D.prototype.Ef=function(e){e=e||event;var grid=window.globalActiveDHTMLGridObject;if((grid)&&(grid.pf)){if(typeof(grid.pf)!="object"){var z=document.createElement("DIV");z.HH=(grid.pf-1);z.xv=null;z.innerHTML=grid.wW(z.HH);z.className="dhx_dragColDiv";z.style.position="absolute";document.body.appendChild(z);grid.pf=z};var cor=[];cor[0]=(document.body.scrollLeft||document.documentElement.scrollLeft);cor[1]=(document.body.scrollTop||document.documentElement.scrollTop);grid.pf.style.left=e.clientX+cor[0]+8+"px";grid.pf.style.top=e.clientY+cor[1]+8+"px";var el=e.target||e.srcElement;while((el)&&(typeof(el.hp)=="undefined"))el=el.parentNode;if(grid.pf.uA){grid.pf.uA.className=grid.pf.uA.className.replace(/columnTarget(L|R)/g,"");grid.pf.uA=null;grid.pf.xv=null};if(el){if(grid.hdr.rows[1].bq)var he=grid.hdr.rows[1].cells[grid.hdr.rows[1].bq[el.hp]];else var he=grid.hdr.rows[1].cells[el.hp];var z=e.clientX-(ej(he)-grid.kR.scrollLeft);if(z/he.offsetWidth>0.5){he.className+=" columnTargetR";grid.pf.xv=el.hp}else{he.className+=" columnTargetL";grid.pf.xv=el.hp-1};if(he.offsetLeft<(grid.HF.scrollLeft+20))grid.HF.scrollLeft=Math.max(0,he.offsetLeft-20);if((he.offsetLeft+he.offsetWidth-grid.HF.scrollLeft)>(grid.HF.offsetWidth-20))grid.HF.scrollLeft=Math.min(grid.HF.scrollLeft+he.offsetWidth+20,grid.HF.scrollWidth-grid.HF.offsetWidth);grid.pf.uA=he}};return true};D.prototype.AY=function(e){e=e||event;var grid=window.globalActiveDHTMLGridObject;if((grid)&&(grid.pf)){if(typeof(grid.pf)=="object"){grid.pf.parentNode.removeChild(grid.pf);if(grid.pf.xv!=null)grid.OP(grid.pf.HH,grid.pf.xv+1);if(grid.pf.uA)grid.pf.uA.className=grid.pf.uA.className.replace(/columnTarget(L|R)/g,"");grid.pf.uA=null;grid.pf.grid=null};grid.pf=0};return true};D.prototype.setOnBeforeColumnMove=function(aQ){this.attachEvent("onBeforeCMove",aQ)};D.prototype.IU=function(aQ){this.attachEvent("onAfterCMove",aQ)};