function eXcell_math(cell){if(cell){this.cell=cell;this.grid=this.cell.parentNode.grid};this.isDisabled=function(){if(this.grid.ga[this.cell.A]){var z=eval("new eXcell_"+this.grid.ga[this.cell.A]+"(this.cell)");return z.isDisabled()};return false};this.edit=function(){this.ap=this.getValue();if((this.cell.AB.indexOf("=")==0)&&(!this.grid.DI))return false;if(this.grid.ga[this.cell.A]){var z=eval("new eXcell_"+this.grid.ga[this.cell.A]+"(this.cell)");this.SC=z.SC;this.combo=z.combo;this.ahd=true;return z.edit.call(this)};this.obj=document.createElement("TEXTAREA");this.obj.style.width="100%";this.obj.style.height=(this.cell.offsetHeight-4)+"px";this.obj.style.border="0px";this.obj.style.margin="0px";this.obj.style.padding="0px";this.obj.style.overflow="hidden";this.obj.style.fontSize="12px";this.obj.style.fontFamily="Arial";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(e){(e||event).cancelBubble=true};this.obj.value=this.cell.AB;this.cell.innerHTML="";this.cell.appendChild(this.obj);this.obj.onselectstart=function(e){if(!e)e=event;e.cancelBubble=true;return true};this.obj.focus();this.obj.focus()};this.getValue=function(){if(this.grid.ga[this.cell.A]){var d=this.cell;var z=eval("new eXcell_"+(this.grid.ga[this.cell.A])+"(d)");return z.getValue()}else return this.cell.innerHTML.toString().PA()};this.je=function(ap){if(this.grid.ga[this.cell.A]){var z=eval("new eXcell_"+this.grid.ga[this.cell.A]+"(this.cell)");z.setValue(typeof(ap)=="undefined"?"":ap)}else this.dq(this.grid.rO(cell)||"0")};this.setValue=function(ap){this.cell.AB=ap;this.cell.Lq=this.grid.MB(ap,this.cell);this.je(this.grid.rO(cell));this.grid.lE(this.cell)};this.detach=function(){if(this.ahd&&this.grid.ga[this.cell.A]){var z=eval("new eXcell_"+this.grid.ga[this.cell.A]+"(this.cell)");return z.detach.call(this)};if((this.cell.AB.indexOf("=")==0)&&(!this.grid.DI))return false;this.setValue(this.obj.value);return this.ap!=this.getValue()}};eXcell_math.prototype=new gD;fU.prototype.je=fU.prototype.setValue;eXcell_price.prototype.je=eXcell_price.prototype.setValue;eXcell_dyn.prototype.je=eXcell_dyn.prototype.setValue;eXcell_ch.prototype.je=eXcell_ch.prototype.setValue;eXcell_ra.prototype.je=eXcell_ra.prototype.setValue;eXcell_cp.prototype.je=eXcell_cp.prototype.setValue;eXcell_co.prototype.je=eXcell_co.prototype.setValue;eXcell_txt.prototype.je=eXcell_txt.prototype.setValue;eXcell_edn.prototype.je=eXcell_edn.prototype.setValue;eXcell_math.prototype.qo=function(ap){this.je(ap);this.grid.lE(this.cell)};fU.prototype.setValue=eXcell_math.prototype.qo;eXcell_price.prototype.setValue=eXcell_math.prototype.qo;eXcell_dyn.prototype.setValue=eXcell_math.prototype.qo;eXcell_ch.prototype.setValue=eXcell_math.prototype.qo;eXcell_ra.prototype.setValue=eXcell_math.prototype.qo;eXcell_cp.prototype.setValue=eXcell_math.prototype.qo;eXcell_co.prototype.setValue=eXcell_math.prototype.qo;eXcell_txt.prototype.setValue=eXcell_math.prototype.qo;eXcell_edn.prototype.setValue=eXcell_math.prototype.qo;D.prototype.lE=function(cell,vz){if(!cell)return;if(!this.WS){if(cell.sR){for(var i=0;i<cell.sR.length;i++)if(cell.sR[i]){if(this.ga[cell.sR[i].A]){var z=eval("new eXcell_"+this.ga[cell.sR[i].A]+"(cell.sR[i])");ap=this.rO(cell.sR[i]);z.setValue(typeof(ap)=="undefined"?"":ap)}else cell.sR[i].innerHTML=this.rO(cell.sR[i]);this.lE(cell.sR[i])}};if(this.rr&&this.rr[cell.A]){vz=vz||this.dP.get[cell.parentNode.idd].parent;if(!vz)return;vz=this.bj[vz.id];if(!vz)return;if(this.ga[cell.A]){var z=eval("new eXcell_"+this.ga[cell.A]+"(vz.childNodes[cell.A])");var ap=this.rO(vz.childNodes[cell.A]);z.setValue(typeof(ap)=="undefined"?"":ap)}else vz.childNodes[cell.A].innerHTML=this.rO(vz.childNodes[cell.A]);this.lE(vz.childNodes[cell.A])}}else this.vN=true};D.prototype.Wp=function(x){for(var i=0;i<this.rr.length;i++)if(this.rr[i])this.lE(this.bj[x.id].childNodes[i],x)};D.prototype.setMathRound=function(Ki){this.FR=Ki;this.HO=Math.pow(10,Ki)};D.prototype.enableMathEditing=function(status){this.DI=K(status)};D.prototype.XD=function(status){this.oX=K(status)};D.prototype.rO=function(cell){if(!cell.Lq)return "";try{var agrid=this;if(!this.HO){var z=eval(cell.Lq);return z}else{var z=eval(cell.Lq);z=Math.round(z*this.HO).toString();if(z==0)return 0;if(this.FR>0){var n=z.length-this.FR;if(n<0){z=("000000000"+z).substring(9+n);n=0};return(z.substring(0,n)+"."+z.substring(n,z.length))}else return z}}catch(e){return("#SCL")}};D.prototype.Gj=function(row,ahk){var b=0;var z=this.dP.get[row];for(var i=0;i<z.bu.length;i++)b=b*1+this.cells(z.bu[i].id,ahk).getValue()*1;return b};D.prototype.MB=function(code,cell){if(!code)return "";code=code.toString();if(code.indexOf("=")!=0){this.CL(new Array(),cell,0);return code};var qL=null;code=code.replace("=","");if(code.indexOf("sum")!= -1){code=code.replace("sum","(agrid.Gj('"+cell.parentNode.idd+"',"+cell.A+"))");if(!this.rr)this.rr=[];this.rr[cell.A]=true;return code};if(code.indexOf("[[")!= -1){var test=/(\[\[([^\,]*)\,([^\]]*)]\])/g;var agrid=this;qL=qL||(new Array());code=code.replace(test,function($0,$1,$2,$3){if($2=="-")$2=cell.parentNode.idd;if($2.indexOf("#")==0)$2=agrid.py($2.replace("#",""));qL[qL.length]=[$2,$3];return "(agrid.cells(\""+$2+"\","+$3+").getValue()*1)"})};if(code.indexOf(":")!= -1){var test=/:(\w+)/g;var agrid=this;var id=cell.parentNode.idd;qL=qL||(new Array());code=code.replace(test,function($0,$1,$2,$3){qL[qL.length]=[id,agrid.eZ($1)];return '(agrid.cells("'+id+'",agrid.eZ("'+$1+'")).getValue()*1)'})}else{var test=/c([0-9]+)/g;var agrid=this;var id=cell.parentNode.idd;qL=qL||(new Array());code=code.replace(test,function($0,$1,$2,$3){qL[qL.length]=[id,$1];return "(agrid.cells(\""+id+"\","+$1+").getValue()*1)"})};this.CL(qL,cell,0);return code};D.prototype.Ja=function(){var a=window.rc;window.rc=new Array();window.vJ=null;for(var i=0;i<a.length;i++){(a[i][2]).CL(a[i][0],a[i][1],a[i][3]);if((a[i][2]).ga[a[i][1].A]){var z=eval("new eXcell_"+(a[i][2]).ga[a[i][1].A]+"(a[i][1])");var ap=(a[i][2]).rO(a[i][1]);z.setValue(typeof(ap)=="undefined"?"":ap)}else a[i][1].innerHTML=(a[i][2]).rO(a[i][1]);(a[i][2]).lE(a[i][1])};if(a[0]&&window.rc.length==0)a[0][2].cG("onMathEnd",[])};D.prototype.CL=function(ar,cell,count){if(count>5)return;if(cell.yh){for(var i=0;i<cell.yh.length;i++)(cell.yh[i][0]).sR[cell.yh[i][1]]=null};cell.yh=new Array();for(var i=0;i<ar.length;i++){var a=this.dz(ar[i][0]);if(!a){if(!window.rc)window.rc=new Array();window.rc.grid=this;window.rc[window.rc.length]=[ar,cell,this,count+1];if(!window.vJ)window.vJ=window.setTimeout(this.Ja,300);return 0};var b=a.childNodes[ar[i][1]];if(!b.sR)b.sR=new Array();cell.yh[i]=[b,b.sR.length];b.sR[b.sR.length]=cell}};if(cn){(function(){var wi=String.prototype.replace;String.prototype.replace=function(search,replace){if(typeof replace!="function"){return wi.apply(this,arguments)};var str=""+this;var Eq=replace;if(!(search instanceof RegExp)){var idx=str.indexOf(search);return(idx== -1?str:wi.apply(str,[search,Eq(search,idx,str)]))};var reg=search;var result=[];var yS=reg.lastIndex;var re;while((re=reg.exec(str))!=null){var idx=re.index;var CF=re.concat(idx,str);result.push(str.slice(yS,idx),Eq.apply(null,CF).toString());if(!reg.global){yS+=RegExp.lastMatch.length;break}else{yS=reg.lastIndex}};result.push(str.slice(yS));return result.join("")}})()};