D.prototype.Ib=function(){if(!this.pj)return;this.WJ=false;if(typeof(this.tH)!="undefined"){var b=this.xe();this.P=new cD(0);for(var i=0;i<b.length;i++){var gr=b[i].te;for(var j=0;j<gr.qA.length;j++){this.obj.firstChild.appendChild(gr.qA[j]);gr.qA[j].style.display='';this.P.push(gr.qA[j])}};this.uw.appendChild(this.obj)};delete this.pj;delete this.tH;if(this.vE)this.xK=this.vE;this.cG("onUnGroup",[])};D.prototype.OI=function(ind){if(this.pj)this.Ib();this.WJ=true;this.pj=[];this.tH=ind;this.CE=function(ind,dir){var r=this.P[ind+dir];if(r&&(r.style.display=="none"||r.te))return this.CE(ind+dir,dir);return r};this.zf.k38_0_0=function(){if(this.editor&&this.editor.combo)this.editor.Kc();else{var uH=this.row.rowIndex;if(!uH)return;var NH=this.CE(uH-1,-1);if(NH)this.eQ(NH,this.cell.A,true)}};if(!this.vE){this.attachEvent("onClearAll",function(){this.Ib()});this.attachEvent("onBeforeRowDeleted",function(id){if(!this.bj[id])return true;var ap=this.cells(id,this.tH).getValue();if(ap==="")ap=" ";var z=this.pj[ap];this.Cc(z);return true});this.attachEvent("onCheckbox",function(id,index,value){this.cG("onEditCell",[2,id,index,(value?1:0),(value?0:1)])});this.attachEvent("onEditCell",function(stage,id,ind,ap,Kr){if(stage==2&&ap!=Kr&&ind==this.tH){if(Kr==="")Kr=" ";this.Cc(this.pj[Kr]);var r=this.bj[id];var i=this.P.bP(r);var ni=this.Bp(ap);var n=this.P[ni];var p=r.parentNode;var o=r.rowIndex;p.removeChild(r);if(n)p.insertBefore(r,n);else p.appendChild(r);this.P.ml(ni,r);if(ni<i)i++;this.P.Qt(i,r);this.O()};return true})};this.vE=this.xK;this.xK=function(col,type,order){if(col!=this.tH)return this.EZ(col,type,order);else return this.Er(col,type,order)};this.zf.k13_1_0=this.zf.k13_0_1=function(){};this.Cu();this.cG("onGroup",[])};D.prototype.Bp=function(ap){if(ap==="")ap=" ";if(!this.pj[ap]){this.pj[ap]={text:ap,row:this.xW(),count:0,state:"minus"}};var z=this.pj[ap];z.row.te=z;var ind=this.P.bP(z.row)+z.count+1;z.count++;this.qP(z);return ind};D.prototype.Cc=function(z){if(!z)return;z.count--;if(z.count==0){z.row.parentNode.removeChild(z.row);this.P.Qt(this.P.bP(z.row));delete this.pj[z.text]}else this.qP(z);return true};D.prototype.BB=D.prototype._insertRowAt;D.prototype._insertRowAt=function(r,ind,Ch){if(typeof(this.pj)!="undefined"){var ap=this.cells4(r.childNodes[this.tH]).getValue();if(!ap)ap=" ";ind=this.Bp(ap)};return this.BB(r,ind,Ch)};D.prototype.qP=function(z){var html="<img style='margin-bottom:-4px' src='"+this.eg+z.state+".gif'> ";if(this.yW)html+=this.yW(z.text,z.count);else html+=z.text+" ( "+z.count+" ) ";z.row.firstChild.innerHTML=html};D.prototype.xW=function(Ch){var r=document.createElement("TR");var t=document.createElement("TD");r.appendChild(t);t.style.cssText="vertical-align:middle;font-family:Tahoma;font-size:10pt;font-weight:bold;height:30px;border:0px;border-bottom: 2px solid navy;";t.colSpan=this.gA;var that=this;t.onclick=function(e){that.qk(that.cd(this,"TR"));(e||event).cancelBubble="true"};t.ondblclick=function(e){(e||event).cancelBubble="true"};if(!Ch){if(cn)this.obj.appendChild(r);else this.obj.firstChild.appendChild(r);this.P.push(r)};return r};D.prototype.EZ=function(col,type,order){var b=this.xe();b.reverse();for(var i=0;i<b.length;i++){var c=b[i].te.qA;var a={};for(var j=0;j<c.length;j++)a[c[j].idd]=this.cells3(c[j],col).getValue();this.aeo(col,type,order,a,c)};this.wY(b);this.setSizes();this.cG("onGridReconstructed",[])};D.prototype.Er=function(col,type,order){var b=this.xe();var a=[];for(var i=0;i<b.length;i++){b[i].idd="_sort_"+i;a["_sort_"+i]=b[i].te.text};this.aeo(col,type,order,a,b);this.wY(b);this.setSizes()};D.prototype.xe=function(){var b=[];this.uw=this.obj.parentNode;this.uw.removeChild(this.obj);var a=[];for(var i=this.iD()-1;i>=0;i--){if(this.P[i].te){this.P[i].te.qA=a;a=[];b.push(this.P[i])}else a.push(this.P[i]);this.P[i].parentNode.removeChild(this.P[i])};return b};D.prototype.wY=function(b){this.P=new cD(0);for(var i=0;i<b.length;i++){var gr=b[i].te;this.obj.firstChild.appendChild(gr.row);this.P.push(gr.row);gr.row.idd=null;for(var j=0;j<gr.qA.length;j++){this.obj.firstChild.appendChild(gr.qA[j]);this.P.push(gr.qA[j])};delete gr.qA};this.uw.appendChild(this.obj)};D.prototype.Cu=function(b){if(!this.iD())return;var b=[];this.uw=this.obj.parentNode;this.uw.removeChild(this.obj);var a=[];for(var i=this.iD()-1;i>=0;i--){var ap=this.cells4(this.P[i].childNodes[this.tH]).getValue();if(!ap)ap=" ";if(!this.pj[ap]){this.pj[ap]={text:ap,row:this.xW(true),count:0,state:"minus"};var z=this.pj[ap];z.row.te=z;this.pj[ap].qA=[];b.push(z.row)};this.pj[ap].count++;this.pj[ap].qA.push(this.P[i]);this.P[i].parentNode.removeChild(this.P[i])};for(var i=0;i<b.length;i++)this.qP(b[i].te);this.wY(b);this.cG("onGridReconstructed",[])};D.prototype.qk=function(row){var z=row.te;var ind=this.P.bP(z.row)+1;z.state=z.state=="minus"?"plus":"minus";var st=z.state=="plus"?"none":"";while(this.P[ind]&& !this.P[ind].te){this.P[ind].style.display=st;ind++};this.qP(z);this.cG("onGroupStateChanged",[z.row.idd]);this.setSizes()};D.prototype.Oc=function(ap){if(this.pj[ap].state=="plus");this.qk(this.pj[ap].row)};D.prototype.Nu=function(ap){if(this.pj[ap].state=="minus");this.qk(this.pj[ap].row)};D.prototype.Mg=function(){for(var i in this.pj)if(this.pj[i]&&this.pj[i].state=="plus")this.qk(this.pj[i].row)};D.prototype.KU=function(){for(var i in this.pj)if(this.pj[i]&&this.pj[i].state=="minus")this.qk(this.pj[i].row)};