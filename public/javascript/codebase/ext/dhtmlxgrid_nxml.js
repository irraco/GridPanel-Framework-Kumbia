D.prototype.ark=function(oZ){if(!this.Wc){this.Wc=this.loadXML;this.adI=this.bH;this.loadXML=this.EI;this.bH=this.EI}};D.prototype.EI=function(oZ,bo){this.bA=new ag(this.RV,this);this.bA.bs=bo;this.bA.loadXML(oZ)};D.prototype.RV=function(obj,b,c,d,xml){var z=this.ai.responseText;obj.rF(z)};D.prototype.Qi=function(mode){this.Sz=K(mode)};D.prototype.ahO=function(mode){this.KY=K(mode);if(this.KY)this.Qi(true)};D.prototype.lW=function(str){this.oU=(str||this.oU);this.lw=this.oU.charCodeAt(0);var trans=[0,1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F"];this.lw="\\x"+trans[Math.floor(this.lw/16)]+""+trans[(this.lw%16)]};D.prototype.rF=function(str){if(!this.lw)this.lW();var Mi=new RegExp("^([^"+this.lw+"]+)"+this.lw);var IX=new RegExp("\n([^"+this.lw+"]+)"+this.lw,"g");var asp=new RegExp(""+this.lw+"","g");if(this.KY){hdr=str.substr(0,str.indexOf("\n"));str=str.substr(str.indexOf("\n")+1);hdr="<head><beforeInit><call command='setHeader'><param>"+hdr.replace(new RegExp(this.lw,"g"),",")+"</param></call><call command='init'></call></beforeInit></head>"};if(this.Sz){str=str.replace(Mi,"<row><cell><![CDATA[$1]]></cell><cell><![CDATA[");str=str.replace(IX,"]]></cell></row><row id=''><cell><![CDATA[$1]]></cell><cell><![CDATA[")}else{str=str.replace(Mi,"<row id='$1'><cell><![CDATA[");str=str.replace(IX,"]]></cell></row><row id='$1'><cell><![CDATA[")};str=str.replace(asp,"]]></cell><cell><![CDATA[");if(str.indexOf("<row")!=0)str="<row><cell><![CDATA["+str;str="<?xml version='1.0'?><rows>"+(this.KY?(hdr+str):str)+"]]></cell></row></rows>";this.bA=new ag(this.vj,window,true,this.ir);this.bA.bH(str)};D.prototype.tN=function(){this.bB();if(this.oX)this.zt="getMathValue";else this.zt="getValue";var bW="";if(this.KY){var a=[];var b=this.hdr.rows[1].cells;for(var i=0;i<b.length;i++)if((!this.nF)||(this.nF[i]))a.push(bf?b[i].innerText:b[i].textContent);bW=a.join(this.oU)+"\n"};var i=0;var afE=(this.ic)?this.aD[0].length:(this.aD[0].length+this.P.length);for(i;i<afE;i++){if(i>=this.P.length&&this.ip){var AT=this.lJ(null,i-this.P.length)}else{var r=this.P[i];var AT=this.lJ(r,i)};bW+=AT;if(AT!="")bW+="\n"};return bW};D.prototype.lJ=function(r,i,start,end){var bW=new Array();if((!r)||(r.kp)||(r.kl)||(r.tagName=="row")){if(this.aD[1][i]){var r=this.aD[1][i];if(!this.Sz)bW[bW.length]=r.getAttribute("id");for(var j=0;j<r.childNodes.length;j++){if(r.childNodes[j].tagName=="cell"){var c=r.childNodes[j];bW[bW.length]=c.firstChild?c.firstChild.nodeValue:""}}};return bW.join(this.oU)};if(!this.Sz)bW[bW.length]=r.idd;start=start||0;end=end||r.childNodes.length;var xJ=false;var ind=start;for(var jj=start;ind<end;jj++){var real_ind=r.childNodes[jj].A;if((!this.nF)||(this.nF[real_ind])){var DJ=r.childNodes[jj];var zx=this.cells(r.idd,real_ind);while(ind!=real_ind){ind++;bW.push("")};ind++;if(zx.cell)wF=zx[this.zt]();else wF="";if((this.Zx)&&(zx.hy()))xJ=true;bW[bW.length]=((wF===null)?"":wF);if((this.CP)&&(DJ.colSpan)){DJ=DJ.colSpan-1;for(var u=0;u<DJ;u++)bW[bW.length]="";ind++}}};if((this.xq)&&(!xJ))return "";return bW.join(this.oU)};D.prototype.yP=function(ap){if(window.clipboardData)window.clipboardData.setData("Text",ap);else(new Clipboard()).copy(ap)};D.prototype.rD=function(){if(window.clipboardData)return window.clipboardData.getData("Text");else return(new Clipboard()).asc()};D.prototype.PY=function(cq,nA){if((!cq)||(!nA)){if(!this.bY[0])return;cq=this.bY[0].idd;nA=this.cell.A};var ed=this.cells(cq,nA);this.yP(ed.DB?ed.DB():ed.getValue())};D.prototype.DH=function(cq,nA){if((!cq)||(!nA)){if(!this.bY[0])return;cq=this.bY[0].idd;nA=this.cell.A};var ed=this.cells(cq,nA);ed[ed.hW?"setLabel":"setValue"](this.rD())};D.prototype.Sr=function(cq){var bW="";if(this.oX)this.zt="getMathValue";else if(this.aaV)this.zt="getTitle";else this.zt="getValue";if(cq)bW=this.lJ(this.dz(cq));else for(var i=0;i<this.bY.length;i++){if(bW)bW+="\n";bW+=this.lJ(this.bY[i])};this.yP(bW)};D.prototype.EE=function(cq){var csv=this.rD();if(!csv)return;if(cq)var r=this.dz(cq);else var r=this.bY[0];if(!r)return;csv=csv.split(this.oU);for(var i=1;i<csv.length;i++){var ed=this.cells3(r,i-1);ed[ed.hW?"setLabel":"setValue"](csv[i])}};D.prototype.IG=function(){var csv=this.rD();if(!csv)return;var z=csv.split("\n");for(var i=0;i<z.length;i++)if(z[i]){csv=z[i].split(this.oU);if(this.Sz)this.hY(this.iD()+2,csv);else this.hY(csv[0],csv.slice(1))}};D.prototype.Qd=function(){this.yP(this.tN())};D.prototype.LJ=function(){var csv=this.rD();if(!csv)return;this.rF(csv)};D.prototype.aqV=function(oZ){if(!this.SM){this.SM=document.createElement("FORM");this.SM.action=(oZ||"")+"xls.php";this.SM.method="post";this.SM.target=(bf?"_blank":"");document.body.appendChild(this.SM);var apo=document.createElement("INPUT");apo.type="hidden";apo.name="csv";this.SM.appendChild(apo);var aqf=document.createElement("INPUT");aqf.type="hidden";aqf.name="csv_header";this.SM.appendChild(aqf)};var arw=this.tN();this.SM.childNodes[0].value=arw;var Bo=[];var l=this.gA;for(var i=0;i<l;i++){Bo.push(this.wW(i))};Bo=Bo.join(',');this.SM.childNodes[1].value=Bo;this.SM.submit()};D.prototype.aem=function(are,asg){var html="<style>TD {font-family:Arial;text-align:center};</style>";html+="<base href='"+document.location.href+"'></base>";html+=(are||"");html+='<table width="100%" border="2px" cellpadding="0" cellspacing="0">';var ZZ=this.P.length;var Qz=this.gA;var width=this.XV();html+='<tr>';for(var i=0;i<Qz;i++){if(this.L&&this.L[i])continue;var hcell=this.hdr.rows[1].cells[this.hdr.rows[1].bq?this.hdr.rows[1].bq[parseInt(i)]:i];var colspan=(hcell.colSpan||1);var rowspan=(hcell.rowSpan||1);for(var j=1;j<colspan;j++)width[i]+=width[j];html+='<td rowspan="'+rowspan+'" width="'+width[i]+'%" style="padding-left:2px;padding-right:2px;background-color:lightgrey;" colspan="'+colspan+'">'+this.wW(i)+'</td>';i+=colspan-1};html+='</tr>';for(var i=2;i<this.hdr.rows.length;i++)html+="<tr style='background-color:lightgrey'>"+this.hdr.rows[i].innerHTML+"</tr>";for(var i=0;i<ZZ;i++){html+='<tr>';if(this.P[i].te){html+=this.P[i].innerHTML.replace(/<img[^>]*>/gi,"")+'</tr>';continue};for(var j=0;j<Qz;j++){if(this.L&&this.L[j])continue;var c=this.cells(this.P[i].idd,j);if(c.getContent)value=c.getContent();else if(c.afl||c.combo)var value=c.cell.innerHTML;else var value=c.getValue();var color=this.dO[j]?'background-color:'+this.dO[j]+';':'';var align=this.dV[j]?'text-align:'+this.dV[j]+';':'';html+='<td style="padding-left:2px;padding-right:2px;'+color+align+'">'+(value===""?"&nbsp;":value)+'</td>'};html+='</tr>'};if(this.ftr)for(var i=1;i<this.ftr.childNodes[0].rows.length;i++){html+="<tr>";for(var j=0;j<this.ftr.rows[i].cells.length;j++)if(this.L&&this.L[j])continue;else html+="<td colspan='"+(this.ftr.rows[i].cells[j].colSpan||1)+"'>"+this.ftr.rows[i].cells[j].innerHTML+"</td>";html+="</tr>"};html+='</table>';html+=(asg||"");var d=window.open('','_blank');d.document.write(html);d.document.close()};D.prototype.XV=function(){var width=[];var MG=0;for(var i=0;i<this.gA;i++){var w=this.yI(i);width.push(w);MG+=w};var uZ=[];var xI=0;for(var i=0;i<width.length;i++){var p=Math.floor((width[i]/MG)*100);xI+=p;uZ.push(p)};uZ[uZ.length-1]+=100-xI;return uZ};D.prototype.anp=function(obj){};D.prototype.akQ=function(oZ){};D.prototype.aeN=function(){};D.prototype.aia=function(){};if(!window.clipboardData)window.clipboardData={ahA:function(){var clip=Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);if(!clip)return null;var trans=Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);if(!trans)return null;trans.addDataFlavor('text/unicode');var str=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);this.Pv=[clip,trans,str];return true},setData:function(type,text){netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');if(!this.ahA())return false;this.Pv[2].data=text;this.Pv[1].setTransferData("text/unicode",this.Pv[2],text.length*2);var akZ=Components.interfaces.nsIClipboard;this.Pv[0].setData(this.Pv[1],null,akZ.kGlobalClipboard)},getData:function(type){netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');if(!this.ahA())return false;this.Pv[0].getData(this.Pv[1],this.Pv[0].kGlobalClipboard);var To=new Object();var str=new Object();this.Pv[1].getTransferData("text/unicode",str,To);if(str)str=str.value.QueryInterface(Components.interfaces.nsISupportsString);if(str)return str.data.substring(0,To.value/2);return ""}};