D.prototype.Na=function(mode){this.abT=K(mode)};D.prototype.gM=function(mode,zl,wH,xo){this.ic=K(mode);this.attachEvent("onBeforeSorting",function(){return this.abT});if(!this.ic){this.bA=new ag(this.vj,window,true,this.ir);window.clearTimeout(this.ut);if(this.tL){this.deleteRow=this.tL;this._insertRowAt=this.LY;this.xK=this.Eh;this.CV=false};return};if(!this.ig)this.ig=20;if(!this.tL){this.tL=this.deleteRow;this.deleteRow=this.QN;this.LY=this._insertRowAt;this._insertRowAt=this.Je;this.Eh=this.xK;this.xK=function(col,type,order){order=(order||"asc").toLowerCase();var self=this;var iC=new Array();var AT=this.P;for(var i=0;i<this.P.length;i++)if(this.P[i]&& !this.aD[1][i]){this.aD[1][i]=this.P[i];this.aD[0][i]=this.P[i].idd};var a=this.aD[1];function DQ(node,col){var z=node.firstChild;while(true){while(z&&z.tagName!="cell"&&z.tagName!="TD")z=z.nextSibling;col--;if(col<0)return(z.firstChild?z.firstChild.data:"");z=z.nextSibling};return ""};for(var i=0;i<a.length;i++){a[i]={obj:a[i],idd:(a[i].idd||a[i].getAttribute("id"))};iC[a[i].idd]=DQ(a[i].obj,col)};var z=(new Date()).valueOf();if(type=='cus')a.sort(function(a,b){return self.abz[col](iC[a.idd],iC[b.idd],order,a.idd,b.idd)});else if(type=='str')a.sort(function(a,b){if(order=="asc")return iC[a.idd]>iC[b.idd]?1: -1;else return iC[a.idd]<iC[b.idd]?1: -1});else if(type=='int')a.sort(function(a,b){var qe=parseFloat(iC[a.idd]);qe=isNaN(qe)? -99999999999999:qe;var sm=parseFloat(iC[b.idd]);sm=isNaN(sm)? -99999999999999:sm;if(order=="asc")return qe-sm;else return sm-qe});else if(type=='date')a.sort(function(a,b){var qe=Date.parse(iC[a.idd])||(Date.parse("01/01/1900"));var sm=Date.parse(iC[b.idd])||(Date.parse("01/01/1900"));if(order=="asc")return qe-sm;else return sm-qe});var z2=(new Date()).valueOf();for(var i=0;i<a.length;i++)a[i]=a[i].obj;for(var i=1;i<this.obj.rows.length;i)this.obj.rows[1].parentNode.removeChild(this.obj.rows[1]);this.P=new cD();for(var i=0;i<a.length;i++)this.aD[0][i]=(a[i].idd||a[i].getAttribute("id"));this.hS(0,this.limit*this.ig);this.kh(0)}};this.BF=12;this.zu=new Array();this.LC=this.limit=zl;this.hu=false;this.xd=Math.floor(parseInt(this.aL.offsetHeight)/this.ig)+2;this.xo=xo;this.obj.className+=" row20px";this.Cr=wH||this.xd;if(this.hdr.childNodes[1])this.Ve();else this.CV=true};D.prototype.ajA=function(){if(!this.ig)this.ig=20;return[Math.floor(this.HF.scrollTop/this.ig),Math.ceil(parseInt(this.HF.offsetHeight)/this.ig),this.limit]};D.prototype.acv=function(height){this.ig=parseInt(height)};D.prototype.Ve=function(){if(this.limit)this.hS(0,this.limit*this.ig);this.CV=false};D.prototype.aiy=function(mode,limit){if(!K(mode))return;this.xh=limit||1000};D.prototype.BE=function(start,direction){if(cn)return start;var i=1;for(i;i<=this.Cr;i++)if(((i*direction+start)<0)||((i*direction+start)>this.limit)||(this.P[i*direction+start])||(this.aD[i*direction+start]))break;return start+(i-1)*direction};D.prototype.Ga=function(a,b,c){var count=0;for(var i=0;i<this.obj.ns();i++)if((i<a)||(i>b)){var z=this.obj.wn(i);if((!z.kl)&&(!z.kp)){if((z.previousSibling)&&((z.previousSibling.kp)||(z.previousSibling.kl))){var ind=this.P.bP(z);var zprev=z.previousSibling;this.aD[1][ind]=z;zprev.kp=true;z.parentNode.removeChild(z);this.bj[this.P[ind].idd]=null;this.P[ind]=null;this.qQ(zprev,-this.ig);i--}else if((z.nextSibling)&&((z.nextSibling.kp)||(z.nextSibling.kl))){var ind=this.P.bP(z);var zprev=z.nextSibling;this.aD[1][ind]=z;zprev.kp=true;z.parentNode.removeChild(z);this.bj[this.P[ind].idd]=null;this.P[ind]=null;this.qQ(zprev,-this.ig);i--}else{var ind=this.P.bP(z);this.aD[1][ind]=z;var id='temp_dLoad_'+this.BF;this.BF++;var zn=this.uJ(id,ind,true,ind);z.parentNode.removeChild(z);zn.kp=true;this.qQ(zn,0)};if(this.obj.ns()<=this.xh)return}}};D.prototype.Dy=function(j){if((!this.P[j])||(this.P[j].kp))this.kd(j);else if((this.aD[1][j])&&(this.aD[1][j].tagName=="TR")){this.P[j].parentNode.insertBefore(this.aD[1][j],this.P[j]);this.P[j].parentNode.removeChild(this.P[j]);this.P[j].grid=null;this.P[j]=this.aD[1][j]};if(this.hC){if(j%2==1)this.P[j].className=this.iI;else this.P[j].className=this.hC};if(this.aD[1][j].tagName=="row"){this.bK(this.P[j].idd,this.aD[1][j].getAttribute("id"));this.jc(this.P[j],this.aD[1][j],-1)}else{this.bj[this.aD[1][j].idd]=this.aD[1][j];this.aD[1][j].kp=this.aD[1][j].kl=false};this.P[j].kl=false;this.aD[1][j]=null};D.prototype.kh=function(pos,bo){if((this.xo)&&(this.xo>this.xd))var Gp=this.xo;else var Gp=this.xd;if(!this.limit){this.zu[0]=[0,Gp];this.bA=new ag(this.Im,this);this.bA.bs=bo;this.cG("onXLS",[this]);if(this.SZ)this.bA.bH(this.SZ);else this.bA.loadXML(this.ic+((this.ic.indexOf("?")!= -1)?"&":"?")+"posStart="+0+"&sn="+(new Date()).valueOf());return true};var gi=pos||Math.floor(this.HF.scrollTop/this.ig);if((this.xh)&&(this.obj.ns()>this.xh)){this.Ga(gi,gi+Gp)};if(gi>(this.limit-Gp))gi=this.limit-Gp;if(gi<0)gi=0;var size=gi+Gp;if(size>this.limit)size=this.limit;for(var j=gi;j<size;j++)if((!this.P[j])||(this.P[j].kl)||(this.P[j].kp)){if(this.aD[1][j]){this.Dy(j)}else{if(this.Cr){start=this.BE(j,-1);count=this.BE(size,1)-start}else{count=size-j;start=j};this.zu[start]=[gi-start,size-gi];this.bA=new ag(this.Im,this);this.bA.bs=bo;this.cG("onXLS",[this]);this.bA.loadXML(this.ic+((this.ic.indexOf("?")!= -1)?"&":"?")+"posStart="+start+"&count="+count+"&sn="+(new Date()).valueOf());return}};if(bo)bo()};D.prototype.Im=function(obj,xml,c,d,e){if(obj.va)return obj.OR(e);var top=e.cR("rows");var agq=obj.CV;if(agq){obj.Ov(top);if(obj.limit&&obj.P.length)agq=false};var rows=e.et("//rows/row",top);var aor=top.getAttribute("total_count");if((aor)&&(!obj.LC)){obj.LC=obj.limit=parseInt(aor)};if(agq)obj.Ve();var j=parseInt(top.getAttribute("pos"))||0;var afg=(obj.zu[j]||[0])[0];var akS=afg+(obj.zu[j]||[0,rows.length])[1];if(!obj.limit){obj.limit=rows.length;obj.hS(0,obj.limit*obj.ig);if(obj.abK)window.setTimeout(function(){obj.kh()},1)};for(var i=0;i<rows.length;i++){if((i<afg)||(i>akS)){obj.aD[1][j+i]=rows[i];obj.aD[0][j+i]=rows[i].getAttribute("id")}else{obj.aD[0][j+i]=null;if((!obj.P[i+j])||(obj.P[i+j].kp))obj.kd(i+j);if(obj.P[i+j].kl){if(obj.hC){if((j+i)%2==1)obj.P[i+j].className=obj.iI;else obj.P[i+j].className=obj.hC;if(obj.aC)obj.aC.P[i+j].className=obj.P[i+j].className};obj.bK(obj.P[i+j].idd,rows[i].getAttribute("id"));obj.jc(obj.P[i+j],rows[i],-1);obj.P[i+j].kl=false;if(obj.aC)obj.aC.P[i+j].kl=false}}};obj.cG("onXLE",[this,akS-afg])};D.prototype.kd=function(ind){var id='temp_dLoad_'+this.BF;this.BF++;var z=this.P[ind];if(!z){var mw=this.CA(ind);var aaC=mw[1]-(ind-mw[0])*this.ig;this.qQ(this.P[mw[0]],aaC);var z2=this.uJ(id,ind,true,mw[0]);z2.kp=true;this.qQ(z2,-1*((mw[1]-(ind-mw[0])*this.ig)-this.ig));return this.kd(ind)}else if(z.kp){if((this.aD[1][ind])&&(this.aD[1][ind].tagName=="TR"))(this.uJ(id,ind,true,null,this.aD[1][ind])).kl=false;else(this.uJ(id,ind,true)).kl=true;if((!z.style.height)||(parseInt(z.style.height)==this.ig))z.parentNode.removeChild(z);else{this.P[ind+1]=z;this.qQ(z,this.ig)};if(ind==0)this.setSizes()}};D.prototype.CA=function(ind){for(var i=ind-1;i>=0;i--){if(this.P[i]){return[i,(parseFloat(this.P[i].style.height))]}}};D.prototype.qQ=function(z,aaC){var x=parseFloat(z.style.height||this.ig)-aaC;if(x==this.ig){z.kp=false;z.kl=true};z.style.height=x+"px";var n=z.childNodes.length;for(var i=0;i<n;i++)z.childNodes[i].style.height=x+"px"};D.prototype.hS=function(ind,height){var id='temp_dLoad_'+this.BF;this.BF++;var z=this.uJ(id,ind);z.style.height=height+"px";var n=z.childNodes.length;for(var i=0;i<n;i++)z.childNodes[i].style.height=height+"px";z.kp=true};D.prototype.uJ=function(id,ind,afQ,mw,z){var z=z||this.uO(id);if(((mw)||(mw=="0"))&&(this.P[mw].nextSibling))this.P[mw].parentNode.insertBefore(z,this.P[mw].nextSibling);else{if((ind==this.limit)||(this.obj.ns()==0)||(!this.P[ind])){if(cn)this.obj.appendChild(z);else{if(!this.obj.firstChild)this.obj.appendChild(document.createElement("TBODY"));this.obj.childNodes[0].appendChild(z)}}else this.P[mw||ind].parentNode.insertBefore(z,this.P[ind])};this.bj[id]=z;if(!afQ)this.P.ml(ind,z);else this.P[ind]=z;return z};D.prototype.Je=function(r,ind,Ch){if(ind<0||typeof ind==undefined)ind=this.aD[0].length;if((arguments.length<2)||(ind===window.undefined))ind=this.aD[0].length;else{if(ind>this.aD[0].length)ind=this.aD[0].length};var mw=this.aD[0][ind]||(this.P[ind]?this.P[ind].idd:null);if(mw)this.dz(mw);if(!Ch)if(ind==this.aD[0].length){if(cn)this.obj.appendChild(r);else{this.obj.firstChild.appendChild(r)};this.aD[0][ind]=r.idd;this.aD[1][ind]=null;mw=ind}else{if(!this.P[ind])mw=(this.CA(ind)[0]);else mw=ind;this.P[mw].parentNode.insertBefore(r,this.P[mw]);this.aD[0].ml(ind,r.idd);this.aD[1].ml(ind,null)};this.limit+=1;this.bj[r.idd]=r;this.P.ml(mw,r);if(this.hC){if(ind%2==1)r.className+=" "+this.iI;else r.className+=" "+this.hC;if(ind!=(this.P.length-1))this.O(ind+1)};this.KK(r);if((this.vN)&&(!this.vS)){for(var i=0;i<this.hdr.rows[0].cells.length;i++)this.lE(r.childNodes[i]);this.vN=false};return r};D.prototype.QN=function(bO,node){var ind= -1;var Vv=null;if(this.bj[bO]){ind=this.P.bP(this.bj[bO]);if(this.tL(bO,node)==false)return false};if(ind<0){var ind=this.aD[0].bP(bO);if(ind> -1)Vv=this.P[this.CA(ind)[0]]};if(ind> -1){this.aD[0].Qt(ind);this.aD[1].Qt(ind);this.limit-=1;if(Vv)this.qQ(Vv,this.ig)};return true};