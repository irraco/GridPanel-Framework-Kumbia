D.prototype.ia=function(z){if(!z.update||z.id==0)return;this.bj[z.id].JW.src=this.eg+z.state+".gif";z.update=false};D.prototype.cC=function(obj){this.bB();var row=obj.parentNode.parentNode.parentNode;var r=this.dP.get[row.idd];if(!this.cG("onOpen",[row.idd,(r.state=="plus"? -1:1)]))return;if(r.state=="plus")this.expandKids(row);else if((r.state=="minus")&&(!r.aaZ))this.collapseKids(row)};function Ei(){var z={id:0,bu:[],gR: -1,parent:null,index:0,state:D.uT};this.order=[z];this.get={"0":z};this.aqd=function(a,b){var p=a.parent;var z=a.index;p.bu[z]=b;p.bu[b.index]=a;a.index=b.index;b.index=z};this.so=function(id,xj,that){var z=this.get[id];for(var i=0;i<z.bu.length;i++){xj.apply((that||this),[z.bu[i]]);if(z.bu[i].bu.length)this.so(z.bu[i].id,xj,that)}};this.JA=function(id,name,ap){var z=this.get[id];if(z[name]==ap)return;z[name]=ap;z.update=true};this.add=function(id,eW){return this.Oj(id,eW)};this.Oj=function(id,eW,RH,arK){var z=this.get[eW||0];if(RH)var ind=this.get[RH].index+(arK?0:1);else var ind=z.bu.length;var x={id:id,bu:[],gR:z.gR+1,parent:z,index:ind,state:D.uT};if(z.bu.length==0)this.JA(eW,"state",(eW==0?"minus":"plus"));if(RH){for(var i=ind;i<z.bu.length;i++)z.bu[i].index++;z.bu=z.bu.slice(0,ind).concat([x]).concat(z.bu.slice(ind,z.bu.length))}else z.bu.push(x);this.get[id]=x;return x};this.acA=function(id,eW,afp){return this.Oj(id,eW,afp,true)};this.remove=function(id){var z=this.get[id||0];for(var i=0;i<z.bu.length;i++)this.SS(z.bu[i].id);z.bu=[];z.parent.bu=z.parent.bu.slice(0,z.index).concat(z.parent.bu.slice(z.index+1));for(var i=z.index;i<z.parent.bu.length;i++)z.parent.bu[i].index--;delete this.get[id]};this.SS=function(id){var z=this.get[id||0];for(var i=0;i<z.bu.length;i++)this.SS(z.bu[i].id);z.bu=[];delete this.get[id]};return this};D.prototype.jS=function(id,start){var z=this.dP.get[id].bu;start+=z.length;for(var i=0;i<z.length;i++)if(z[i].bu.length&&z[i].state=='minus')start+=this.jS(z[i].id,0);return start};D.prototype.collapseKids=function(uG){var r=this.dP.get[uG.idd];if(r.state!="minus")return;if(!this.cG("onOpenStart",[uG.idd,1]))return;var start=uG.rowIndex;if(start<0)start=this.P.bP(uG)+1;this.dP.JA(r.id,"state","plus");this.ia(r);var Bj=this.jS(this.P[start-1].idd,0);for(var i=0;i<Bj;i++)this.P[start+i].parentNode.removeChild(this.P[start+i]);this.P.splice(start,Bj);this.cG("onGridReconstructed",[]);this.cG("onOpenEnd",[uG.idd,-1]);this.setSizes()};D.prototype.MI=function(r,start,ind){var alD=[];var asv=(cn?this.obj:this.obj.rows[0].parentNode);for(var i=0;i<r.bu.length;i++){var ra=this.bj[r.bu[i].id];if(start)start.parentNode.insertBefore(ra,start);else asv.appendChild(ra);alD.push(ra)};this.P=oT(this.P.slice(0,ind).concat(alD).concat(this.P.slice(ind)),this.apH);var dx=0;for(var i=0;i<r.bu.length;i++)if(r.bu[i].state=="minus")dx+=this.MI(r.bu[i],this.P[ind+i+dx+1],ind+i+dx+1);return r.bu.length+dx};D.prototype.expandKids=function(uG,sEv){var r=this.dP.get[uG.idd];if((!r.bu.length)&&(!r.TP))return;if(r.state!="plus")return;if(!r.Oo&& !sEv)if(!this.cG("onOpenStart",[r.id,-1]))return;var start=this.di(r.id)+1;if(r.bu.length){r.Oo=false;this.dP.JA(r.id,"state","minus");this.ia(r);var Bj=this.MI(r,this.P[start],start);this.cG("onGridReconstructed",[])}else{if(r.TP){if((this.mI)&&(uG.Q)){this.HN(uG);return this.expandKids(uG,true)};if(this.Ey.indexOf("?")!= -1)var s="&";else var s="?";r.Oo=true;this.loadXML(this.Ey+""+s+"id="+r.id)}};this.setSizes();if(!r.Oo)this.cG("onOpenEnd",[r.id,1])};D.prototype.Ey="";D.prototype.sT=function(col,type,order){this.fm(function(id){var z=this.dP.get[id];var label=this.cells(id,col).getValue();if(type=='int'){z.pK=parseFloat(label);z.pK=isNaN(z.pK)? -99999999999999:z.pK}else z.pK=label});var self=this;var pos=1;var akh= -1;if(order=="des"){pos= -1;akh=1};var xj=null;if(type=='cus')xj=function(a,b){return self.abz[col](a.pK,b.pK,order)};if(type=='str')xj=function(a,b){return(a.pK<b.pK?akh:(a.pK==b.pK?0:pos))};if(type=='int')xj=function(a,b){return(a.pK<b.pK?akh:(a.pK==b.pK?0:pos))};if(type=='date')xj=function(a,b){return(Date.parse(new Date(a.pK))-Date.parse(new Date(b.pK)))*pos};this.ID(xj,0);for(var i=0;i<this.P.length;i++)this.P[i].parentNode.removeChild(this.P[i]);this.P=new cD();this.uR(0,true);this.cG("onGridReconstructed",[])};D.prototype.ID=function(xj,id){var ar=this.dP.get[id].bu;ar.sort(xj);for(var i=0;i<ar.length;i++)if(ar[i].bu.length)this.ID(xj,ar[i].id)};D.prototype.uR=function(id,mode){var ar=this.dP.get[id].bu;var asv=(cn?this.obj:this.obj.rows[0].parentNode);for(var i=0;i<ar.length;i++){if(mode){var row=this.bj[ar[i].id];asv.appendChild(row);this.P.push(row)};ar[i].index=i;if(ar[i].bu.length)if(ar[i].state=="minus")this.uR(ar[i].id,true)}};D.prototype.Sb=function(){};D.prototype.ahx=function(){this.dP.so(0,function(x){this.bj[x.id].className=((x.gR%2)?(this.iI+" "+this.iI):(this.hC+" "+this.hC))+"_"+x.gR+(this.bj[x.id].Vn||"")},this)};D.prototype.MN=function(id,dir){var x=this.dP.get[id];var p=x.parent.bu[x.index+dir];if((!p)||(p.parent!=x.parent))return;var state=[x.state,p.state];this.collapseKids(this.bj[x.id]);this.collapseKids(this.bj[p.id]);var ind=this.P.bP(this.bj[id]);var aoL=this.obj.rows[0].parentNode.removeChild(this.P[ind]);var If=this.P[ind+((dir==1)?2:dir)];if(If)If.parentNode.insertBefore(aoL,If);else this.obj.rows[0].parentNode.appendChild(aoL);this.P.yk(ind,ind+dir);this.dP.aqd(p,x);if(state[0]=="minus")this.expandKids(this.bj[x.id]);if(state[1]=="minus")this.expandKids(this.bj[p.id])};function eXcell_tree(cell){if(cell){this.cell=cell;this.grid=this.cell.parentNode.grid};this.isDisabled=function(){return this.grid.ZU};this.edit=function(){if((this.er)||(this.grid.ZU))return;this.er=this.cell.parentNode.JT;this.ap=this.er.innerHTML;this.er.innerHTML="<textarea class='dhx_combo_edit' type='text' style='height:"+(this.cell.offsetHeight-6)+"px;width:100%;border:0px;margin:0px;padding:0px;padding-top:"+(ca?1:2)+"px;overflow:hidden;'></textarea>";this.er.childNodes[0].onmousedown=function(e){(e||event).cancelBubble=true};this.er.childNodes[0].onselectstart=function(e){if(!e)e=event;e.cancelBubble=true;return true};if(ca)this.er.style.top="1px";this.er.className+=" editable";this.er.firstChild.onclick=function(e){(e||event).cancelBubble=true};this.er.firstChild.value=this.ap;this.er.firstChild.focus()};this.detach=function(){if(!this.er)return;this.setLabel(this.er.firstChild.value);this.er.className=this.er.className.replace("editable","");var z=(this.ap!=this.er.aoG);if(ca)this.er.style.top="2px";if(this.grid.UV)this.grid.UV(this.cell.parentNode.idd,this.cell.A,this.er.innerHTML);this.er=null;return(z)};this.getValue=function(){return this.DB()};this.hW=function(url){this.cell.parentNode.JW.nextSibling.src=this.grid.eg+"/"+url;this.grid.dP.get[this.cell.parentNode.idd].image=url};this.afl=function(){this.grid.dP.get[this.cell.parentNode.idd].image};this.setLabel=function(ap){this.je(ap)};this.DB=function(ap){return this.cell.parentNode.JT.innerHTML}};eXcell_tree.prototype=new gD;eXcell_tree.prototype.je=function(content){this.cell.parentNode.JT.innerHTML=content;if(this.grid.UV)this.grid.UV(this.cell.parentNode.idd,this.cell.A,content)};eXcell_tree.prototype.setValue=function(sg){if(typeof(sg)!="object")sg=sg.split("^");if(sg.length==1)return this.setLabel(sg[0]);if((this.grid.kj.eg==null)||(this.grid.kj.eg!=this.grid.eg)){var kj={};kj.amo="<img src='"+this.grid.eg+"blanc.gif' align='absmiddle' class='space'>";kj.abD="<img src='"+this.grid.eg;kj.ZY="' align='absmiddle' onclick='this."+(cn?"":"parentNode.")+"parentNode.parentNode.parentNode.parentNode.grid.cC(this);event.cancelBubble=true;'>";kj.plus=kj.abD+"plus.gif"+kj.ZY;kj.minus=kj.abD+"minus.gif"+kj.ZY;kj.blank=kj.abD+"blank.gif"+kj.ZY;kj.start="<div style=' overflow:hidden;white-space : nowrap;height:"+(bf?20:18)+"px;'>";kj.akX="' align='absmiddle' "+(this.grid.Mo?(" height=\""+this.grid.Mo+"\""):"")+(this.grid.Qb?(" width=\""+this.grid.Qb+"\""):"")+" ><span "+(ca?"style='position:relative;top:2px;'":"")+"id='nodeval'>";kj.close="</span></div>";this.grid.kj=kj};var dP=this.grid.dP;var kj=this.grid.kj;var Mj=this.cell.parentNode.idd;var qc=sg[0];if(dP.get[Mj])return ey.gn("DuplicateID","Not unique ID :: "+Mj+", row skiped",[Mj]);var GZ=dP.get[(qc||0)];if((this.grid._add_trgr||this.grid._add_trgr=="0")&&GZ.bu.length){if(this.grid._add_trgr==0)var row=dP.acA(Mj,(qc||0),GZ.bu[0].id);else var row=dP.Oj(Mj,(qc||0),GZ.bu[this.grid._add_trgr-1].id);delete this.grid._add_trgr}else var row=dP.add(Mj,(qc||0));if((!this.grid.Ey)&&(!this.grid.mI))sg[2]=0;row.agN=(sg[2]||0);row.TP=(sg[2]!=0);row.image=sg[3];row.label=sg[1];var html=[kj.start];for(var i=0;i<row.gR;i++)html.push(kj.amo);if(sg[2]!=""&&sg[2]!=0){html.push(kj.plus);row.state="plus"}else html.push(kj.blank);html.push(kj.abD);html.push(sg[3]);html.push(kj.akX);html.push(sg[1]);html.push(kj.close);this.cell.innerHTML=html.join("");this.cell.parentNode.JW=this.cell.childNodes[0].childNodes[row.gR];this.cell.parentNode.JT=this.cell.childNodes[0].childNodes[row.gR+2];if(cn)this.cell.vAlign="top";if(GZ.id!=0&&GZ.state=="plus"){this.grid.ia(GZ,false);this.cell.parentNode.WX=true};this.grid.cG("onCellChanged",[Mj,this.cell.A,sg[1]])};D.prototype.yE=function(node,x){if(x){this.dP.so(x.id,function(x){this.yE(null,x);delete this.bj[x.id]},this);return};var ind=this.di(node.idd);var x=this.dP.get[node.idd];if(ind!= -1){var Bj=1;if(x&&x.state=="minus")Bj+=this.jS(x.id,0);for(var i=0;i<Bj;i++)this.P[i+ind].parentNode.removeChild(this.P[i+ind]);this.P.splice(ind,Bj)};if(!x)return;this.yE(null,x);delete this.bj[x.id];if(x.parent.bu.length==1){this.dP.JA(x.parent.id,"state",D.uT);this.ia(x.parent)};this.dP.remove(x.id);if(this.rr&&x.parent)this.Wp(x.parent)};D.prototype.hx=function(cq){var y=this.dP.get[cq||0];var x=this.dz(cq||0);if(!x)return;if(y.parent&&y.parent.id!=0)this.hx(y.parent.id);this.expandKids(x)};D.prototype.FE=D.prototype.hY;D.prototype.hY=function(oO,text,ind,parent_id,img,child){parent_id=parent_id||0;var Uz=this.cO.bP("tree");if(typeof(text)=="string")text=text.split(this.gX);var WB=null;if((Uz!= -1)&&((text[Uz]||"").toString().search(/\^/gi)== -1)){var arv=text[Uz];var d=parent_id.toString().split(",");for(var i=0;i<d.length;i++){text[Uz]=d[i]+"^"+arv+"^"+(child?1:0)+"^"+(img||"leaf.gif");if(d[i]!=0)if((!ind)||(ind==0)){ind=this.di(d[i]);if(ind!= -1){if(this.dP.get[d[i]].state=="minus")ind+=this.jS(d[i],0)+1;if((this.mI)&&(this.P[ind].Q))this.HN(this.P[ind])}};if(!this._add_trgr){if(this.dP.get[parent_id].state!="minus")this._add_trgr=this.dP.get[parent_id].bu.length;else if(this.P[ind-1])this._add_trgr=this.Ml(this.dP.get[this.P[ind-1].idd],(parent_id||0));else this._add_trgr=0};WB=this.FE(oO,text,((!parent_id)&&(!ind)&&(ind!="0"))?window.undefined:ind)};return WB};return this.FE(oO,text,ind)};D.prototype.Ml=function(x,id){if(x.id==id)return 0;if(x.parent.id==id)return x.index+1;return this.Ml(x.parent,id)};D.prototype.alo=function(oO,text,sibl_id,img,child){var sb=this.bj[sibl_id];if(!sb)return;var ind=this.di(sibl_id);this._add_trgr=this.dP.get[sibl_id].index;return this.hY(oO,text,ind,this.dP.get[sibl_id].parent.id,img,child)};D.prototype.amC=function(oO,text,sibl_id,img,child){var sb=this.bj[sibl_id];if(!sb)return;var ind=this.di(sibl_id);this._add_trgr=this.dP.get[sibl_id].index+1;if(this.dP.get[sibl_id].state=="minus")ind+=this.jS(sibl_id,0)+1;else ind++;return this.hY(oO,text,ind,this.dP.get[sibl_id].parent.id,img,child)};D.prototype.aO=function(mode){this.mI=K(mode)};D.prototype.RW=function(id){if(this.vS)return null;if((id=="null")||(!id))return;var a;for(a in this.bj)if((this.bj[a])&&(this.bj[a].Q)){var res=this.bA.et("//row[@id=\""+id+"\"]",this.bj[a].Q[0].parentNode);if(res&&res.length){res=res[0];var line=new Array();while(!this.bj[res.getAttribute("id")]){line[line.length]=res.getAttribute("id");res=res.parentNode};line[line.length]=res.getAttribute("id");for(var i=line.length-1;i>0;i--){this.HN(this.bj[line[i]]);this.nk(this.bj[line[i]])};for(var i=1;i<line.length;i++)this.collapseKids(this.bj[line[i]]);return this.dz(id)}};return null};D.prototype.HN=function(row){var row=this.bj[row.idd];if(row.Q){var ind=this.P.bP(row);ind+=this.jS(row.idd);this.aq(row.Q,ind,this.cO.bP("tree"),row.idd)};row.TP=row.Q=null};D.prototype.DF=function(QC,from_row_id,zH){var z=this.cO.bP("tree");for(i=0;i<QC.cells.length;i++){if(i!=z)this.cells(zH,i).setValue(this.cells(from_row_id,i).getValue());else this.cells(zH,i).je(this.cells(from_row_id,i).getValue())}};D.prototype.KW=function(cq){var x=this.dz(cq);if(!x)return;this.collapseKids(x)};D.prototype.fa=function(cq){var z=this.dP.get[cq];if(!z)return;while(z.bu.length)this.deleteRow(z.bu[0].id)};D.prototype.Fx=function(cq){var str=[];var z=this.dP.get[cq||0];if(z)for(var i=0;i<z.bu.length;i++){str.push(z.bu[i].id);if(z.bu[i].bu.length)str=str.concat(this.Fx(z.bu[i].id).split(","))};return str.join(",")};D.prototype.FI=function(cq,ind){var z=this.dP.get[cq||0];if(!z)return null;return(z.bu[ind]?z.bu[ind].id:null)};D.prototype.fZ=function(cq){var z=this.dP.get[cq||0];if(!z)return "";return z.label};D.prototype.KL=function(cq){var z=this.dP.get[cq||0];if(!z)return;if(z.state=="minus")return true;return false};D.prototype.rP=function(cq){var z=this.dP.get[cq||0];if((!z)||(!z.parent))return null;return z.parent.id};D.prototype.Mn=function(cq){var str=[];var z=this.dP.get[cq||0];if(z)for(var i=0;i<z.bu.length;i++)str.push(z.bu[i].id);return str.join(",")};D.prototype.gE=function(){if(this.mI)this.YN();for(var i=0;i<this.P.length;i++)this.obj.rows[0].parentNode.removeChild(this.P[i]);this.P=new cD();this.CG(0);this.setSizes();this.cG("onGridReconstructed",[])};D.prototype.YN=function(){for(var i=0;i<this.P.length;i++)if(this.P[i].Q){this.mI=false;this.HN(this.P[i]);this.mI=true}};D.prototype.CG=function(z){var x=this.dP.get[z].bu;for(var i=0;i<x.length;i++){var row=this.bj[x[i].id];this.P.push(row);this.obj.rows[0].parentNode.appendChild(row);if(x[i].bu.length){this.dP.JA(x[i].id,"state","minus");this.ia(x[i]);this.CG(x[i].id)}}};D.prototype.afx=function(cq){var z=this.dP.get[0].bu;for(var i=0;i<z.length;i++)this.collapseKids(this.bj[z[i].id]);for(id in this.bj){var z=this.dP.get[id];if(z&&z.state=="minus"){z.state="plus";z.update=true;this.ia(z)}}};D.prototype.MD=function(cq){var x=this.dP.get[cq];if(x&&x.bu.length)return x.bu.length;if(this.dz(cq).TP)return-1;return 0};D.prototype.Cq=function(cq,status){var x=this.dP.get[cq];if(!x)return;x.aaZ=(!K(status))};D.prototype.lB=function(cq,Zf){this.dP.get[cq].label=Zf;this.bj[cq].JT.innerHTML=Zf};D.prototype.Wv=function(cq,url){this.dP.get[cq].image=url;this.bj[cq].JW.nextSibling.src=url};D.prototype.Dx=function(cq){return this.dP.get[cq].image};D.prototype.alT=function(width,height){this.Qb=width;this.Mo=height};D.prototype.akx=function(row){return this.dP.get[row.idd].image};D.prototype.Gm=function(aQ){this.attachEvent("onOpenStart",aQ)};D.prototype.rV=function(aQ){this.attachEvent("onOpenEnd",aQ)};D.prototype.aer=function(mode){this.ZU= !K(mode)};D.prototype.sS=function(cq){var z=this.dP.get[cq||0];if(!z)return-1;return z.gR};D.prototype.oj=function(ind,state){for(i in this.bj){if((this.bj[i])&&(this.bj[i].childNodes))this.bj[i].childNodes[ind].style.display=state}};D.uT="blank";